/*! Wed Nov 22 2017 15:42:30 GMT-0600 (CST) * Copyright (c) 2017 Creative Market. All Rights Reserved. */
define("jquery",[],function(){return window.jQuery}),function(e){function t(i){function r(e){return e&&"object"==typeof e&&!Fn(e)&&tn.call(e,"__wrapped__")?e:new V(e)}function q(e){var t=e.length,n=t>=c;if(n)for(var i={},s=-1;++s<t;){var r=l+e[s];(i[r]||(i[r]=[])).push(e[s])}return function(t){if(n){var s=l+t;return i[s]&&Xe(i[s],t)>-1}return Xe(e,t)>-1}}function N(e){return e.charCodeAt(0)}function R(e,t){var n=e.index,i=t.index;if(e=e.criteria,t=t.criteria,e!==t){if(e>t||"undefined"==typeof e)return 1;if(e<t||"undefined"==typeof t)return-1}return n<i?-1:1}function z(e,t,n,i){function s(){var i=arguments,c=o?this:t;if(r||(e=t[a]),n.length&&(i=i.length?(i=gn.call(i),l?i.concat(n):n.concat(i)):n),this instanceof s){W.prototype=e.prototype,c=new W,W.prototype=null;var u=e.apply(c,i);return de(u)?u:c}return e.apply(c,i)}var r=ue(e),o=!n,a=t;if(o){var l=i;n=t}else if(!r){if(!i)throw new Bt;t=e}return s}function H(){for(var e,t={shadowedProps:x,arrays:"isArray(iterable)",bottom:"",init:"iterable",loop:"",top:"",useHas:!0,useKeys:!!Tn},n=0;e=arguments[n];n++)for(var i in e)t[i]=e[i];var s=t.args;t.firstArg=/^[^,]+/.exec(s)[0];var o=Nt("hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectTypes","return function("+s+") {\n"+kn(t)+"\n}");return o(tn,J,Fn,ge,Tn,r,L)}function U(e){return"\\"+j[e]}function Y(e){return Dn[e]}function B(e){return"function"!=typeof e.toString&&"string"==typeof(e+"")}function V(e){this.__wrapped__=e}function W(){}function X(e){var t=!1;if(!e||on.call(e)!=A||!wn.argsClass&&J(e))return t;var n=e.constructor;return(ue(n)?n instanceof n:wn.nodeClass||!B(e))?wn.ownLast?(Pn(e,function(e,n,i){return t=tn.call(i,n),!1}),t===!0):(Pn(e,function(e,n){t=n}),t===!1||tn.call(e,t)):t}function G(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var i=-1,s=n-t||0,r=jt(s<0?0:s);++i<s;)r[i]=e[t+i];return r}function K(e){return Mn[e]}function J(e){return on.call(e)==F}function Z(e,t,i,s,o,a){var l=e;if("function"==typeof t&&(s=i,i=t,t=!1),"function"==typeof i){if(i="undefined"==typeof s?i:r.createCallback(i,s,1),l=i(l),"undefined"!=typeof l)return l;l=e}var c=de(l);if(c){var u=on.call(l);if(!I[u]||!wn.nodeClass&&B(l))return l;var d=Fn(l)}if(!c||!t)return c?d?G(l):An({},l):l;var h=yn[u];switch(u){case T:case E:return new h((+l));case M:case P:return new h(l);case $:return h(l.source,m.exec(l))}o||(o=[]),a||(a=[]);for(var f=o.length;f--;)if(o[f]==e)return a[f];return l=d?h(l.length):{},d&&(tn.call(e,"index")&&(l.index=e.index),tn.call(e,"input")&&(l.input=e.input)),o.push(e),a.push(l),(d?De:In)(e,function(e,s){l[s]=Z(e,t,i,n,o,a)}),l}function Q(e,t,n){return Z(e,!0,t,n)}function ee(e,t,n){var i;return t=r.createCallback(t,n),In(e,function(e,n,s){if(t(e,n,s))return i=n,!1}),i}function te(e){var t=[];return Pn(e,function(e,n){ue(e)&&t.push(n)}),t.sort()}function ne(e,t){return!!e&&tn.call(e,t)}function ie(e){for(var t=-1,n=Tn(e),i=n.length,s={};++t<i;){var r=n[t];s[e[r]]=r}return s}function se(e){return e===!0||e===!1||on.call(e)==T}function re(e){return!!e&&("object"==typeof e&&on.call(e)==E)}function oe(e){return!!e&&1===e.nodeType}function ae(e){var t=!0;if(!e)return t;var n=on.call(e),i=e.length;return n==S||n==P||(wn.argsClass?n==F:J(e))||n==A&&"number"==typeof i&&ue(e.splice)?!i:(In(e,function(){return t=!1}),t)}function le(e,t,n,i,s,o){var l=n===a;if("function"==typeof n&&!l){n=r.createCallback(n,i,2);var c=n(e,t);if("undefined"!=typeof c)return!!c}if(e===t)return 0!==e||1/e==1/t;var u=typeof e,d=typeof t;if(e===e&&(!e||"function"!=u&&"object"!=u)&&(!t||"function"!=d&&"object"!=d))return!1;if(null==e||null==t)return e===t;var h=on.call(e),f=on.call(t);if(h==F&&(h=A),f==F&&(f=A),h!=f)return!1;switch(h){case T:case E:return+e==+t;case M:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case $:case P:return e==Yt(t)}var p=h==S;if(!p){if(tn.call(e,"__wrapped__ ")||tn.call(t,"__wrapped__"))return le(e.__wrapped__||e,t.__wrapped__||t,n,i,s,o);if(h!=A||!wn.nodeClass&&(B(e)||B(t)))return!1;var m=!wn.argsObject&&J(e)?Ht:e.constructor,g=!wn.argsObject&&J(t)?Ht:t.constructor;if(m!=g&&!(ue(m)&&m instanceof m&&ue(g)&&g instanceof g))return!1}s||(s=[]),o||(o=[]);for(var v=s.length;v--;)if(s[v]==e)return o[v]==t;var b=0;if(c=!0,s.push(e),o.push(t),p){if(v=e.length,b=t.length,c=b==e.length,!c&&!l)return c;for(;b--;){var y=v,w=t[b];if(l)for(;y--&&!(c=le(e[y],w,n,i,s,o)););else if(!(c=le(e[b],w,n,i,s,o)))break}return c}return Pn(t,function(t,r,a){if(tn.call(a,r))return b++,c=tn.call(e,r)&&le(e[r],t,n,i,s,o)}),c&&!l&&Pn(e,function(e,t,n){if(tn.call(n,t))return c=--b>-1}),c}function ce(e){return cn(e)&&!un(parseFloat(e))}function ue(e){return"function"==typeof e}function de(e){return!!e&&L[typeof e]}function he(e){return pe(e)&&e!=+e}function fe(e){return null===e}function pe(e){return"number"==typeof e||on.call(e)==M}function me(e){return!!e&&(L[typeof e]&&on.call(e)==$)}function ge(e){return"string"==typeof e||on.call(e)==P}function ve(e){return"undefined"==typeof e}function be(e,t,n){var i=arguments,s=0,o=2;if(!de(e))return e;if(n===a)var l=i[3],c=i[4],u=i[5];else c=[],u=[],"number"!=typeof n&&(o=i.length),o>3&&"function"==typeof i[o-2]?l=r.createCallback(i[--o-1],i[o--],2):o>2&&"function"==typeof i[o-1]&&(l=i[--o]);for(;++s<o;)(Fn(i[s])?De:In)(i[s],function(t,n){var i,s,r=t,o=e[n];if(t&&((s=Fn(t))||Ln(t))){for(var d=c.length;d--;)if(i=c[d]==t){o=u[d];break}if(!i){var h;l&&(r=l(o,t),(h="undefined"!=typeof r)&&(o=r)),h||(o=s?Fn(o)?o:[]:Ln(o)?o:{}),c.push(t),u.push(o),h||(o=be(o,t,a,l,c,u))}}else l&&(r=l(o,t),"undefined"==typeof r&&(r=t)),"undefined"!=typeof r&&(o=r);e[n]=o});return e}function ye(e,t,n){var i="function"==typeof t,s={};if(i)t=r.createCallback(t,n);else var o=Zt.apply(Vt,gn.call(arguments,1));return Pn(e,function(e,n,r){(i?!t(e,n,r):Xe(o,n)<0)&&(s[n]=e)}),s}function we(e){for(var t=-1,n=Tn(e),i=n.length,s=jt(i);++t<i;){var r=n[t];s[t]=[r,e[r]]}return s}function ke(e,t,n){var i={};if("function"!=typeof t)for(var s=-1,o=Zt.apply(Vt,gn.call(arguments,1)),a=de(e)?o.length:0;++s<a;){var l=o[s];l in e&&(i[l]=e[l])}else t=r.createCallback(t,n),Pn(e,function(e,n,s){t(e,n,s)&&(i[n]=e)});return i}function _e(e){for(var t=-1,n=Tn(e),i=n.length,s=jt(i);++t<i;)s[t]=e[n[t]];return s}function xe(e){var t=-1,n=Zt.apply(Vt,gn.call(arguments,1)),i=n.length,s=jt(i);for(wn.unindexedChars&&ge(e)&&(e=e.split(""));++t<i;)s[t]=e[n[t]];return s}function Ce(e,t,n){var i=-1,s=e?e.length:0,r=!1;return n=(n<0?hn(0,s+n):n)||0,"number"==typeof s?r=(ge(e)?e.indexOf(t,n):Xe(e,t,n))>-1:En(e,function(e){if(++i>=n)return!(r=e===t)}),r}function Fe(e,t,n){var i={};return t=r.createCallback(t,n),De(e,function(e,n,s){n=Yt(t(e,n,s)),tn.call(i,n)?i[n]++:i[n]=1}),i}function Se(e,t,n){var i=!0;if(t=r.createCallback(t,n),Fn(e))for(var s=-1,o=e.length;++s<o&&(i=!!t(e[s],s,e)););else En(e,function(e,n,s){return i=!!t(e,n,s)});return i}function Te(e,t,n){var i=[];if(t=r.createCallback(t,n),Fn(e))for(var s=-1,o=e.length;++s<o;){var a=e[s];t(a,s,e)&&i.push(a)}else En(e,function(e,n,s){t(e,n,s)&&i.push(e)});return i}function Ee(e,t,n){if(t=r.createCallback(t,n),!Fn(e)){var i;return En(e,function(e,n,s){if(t(e,n,s))return i=e,!1}),i}for(var s=-1,o=e.length;++s<o;){var a=e[s];if(t(a,s,e))return a}}function De(e,t,n){if(t&&"undefined"==typeof n&&Fn(e))for(var i=-1,s=e.length;++i<s&&t(e[i],i,e)!==!1;);else En(e,t,n);return e}function Me(e,t,n){var i={};return t=r.createCallback(t,n),De(e,function(e,n,s){n=Yt(t(e,n,s)),(tn.call(i,n)?i[n]:i[n]=[]).push(e)}),i}function Ae(e,t){var n=gn.call(arguments,2),i=-1,s="function"==typeof t,r=e?e.length:0,o=jt("number"==typeof r?r:0);return De(e,function(e){o[++i]=(s?t:e[t]).apply(e,n)}),o}function $e(e,t,n){var i=-1,s=e?e.length:0,o=jt("number"==typeof s?s:0);if(t=r.createCallback(t,n),Fn(e))for(;++i<s;)o[i]=t(e[i],i,e);else En(e,function(e,n,s){o[++i]=t(e,n,s)});return o}function Pe(e,t,n){var i=-(1/0),s=i;if(!t&&Fn(e))for(var o=-1,a=e.length;++o<a;){var l=e[o];l>s&&(s=l)}else t=!t&&ge(e)?N:r.createCallback(t,n),En(e,function(e,n,r){var o=t(e,n,r);o>i&&(i=o,s=e)});return s}function Ie(e,t,n){var i=1/0,s=i;if(!t&&Fn(e))for(var o=-1,a=e.length;++o<a;){var l=e[o];l<s&&(s=l)}else t=!t&&ge(e)?N:r.createCallback(t,n),En(e,function(e,n,r){var o=t(e,n,r);o<i&&(i=o,s=e)});return s}function Le(e,t,n,i){var s=arguments.length<3;if(t=r.createCallback(t,i,4),Fn(e)){var o=-1,a=e.length;for(s&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e)}else En(e,function(e,i,r){n=s?(s=!1,e):t(n,e,i,r)});return n}function je(e,t,n,i){var s=e,o=e?e.length:0,a=arguments.length<3;if("number"!=typeof o){var l=Tn(e);o=l.length}else wn.unindexedChars&&ge(e)&&(s=e.split(""));return t=r.createCallback(t,i,4),De(e,function(e,i,r){i=l?l[--o]:--o,n=a?(a=!1,s[i]):t(n,s[i],i,r)}),n}function Oe(e,t,n){return t=r.createCallback(t,n),Te(e,function(e,n,i){return!t(e,n,i)})}function qe(e){var t=-1,n=e?e.length:0,i=jt("number"==typeof n?n:0);return De(e,function(e){var n=Qt(mn()*(++t+1));i[t]=i[n],i[n]=e}),i}function Ne(e){var t=e?e.length:0;return"number"==typeof t?t:Tn(e).length}function Re(e,t,n){var i;if(t=r.createCallback(t,n),Fn(e))for(var s=-1,o=e.length;++s<o&&!(i=t(e[s],s,e)););else En(e,function(e,n,s){return!(i=t(e,n,s))});return!!i}function ze(e,t,n){var i=-1,s=e?e.length:0,o=jt("number"==typeof s?s:0);for(t=r.createCallback(t,n),De(e,function(e,n,s){o[++i]={criteria:t(e,n,s),index:i,value:e}}),s=o.length,o.sort(R);s--;)o[s]=o[s].value;return o}function He(e){return e&&"number"==typeof e.length?wn.unindexedChars&&ge(e)?e.split(""):G(e):_e(e)}function Ue(e){for(var t=-1,n=e?e.length:0,i=[];++t<n;){var s=e[t];s&&i.push(s)}return i}function Ye(e){for(var t=-1,n=e?e.length:0,i=Zt.apply(Vt,gn.call(arguments,1)),s=q(i),r=[];++t<n;){var o=e[t];s(o)||r.push(o)}return r}function Be(e,t,n){var i=-1,s=e?e.length:0;for(t=r.createCallback(t,n);++i<s;)if(t(e[i],i,e))return i;return-1}function Ve(e,t,n){if(e){var i=0,s=e.length;if("number"!=typeof t&&null!=t){var o=-1;for(t=r.createCallback(t,n);++o<s&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e[0];return G(e,0,fn(hn(0,i),s))}}function We(e,t,n,i){var s=-1,o=e?e.length:0,a=[];for("boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1),null!=n&&(n=r.createCallback(n,i));++s<o;){var l=e[s];n&&(l=n(l,s,e)),Fn(l)?nn.apply(a,t?l:We(l)):a.push(l)}return a}function Xe(e,t,n){var i=-1,s=e?e.length:0;if("number"==typeof n)i=(n<0?hn(0,s+n):n||0)-1;else if(n)return i=tt(e,t),e[i]===t?i:-1;for(;++i<s;)if(e[i]===t)return i;return-1}function Ge(e,t,n){if(!e)return[];var i=0,s=e.length;if("number"!=typeof t&&null!=t){var o=s;for(t=r.createCallback(t,n);o--&&t(e[o],o,e);)i++}else i=null==t||n?1:t||i;return G(e,0,fn(hn(0,s-i),s))}function Ke(e){var t=arguments,n=t.length,i={0:{}},s=-1,r=e?e.length:0,o=r>=c,a=[],u=a;e:for(;++s<r;){var d=e[s];if(o)var h=l+d,f=i[0][h]?!(u=i[0][h]):u=i[0][h]=[];if(f||Xe(u,d)<0){o&&u.push(d);for(var p=n;--p;)if(!(i[p]||(i[p]=q(t[p])))(d))continue e;a.push(d)}}return a}function Je(e,t,n){if(e){var i=0,s=e.length;if("number"!=typeof t&&null!=t){var o=s;for(t=r.createCallback(t,n);o--&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e[s-1];return G(e,hn(0,s-i))}}function Ze(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(n<0?hn(0,i+n):fn(n,i-1))+1);i--;)if(e[i]===t)return i;return-1}function Qe(e,t,n){e=+e||0,n=+n||1,null==t&&(t=e,e=0);for(var i=-1,s=hn(0,Kt((t-e)/n)),r=jt(s);++i<s;)r[i]=e,e+=n;return r}function et(e,t,n){if("number"!=typeof t&&null!=t){var i=0,s=-1,o=e?e.length:0;for(t=r.createCallback(t,n);++s<o&&t(e[s],s,e);)i++}else i=null==t||n?1:hn(0,t);return G(e,i)}function tt(e,t,n,i){var s=0,o=e?e.length:s;for(n=n?r.createCallback(n,i,1):Ct,t=n(t);s<o;){var a=s+o>>>1;n(e[a])<t?s=a+1:o=a}return s}function nt(e){return Fn(e)||(arguments[0]=e?gn.call(e):Vt),it(Zt.apply(Vt,arguments))}function it(e,t,n,i){var s=-1,o=e?e.length:0,a=[],u=a;"boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1);var d=!t&&o>=c;if(d)var h={};for(null!=n&&(u=[],n=r.createCallback(n,i));++s<o;){var f=e[s],p=n?n(f,s,e):f;if(d)var m=l+p,g=h[m]?!(u=h[m]):u=h[m]=[];(t?!s||u[u.length-1]!==p:g||Xe(u,p)<0)&&((n||d)&&u.push(p),a.push(f))}return a}function st(e){for(var t=-1,n=e?e.length:0,i=n?Pe(jn(e,"length")):0,s=jt(i);++t<n;)for(var r=-1,o=e[t];++r<i;)(s[r]||(s[r]=jt(n)))[t]=o[r];return s}function rt(e){return Ye(e,gn.call(arguments,1))}function ot(e){for(var t=-1,n=e?Pe(jn(arguments,"length")):0,i=jt(n);++t<n;)i[t]=jn(arguments,t);return i}function at(e,t){for(var n=-1,i=e?e.length:0,s={};++n<i;){var r=e[n];t?s[r]=t[n]:s[r[0]]=r[1]}return s}function lt(e,t){return e<1?t():function(){if(--e<1)return t.apply(this,arguments)}}function ct(e,t){return wn.fastBind||an&&arguments.length>2?an.call.apply(an,arguments):z(e,t,gn.call(arguments,2))}function ut(e){for(var t=arguments.length>1?Zt.apply(Vt,gn.call(arguments,1)):te(e),n=-1,i=t.length;++n<i;){var s=t[n];e[s]=ct(e[s],e)}return e}function dt(e,t){return z(e,t,gn.call(arguments,2),a)}function ht(){var e=arguments;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function ft(e,t,n){if(null==e)return Ct;var i=typeof e;if("function"!=i){if("object"!=i)return function(t){return t[e]};var s=Tn(e);return function(t){for(var n=s.length,i=!1;n--&&(i=le(t[s[n]],e[s[n]],a)););return i}}return"undefined"!=typeof t?1===n?function(n){return e.call(t,n)}:2===n?function(n,i){return e.call(t,n,i)}:4===n?function(n,i,s,r){return e.call(t,n,i,s,r)}:function(n,i,s){return e.call(t,n,i,s)}:e}function pt(e,t,n){function i(){r=l=null,c&&(o=e.apply(a,s))}var s,r,o,a,l,c=!0;if(n===!0){var u=!0;c=!1}else n&&L[typeof n]&&(u=n.leading,c="trailing"in n?n.trailing:c);return function(){return s=arguments,a=this,Jt(l),!r&&u?(r=!0,o=e.apply(a,s)):l=rn(i,t),o}}function mt(e){var t=gn.call(arguments,1);return rn(function(){e.apply(n,t)},1)}function gt(e,t){var i=gn.call(arguments,2);return rn(function(){e.apply(n,i)},t)}function vt(e,t){var n={};return function(){var i=l+(t?t.apply(this,arguments):arguments[0]);return tn.call(n,i)?n[i]:n[i]=e.apply(this,arguments)}}function bt(e){var t,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function yt(e){return z(e,gn.call(arguments,1))}function wt(e){return z(e,gn.call(arguments,1),null,a)}function kt(e,t,n){function i(){a=null,u&&(l=new qt,r=e.apply(o,s))}var s,r,o,a,l=0,c=!0,u=!0;return n===!1?c=!1:n&&L[typeof n]&&(c="leading"in n?n.leading:c,u="trailing"in n?n.trailing:u),function(){var n=new qt;a||c||(l=n);var u=t-(n-l);return s=arguments,o=this,u<=0?(Jt(a),a=null,l=n,r=e.apply(o,s)):a||(a=rn(i,u)),r}}function _t(e,t){return function(){var n=[e];return nn.apply(n,arguments),t.apply(this,n)}}function xt(e){return null==e?"":Yt(e).replace(w,Y)}function Ct(e){return e}function Ft(e){De(te(e),function(t){var n=r[t]=e[t];r.prototype[t]=function(){var e=this.__wrapped__,t=[e];nn.apply(t,arguments);var i=n.apply(r,t);return e&&"object"==typeof e&&e==i?this:new V(i)}})}function St(){return i._=Xt,this}function Tt(e,t){return null==e&&null==t&&(t=1),e=+e||0,null==t&&(t=e,e=0),e+Qt(mn()*((+t||0)-e+1))}function Et(e,t){var i=e?e[t]:n;return ue(i)?e[t]():i}function Dt(e,t,i){var s=r.templateSettings;e||(e=""),i=$n({},i,s);var o,a=$n({},i.imports,s.imports),l=Tn(a),c=_e(a),f=0,m=i.interpolate||y,v="__p += '",b=Ut((i.escape||y).source+"|"+m.source+"|"+(m===g?p:y).source+"|"+(i.evaluate||y).source+"|$","g");e.replace(b,function(t,n,i,s,r,a){return i||(i=s),v+=e.slice(f,a).replace(k,U),n&&(v+="' +\n__e("+n+") +\n'"),r&&(o=!0,v+="';\n"+r+";\n__p += '"),i&&(v+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),f=a+t.length,t}),v+="';\n";var w=i.variable,_=w;_||(w="obj",v="with ("+w+") {\n"+v+"\n}\n"),v=(o?v.replace(u,""):v).replace(d,"$1").replace(h,"$1;"),v="function("+w+") {\n"+(_?"":w+" || ("+w+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+v+"return __p\n}";var x="\n/*\n//# sourceURL="+(i.sourceURL||"/lodash/template/source["+C++ +"]")+"\n*/";try{var F=Nt(l,"return "+v+x).apply(n,c)}catch(S){throw S.source=v,S}return t?F(t):(F.source=v,F)}function Mt(e,t,n){e=(e=+e)>-1?e:0;var i=-1,s=jt(e);for(t=r.createCallback(t,n,1);++i<e;)s[i]=t(i);return s}function At(e){return null==e?"":Yt(e).replace(f,K)}function $t(e){var t=++o;return Yt(null==e?"":e)+t}function Pt(e,t){return t(e),e}function It(){return Yt(this.__wrapped__)}function Lt(){return this.__wrapped__}i=i?O.defaults(e.Object(),i,O.pick(e,_)):e;var jt=i.Array,Ot=i.Boolean,qt=i.Date,Nt=i.Function,Rt=i.Math,zt=i.Number,Ht=i.Object,Ut=i.RegExp,Yt=i.String,Bt=i.TypeError,Vt=jt(),Wt=Ht(),Xt=i._,Gt=Ut("^"+Yt(Wt.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Kt=Rt.ceil,Jt=i.clearTimeout,Zt=Vt.concat,Qt=Rt.floor,en=Gt.test(en=Ht.getPrototypeOf)&&en,tn=Wt.hasOwnProperty,nn=Vt.push,sn=i.setImmediate,rn=i.setTimeout,on=Wt.toString,an=Gt.test(an=on.bind)&&an,ln=Gt.test(ln=jt.isArray)&&ln,cn=i.isFinite,un=i.isNaN,dn=Gt.test(dn=Ht.keys)&&dn,hn=Rt.max,fn=Rt.min,pn=i.parseInt,mn=Rt.random,gn=Vt.slice,vn=Gt.test(i.attachEvent),bn=an&&!/\n|true/.test(an+vn),yn={};yn[S]=jt,yn[T]=Ot,yn[E]=qt,yn[A]=Ht,yn[M]=zt,yn[$]=Ut,yn[P]=Yt;var wn=r.support={};!function(){var e=function(){this.x=1},t={0:1,length:1},n=[];e.prototype={valueOf:1,y:1};for(var i in new e)n.push(i);for(i in arguments);wn.argsObject=arguments.constructor==Ht&&!(arguments instanceof jt),wn.argsClass=J(arguments),wn.enumPrototypes=e.propertyIsEnumerable("prototype"),wn.fastBind=an&&!bn,wn.ownLast="x"!=n[0],wn.nonEnumArgs=0!=i,wn.nonEnumShadows=!/valueOf/.test(n),wn.spliceObjects=(Vt.splice.call(t,0,1),!t[0]),wn.unindexedChars="x"[0]+Ht("x")[0]!="xx";try{wn.nodeClass=!(on.call(document)==A&&!({toString:0}+""))}catch(s){wn.nodeClass=!0}}(1),r.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:g,variable:"",imports:{_:r}};var kn=function(e){var t="var index, iterable = "+e.firstArg+", result = "+e.init+";\nif (!iterable) return result;\n"+e.top+";\n";if(e.arrays?(t+="var length = iterable.length; index = -1;\nif ("+e.arrays+") {  ",wn.unindexedChars&&(t+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),t+="\n  while (++index < length) {\n    "+e.loop+"\n  }\n}\nelse {  "):wn.nonEnumArgs&&(t+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+e.loop+"\n    }\n  } else {  "),wn.enumPrototypes&&(t+="\n  var skipProto = typeof iterable == 'function';\n  "),e.useHas&&e.useKeys)t+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] ? keys(iterable) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    ",wn.enumPrototypes&&(t+="if (!(skipProto && index == 'prototype')) {\n  "),t+=e.loop,wn.enumPrototypes&&(t+="}\n"),t+="  }  ";else if(t+="\n  for (index in iterable) {",(wn.enumPrototypes||e.useHas)&&(t+="\n    if (",wn.enumPrototypes&&(t+="!(skipProto && index == 'prototype')"),wn.enumPrototypes&&e.useHas&&(t+=" && "),e.useHas&&(t+="hasOwnProperty.call(iterable, index)"),t+=") {    "),t+=e.loop+";    ",(wn.enumPrototypes||e.useHas)&&(t+="\n    }"),t+="\n  }    ",wn.nonEnumShadows){t+="\n\n  var ctor = iterable.constructor;\n      ";for(var n=0;n<7;n++)t+="\n  index = '"+e.shadowedProps[n]+"';\n  if (","constructor"==e.shadowedProps[n]&&(t+="!(ctor && ctor.prototype === iterable) && "),t+="hasOwnProperty.call(iterable, index)) {\n    "+e.loop+"\n  }      "}return(e.arrays||wn.nonEnumArgs)&&(t+="\n}"),t+=e.bottom+";\nreturn result"},_n={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},xn={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",arrays:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},Cn={top:"if (!objectTypes[typeof iterable]) return result;\n"+xn.top,arrays:!1};V.prototype=r.prototype,wn.argsClass||(J=function(e){return!!e&&tn.call(e,"callee")});var Fn=ln||function(e){return!!e&&("object"==typeof e&&on.call(e)==S)},Sn=H({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)",arrays:!1}),Tn=dn?function(e){return de(e)?wn.enumPrototypes&&"function"==typeof e||wn.nonEnumArgs&&e.length&&J(e)?Sn(e):dn(e):[]}:Sn,En=H(xn),Dn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Mn=ie(Dn),An=H(_n,{top:_n.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),$n=H(_n),Pn=H(xn,Cn,{useHas:!1}),In=H(xn,Cn);ue(/x/)&&(ue=function(e){return"function"==typeof e&&on.call(e)==D});var Ln=en?function(e){if(!e||on.call(e)!=A||!wn.argsClass&&J(e))return!1;var t=e.valueOf,n="function"==typeof t&&(n=en(t))&&en(n);return n?e==n||en(e)==n:X(e)}:X,jn=$e,On=Te;bn&&s&&"function"==typeof sn&&(mt=ct(sn,i));var qn=8==pn(v+"08")?pn:function(e,t){return pn(ge(e)?e.replace(b,""):e,t||0)};return r.after=lt,r.assign=An,r.at=xe,r.bind=ct,r.bindAll=ut,r.bindKey=dt,r.compact=Ue,r.compose=ht,r.countBy=Fe,r.createCallback=ft,r.debounce=pt,r.defaults=$n,r.defer=mt,r.delay=gt,r.difference=Ye,r.filter=Te,r.flatten=We,r.forEach=De,r.forIn=Pn,r.forOwn=In,r.functions=te,r.groupBy=Me,r.initial=Ge,r.intersection=Ke,r.invert=ie,r.invoke=Ae,r.keys=Tn,r.map=$e,r.max=Pe,r.memoize=vt,r.merge=be,r.min=Ie,r.omit=ye,r.once=bt,r.pairs=we,r.partial=yt,r.partialRight=wt,r.pick=ke,r.pluck=jn,r.range=Qe,r.reject=Oe,r.rest=et,r.shuffle=qe,r.sortBy=ze,r.tap=Pt,r.throttle=kt,r.times=Mt,r.toArray=He,r.union=nt,r.uniq=it,r.unzip=st,r.values=_e,r.where=On,r.without=rt,r.wrap=_t,r.zip=ot,r.zipObject=at,r.collect=$e,r.drop=et,r.each=De,r.extend=An,r.methods=te,r.object=at,r.select=Te,r.tail=et,r.unique=it,Ft(r),r.clone=Z,r.cloneDeep=Q,r.contains=Ce,r.escape=xt,r.every=Se,r.find=Ee,r.findIndex=Be,r.findKey=ee,r.has=ne,r.identity=Ct,r.indexOf=Xe,r.isArguments=J,r.isArray=Fn,r.isBoolean=se,r.isDate=re,r.isElement=oe,r.isEmpty=ae,r.isEqual=le,r.isFinite=ce,r.isFunction=ue,r.isNaN=he,r.isNull=fe,r.isNumber=pe,r.isObject=de,r.isPlainObject=Ln,r.isRegExp=me,r.isString=ge,r.isUndefined=ve,r.lastIndexOf=Ze,r.mixin=Ft,r.noConflict=St,r.parseInt=qn,r.random=Tt,r.reduce=Le,r.reduceRight=je,r.result=Et,r.runInContext=t,r.size=Ne,r.some=Re,r.sortedIndex=tt,r.template=Dt,r.unescape=At,r.uniqueId=$t,r.all=Se,r.any=Re,r.detect=Ee,r.foldl=Le,r.foldr=je,r.include=Ce,r.inject=Le,In(r,function(e,t){r.prototype[t]||(r.prototype[t]=function(){var t=[this.__wrapped__];return nn.apply(t,arguments),e.apply(r,t)})}),r.first=Ve,r.last=Je,r.take=Ve,r.head=Ve,In(r,function(e,t){r.prototype[t]||(r.prototype[t]=function(t,n){var i=e(this.__wrapped__,t,n);return null==t||n&&"function"!=typeof t?i:new V(i)})}),r.VERSION="1.2.1",r.prototype.toString=It,r.prototype.value=Lt,r.prototype.valueOf=Lt,En(["join","pop","shift"],function(e){var t=Vt[e];r.prototype[e]=function(){return t.apply(this.__wrapped__,arguments)}}),En(["push","reverse","sort","unshift"],function(e){var t=Vt[e];r.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),En(["concat","slice","splice"],function(e){var t=Vt[e];r.prototype[e]=function(){return new V(t.apply(this.__wrapped__,arguments))}}),wn.spliceObjects||En(["pop","shift","splice"],function(e){var t=Vt[e],n="splice"==e;r.prototype[e]=function(){var e=this.__wrapped__,i=t.apply(e,arguments);return 0===e.length&&delete e[0],n?new V(i):i}}),r}var n,i="object"==typeof exports&&exports,s="object"==typeof module&&module&&module.exports==i&&module,r="object"==typeof global&&global;r.global!==r&&r.window!==r||(e=r);var o=0,a={},l=+new Date+"",c=200,u=/\b__p \+= '';/g,d=/\b(__p \+=) '' \+/g,h=/(__e\(.*?\)|\b__t\)) \+\n'';/g,f=/&(?:amp|lt|gt|quot|#39);/g,p=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,m=/\w*$/,g=/<%=([\s\S]+?)%>/g,v=" \t\x0B\f \ufeff\n\r\u2028\u2029 ᠎             　",b=RegExp("^["+v+"]*0+(?=.$)"),y=/($^)/,w=/[&<>"']/g,k=/['\n\r\t\u2028\u2029\\]/g,_=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],x=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],C=0,F="[object Arguments]",S="[object Array]",T="[object Boolean]",E="[object Date]",D="[object Function]",M="[object Number]",A="[object Object]",$="[object RegExp]",P="[object String]",I={};I[D]=!1,I[F]=I[S]=I[T]=I[E]=I[M]=I[A]=I[$]=I[P]=!0;var L={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},j={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},O=t();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(e._=O,define("underscore",[],function(){return O})):i&&!i.nodeType?s?(s.exports=O)._=O:i._=O:e._=O}(this),define("globals",["require","config","underscore"],function(e){var t=e("config"),n=e("underscore"),i={STATE:{EMPTY:0,UPLOADING:1,READY:2},PROCESS_STATE:{NORMAL:1,PURCHASE:2},msg:{isProductOwner:"Sorry, but you can't purchase your own products.",product:{tooltip:"Include ONLY product files for sale<br> (DO NOT INCLUDE<br> license, screenshots, etc).<br> Zip multiple files together.<br> Max of 1GB.",maxFileSize:"The file you uploaded was too large. Please keep files below 1GB.",cancelled:"The file upload was cancelled.",acceptFileRegEx:"Please select a file with the correct format.",uploadError:"There was an error while trying to upload your file. Please try again.",remove:"Are you sure you want to remove this file?",removeFreeGood:"This file cannot be deleted while the product is offered as a free good",unsupportedFileType:"This file type is not supported. Please try a JPG, PNG, or RAW file.",dimensions:"This file must be at least 580x386px."},screenshot:{maximumFiles:"A maximum of %d screenshots are allowed.",maxFileSize:"The screenshot you uploaded was too large. Please keep files below 5MB.",cancelled:"The screenshot upload was cancelled.",acceptFileRegEx:"Please select a file that's a JPG, PNG, or GIF image.",badImageSize:"Your screenshot image must be at least 580x386px.",uploadError:"There was an error while trying to upload your screenshot. Please try again.",remove:"Are you sure you want to remove this screenshot?"},gallery:{tooltip:"Show your product in action.<br> Screenshots must be at least 580x386px<br> in PNG, JPG or GIF format."},size:{invalid:'Your size input was invalid.<br> Make sure your size is something<br> like "2.3x2.3" (up to 4 decimal places) or "2x2"<br> Max 30000x30000'},dpi:{invalid:"Your DPI exceeds the maximum value: "},size_texture:{invalid:'Your texture resolution input was invalid. Make sure your size is something<br> like "250x250"'},browser:{invalid:"Your browser version is invalid.<br> Make sure the value is under 5 characters and<br> is a proper version number."},location:{empty:"Please fill out a location"},livePreview:{invalid:"Your preview URL is not a valid URL.<br> Ensure that it starts with http://<br> and is accessible via a web browser.",empty:"Please fill out a valid url in the Preview URL field on the right",preview:"Almost there! Hit <i>save</i> to see this preview URL in action."},session:{facebook_generic:"There was an error while communicating with Facebook <br>Please refresh the page and try again"},collections:{confirm:"Do you want to close without saving changes?"},generic:{tooltip:"Your input is invalid"}}};return n.extend(i,t)}),function(e,t){"undefined"!=typeof exports?t(e,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(n,i,s){e.Backbone=t(e,s,n,i)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){var s=e.Backbone,r=[],o=r.push,a=r.slice,l=r.splice;t.VERSION="1.0.0",t.$=i,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var c=t.Events={on:function(e,t,n){if(!d(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!d(this,"once",e,[t,i])||!t)return this;var s=this,r=n.once(function(){s.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,i)},off:function(e,t,i){var s,r,o,a,l,c,u,h;if(!this._events||!d(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(a=e?[e]:n.keys(this._events),l=0,c=a.length;l<c;l++)if(e=a[l],o=this._events[e]){if(this._events[e]=s=[],t||i)for(u=0,h=o.length;u<h;u++)r=o[u],(t&&t!==r.callback&&t!==r.callback._callback||i&&i!==r.context)&&s.push(r);s.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!d(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&h(n,t),i&&h(i,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var s=!t&&!n;"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e);for(var r in i)i[r].off(t,n,this),s&&delete this._listeners[r];return this}},u=/\s+/,d=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var s in n)e[t].apply(e,[s,n[s]].concat(i));return!1}if(u.test(n)){for(var r=n.split(u),o=0,a=r.length;o<a;o++)e[t].apply(e,[r[o]].concat(i));return!1}return!0},h=function(e,t){var n,i=-1,s=e.length,r=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++i<s;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<s;)(n=e[i]).callback.call(n.ctx,r);return;case 2:for(;++i<s;)(n=e[i]).callback.call(n.ctx,r,o);return;case 3:for(;++i<s;)(n=e[i]).callback.call(n.ctx,r,o,a);return;default:for(;++i<s;)(n=e[i]).callback.apply(n.ctx,t)}},f={listenTo:"on",listenToOnce:"once"};n.each(f,function(e,t){c[t]=function(t,i,s){var r=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=n.uniqueId("l"));return r[o]=t,"object"==typeof i&&(s=this),t[e](i,s,this),this}}),c.bind=c.on,c.unbind=c.off,n.extend(t,c);var p=t.Model=function(e,t){var i,s=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},n.extend(this,n.pick(t,m)),t.parse&&(s=this.parse(s,t)||{}),(i=n.result(this,"defaults"))&&(s=n.defaults({},s,i)),this.set(s,t),this.changed={},this.initialize.apply(this,arguments)},m=["url","urlRoot","collection"];n.extend(p.prototype,c,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var s,r,o,a,l,c,u,d;if(null==e)return this;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;o=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),d=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(s in r)t=r[s],n.isEqual(d[s],t)||a.push(s),n.isEqual(u[s],t)?delete this.changed[s]:this.changed[s]=t,o?delete d[s]:d[s]=t;if(!l){a.length&&(this._pending=!0);for(var h=0,f=a.length;h<f;h++)this.trigger("change:"+a[h],this,d[a[h]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{
unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n.clone(this.changed);var t,i=!1,s=this._changing?this._previousAttributes:this.attributes;for(var r in e)n.isEqual(s[r],t=e[r])||((i||(i={}))[r]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return!!t.set(t.parse(n,e),e)&&(i&&i(t,n,e),void t.trigger("sync",t,n,e))},q(this,e),this.sync("read",this,e)},save:function(e,t,i){var s,r,o,a=this.attributes;if(null==e||"object"==typeof e?(s=e,i=t):(s={})[e]=t,s&&(!i||!i.wait)&&!this.set(s,i))return!1;if(i=n.extend({validate:!0},i),!this._validate(s,i))return!1;s&&i.wait&&(this.attributes=n.extend({},a,s)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=n.extend(s||{},t)),!(n.isObject(t)&&!l.set(t,i))&&(c&&c(l,e,i),void l.trigger("sync",l,e,i))},q(this,i),r=this.isNew()?"create":i.patch?"patch":"update","patch"===r&&(i.attrs=s),o=this.sync(r,this,i),s&&i.wait&&(this.attributes=a),o},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,s=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&s(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;q(this,e);var r=this.sync("delete",this,e);return e.wait||s(),r},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||O();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return!i||(this.trigger("invalid",this,i,n.extend(t||{},{validationError:i})),!1)}});var g=["keys","values","pairs","invert","pick","omit"];n.each(g,function(e){p.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var v=t.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},b={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};n.extend(v.prototype,c,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.defaults(t||{},y))},remove:function(e,t){e=n.isArray(e)?e.slice():[e],t||(t={});var i,s,r,o;for(i=0,s=e.length;i<s;i++)o=this.get(e[i]),o&&(delete this._byId[o.id],delete this._byId[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,t.silent||(t.index=r,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){t=n.defaults(t||{},b),t.parse&&(e=this.parse(e,t)),n.isArray(e)||(e=e?[e]:[]);var i,s,r,a,c,u=t.at,d=this.comparator&&null==u&&t.sort!==!1,h=n.isString(this.comparator)?this.comparator:null,f=[],p=[],m={};for(i=0,s=e.length;i<s;i++)(r=this._prepareModel(e[i],t))&&((a=this.get(r))?(t.remove&&(m[a.cid]=!0),t.merge&&(a.set(r.attributes,t),d&&!c&&a.hasChanged(h)&&(c=!0))):t.add&&(f.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)));if(t.remove){for(i=0,s=this.length;i<s;++i)m[(r=this.models[i]).cid]||p.push(r);p.length&&this.remove(p,t)}if(f.length&&(d&&(c=!0),this.length+=f.length,null!=u?l.apply(this.models,[u,0].concat(f)):o.apply(this.models,f)),c&&this.sort({silent:!0}),t.silent)return this;for(i=0,s=f.length;i<s;i++)(r=f[i]).trigger("add",r,this,t);return c&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var i=0,s=this.models.length;i<s;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,n.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,n.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(null!=e)return this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,i){t||(t=this.comparator);var s=n.isFunction(t)?t:function(e){return e.get(t)};return n.sortedIndex(this.models,e,s,i)},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var s=e.reset?"reset":"set";i[s](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},q(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,s=t.success;return t.success=function(n){t.wait&&i.add(e,t),s&&s(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var w=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];n.each(w,function(e){v.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var k=["groupBy","countBy","sortBy"];n.each(k,function(e){v.prototype[e]=function(t,i){var s=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,s,i)}});var _=t.View=function(e){this.cid=n.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];n.extend(_.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var s=t.match(x),r=s[1],o=s[2];i=n.bind(i,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,i):this.$el.on(r,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=n.extend({},n.result(this,"options"),e)),n.extend(this,n.pick(e,C)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,s){var r=F[e];n.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:r,dataType:"json"};if(s.url||(o.url=n.result(i,"url")||O()),null!=s.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(s.attrs||i.toJSON(s))),s.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),s.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",s.emulateJSON&&(o.data._method=r);var a=s.beforeSend;s.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",r),a)return a.apply(this,arguments)}}"GET"===o.type||s.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=s.xhr=t.ajax(n.extend(o,s));return i.trigger("request",i,l,s),l};var F={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,D=/\*\w+/g,M=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(S.prototype,c,{initialize:function(){},route:function(e,i,s){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(s=i,i=""),s||(s=this[i]);var r=this;return t.history.route(e,function(n){var o=r._extractParameters(e,n);s&&s.apply(r,o),r.trigger.apply(r,["route:"+i].concat(o)),r.trigger("route",i,o),t.history.trigger("route",r,i,o)}),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(M,"\\$&").replace(T,"(?:$1)?").replace(E,function(e,t){return t?e:"([^/]+)"}).replace(D,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e){return e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},$=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,I=/msie [\w.]+/,L=/\/$/;A.started=!1,n.extend(A.prototype,c,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(L,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace($,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=n.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),s=document.documentMode,r=I.exec(navigator.userAgent.toLowerCase())&&(!s||s<=7);this.root=("/"+this.root+"/").replace(P,"/"),r&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace($,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),A.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t!==this.fragment&&(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(e){var t=this.fragment=this.getFragment(e),i=n.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return i},navigate:function(e,t){if(!A.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new A;var j=function(e,t){var i,s=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},n.extend(i,s,t);var r=function(){this.constructor=i};return r.prototype=s.prototype,i.prototype=new r,e&&n.extend(i.prototype,e),i.__super__=s.prototype,i};p.extend=v.extend=S.extend=_.extend=A.extend=j;var O=function(){throw new Error('A "url" property or function must be specified')},q=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),define("event_bus",["underscore","backbone"],function(e,t){return window.EventBus=e.extend({},t.Events),EventBus}),define("shared/cookies",["require","exports","module","underscore"],function(e,t,n){var i=e("underscore"),s=t.set=function(e,t,n){var s=location.hostname.toLowerCase(),r=new Date,o=e+"="+escape(t)+"; ";n&&!i.isNaN(n)&&(r.setTime((new Date).getTime()+1e3*n),o+="expires="+r.toGMTString()+"; "),o+="path=/; domain=."+s,document.cookie=o};t.get=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var s=n[i];" "===s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(t))return unescape(s.substring(t.length,s.length))}return null},t.destroy=function(e){s(e,"",-1)}}),define("shared/csrf_request",["require","jquery","shared/cookies"],function(e){var t=e("jquery"),n=e("shared/cookies"),i=function(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)},s=function(e){var t=document.location.host,n=document.location.protocol,i="//"+t,s=n+i;return e===s||e.slice(0,s.length+1)===s+"/"||e===i||e.slice(0,i.length+1)===i+"/"||!/^(\/\/|http:|https:).*/.test(e)};t(document).ajaxSend(function(e,t,r){!i(r.type)&&s(r.url)&&t.setRequestHeader("X-CSRFToken",n.get("cmcsr")||n.get("csrftoken"))})}),define("shared/extend_natives",["require","exports","module"],function(e,t,n){Function.prototype.bind&&window.console&&"object"==typeof window.console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){window.console[e]=this.call(window.console[e],console)},Function.prototype.bind),String.prototype.stripLowerASCII=function(){return this.replace(/([\x00-\x08\x0b-\x0c\x0e-\x19])/g,"")},String.prototype.base64Decode=function(){for(var e,t,n,i,s,r,o,a="",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,u=this.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<u.length;)i=l.indexOf(u.charAt(c++)),s=l.indexOf(u.charAt(c++)),r=l.indexOf(u.charAt(c++)),o=l.indexOf(u.charAt(c++)),e=i<<2|s>>4,t=(15&s)<<4|r>>2,n=(3&r)<<6|o,a+=String.fromCharCode(e),64!=r&&(a+=String.fromCharCode(t)),64!=o&&(a+=String.fromCharCode(n));return a.utf8Decode()},String.prototype.utf8Decode=function(){for(var e="",t=0,n=0,i=0,s=0,r=this;t<this.length;)n=r.charCodeAt(t),n<128?(e+=String.fromCharCode(n),t++):n>191&&n<224?(i=r.charCodeAt(t+1),e+=String.fromCharCode((31&n)<<6|63&i),t+=2):(i=r.charCodeAt(t+1),s=r.charCodeAt(t+2),e+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&s),t+=3);return e}}),define("shared/regex",["require","exports","module"],function(e,t,n){t.EMAIL_ADDRESS=/^[a-z0-9!#$%&\'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,15})\b$/i,t.USERNAME=/^[^\x00-\x2C\x3A-\x40\x5B-\x5E\x7B-\x7F`\/]{2,20}$/,t.URL=/^https?:\/\/([\-\w\.]+)+(:\d+)?(\/([\w\/_\.]*(\?\S+)?)?)?/,t.PHONE_NUMBER=/^(?:[0-9] ?){6,14}[0-9]$/}),function(e){"function"==typeof define&&define.amd?define("vendor/jquery/tipsy",["jquery"],e):e(jQuery)}(function(e){function t(e,t){return"function"==typeof e?e.call(t):e}function n(e){for(;e=e.parentNode;)if(e==document)return!0;return!1}function i(t,n){this.$element=e(t),this.options=n,this.enabled=!0,this.fixTitle()}i.prototype={show:function(){var n=this.getTitle();if(n&&this.enabled){var i=this.tip();i.find(".tipsy-inner")[this.options.html?"html":"text"](n),i[0].className="tipsy";var s;s=null===this.options.target?document.body:this.options.target,i.remove().css({top:0,left:0,visibility:"hidden",display:"block",position:this.options.cssPosition}).prependTo(s),this.options.className&&i.addClass(t(this.options.className,this.$element[0]));var r,o=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),a=i[0].offsetWidth,l=i[0].offsetHeight,c=t(this.options.gravity,this.$element[0]);switch(c.charAt(0)){case"n":r={top:o.top+o.height+this.options.offset,left:o.left+o.width/2-a/2};break;case"s":r={top:o.top-l-this.options.offset,left:o.left+o.width/2-a/2};break;case"e":r={top:o.top+o.height/2-l/2,left:o.left-a-this.options.offset};break;case"w":r={top:o.top+o.height/2-l/2,left:o.left+o.width+this.options.offset}}if(2==c.length&&("w"==c.charAt(1)?r.left=o.left+o.width/2-15:r.left=o.left+o.width/2-a+15),i.css(r).addClass("tipsy-"+c),i.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+c.charAt(0),this.options.fade){i.stop().css({opacity:0,display:"block",visibility:"visible"});var u="function"==typeof e.fn.transit?"transition":"animate";i[u]({opacity:this.options.opacity},this.options.fadeSpeed)}else i.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){e(this).remove()}):this.tip().remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("original-title"))&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,n=this.options;this.fixTitle();var e,n=this.options;return"string"==typeof n.title?e=t.attr("title"==n.title?"original-title":n.title):"function"==typeof n.title&&(e=n.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||n.fallback},tip:function(){return this.$tip||(this.$tip=e('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},e.fn.tipsy=function(t){function n(n){var s=e.data(n,"tipsy");return s||(s=new i(n,e.fn.tipsy.elementOptions(n,t)),e.data(n,"tipsy",s)),s}function s(){var e=n(this);e.hoverState="in",0===t.delayIn?e.show():(e.fixTitle(),setTimeout(function(){"in"==e.hoverState&&e.show()},t.delayIn))}function r(){var e=n(this);e.hoverState="out",0===t.delayOut?e.hide():setTimeout(function(){"out"==e.hoverState&&e.hide()},t.delayOut)}if(t===!0)return this.data("tipsy");if("string"==typeof t){var o=this.data("tipsy");return o&&o[t](),this}if(t=e.extend({},e.fn.tipsy.defaults,t),t.live||this.each(function(){n(this)}),"manual"!=t.trigger){var a=t.live?"live":"bind",l="hover"==t.trigger?"mouseenter":"focus",c="hover"==t.trigger?"mouseleave":"blur";this[a](l,s)[a](c,r)}return this},e.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fadeSpeed:600,fallback:"",gravity:"s",html:!1,live:!1,offset:8,opacity:1,title:"title",trigger:"hover",target:null,cssPosition:"absolute"},e.fn.tipsy.revalidate=function(){e(".tipsy").each(function(){var t=e.data(this,"tipsy-pointee");t&&n(t)||e(this).remove()})},e.fn.tipsy.elementOptions=function(t,n){return e.metadata?e.extend({},n,e(t).metadata()):n},e.fn.tipsy.autoNS=function(){return e(this).offset().top>e(document).scrollTop()+e(window).height()/2?"s":"n"},e.fn.tipsy.autoWE=function(){return e(this).offset().left>e(document).scrollLeft()+e(window).width()/2?"e":"w"},e.fn.tipsy.autoBounds=function(t,n){return function(){var i={ns:n[0],ew:n.length>1&&n[1]},s=e(document).scrollTop()+t,r=e(document).scrollLeft()+t,o=e(this);return o.offset().top<s&&(i.ns="n"),o.offset().left<r&&(i.ew="w"),e(window).width()+e(document).scrollLeft()-o.offset().left<t&&(i.ew="e"),e(window).height()+e(document).scrollTop()-o.offset().top<t&&(i.ns="s"),i.ns+(i.ew?i.ew:"")}}}),define("shared/tooltip",["require","exports","module","jquery","underscore","vendor/jquery/tipsy"],function(e,t,n){var i=e("jquery"),s=e("underscore");e("vendor/jquery/tipsy");t.DEFAULT_OPTS={gravity:"w",offset:8,fade:!1,html:!0,trigger:"manual"},t.quickDisplay=function(e,t,n){n||(n={}),e=i(e),e.data("tipsy")||e.tipsy(s.extend({fade:!0,trigger:"manual"},n)),t&&e.attr("original-title",t),e.tipsy("show"),setTimeout(function(){e.tipsy("hide")},5e3)}}),define("shared/util",["require","exports","module","jquery","underscore","shared/tooltip","shared/regex"],function(e,t,n){var i=e("jquery"),s=(e("underscore"),e("shared/tooltip")),r=e("shared/regex");t.strcmp=function(e,t){return e&&e.localeCompare?e.localeCompare(t):e>t?1:e<t?-1:0},t.formatPrice=function(e,t,n){return n=n||!1,e=parseFloat(e),0===e?n?"":"Free":(e="$"+parseFloat(e).toFixed(2).toString(),t===!0&&(e=e.replace(/\.00$/,"")),e)},t.toggleAll=function(e,t){i("."+e).each(function(){i(this).prop("checked",i(t).prop("checked"))})},t.confirmRedirect=function(e,t){return!!confirm(e)&&(window.location.href=t,!0)},t.formatFileSize=function(e){return"number"!=typeof e?"":e>=1e9?(e/1e9).toFixed(2)+" GB":e>=1e6?(e/1e6).toFixed(2)+" MB":(e/1e3).toFixed(2)+" KB"},t.buildAjaxUpdaterRequest=function(e,t){e=e||{},e.page="/_page_"+a(e.page).toString(),e.args="string"==typeof e.args?"/"+e.args:"",e.params="string"==typeof e.params?i.parseJSON(e.params):"",e.fadeIn=void 0!==e.fadeIn&&!!e.fadeIn,"string"==typeof e.elementID?""===e.params?e.params={contentElementID:e.elementID}:e.params.contentElementID=e.elementID:e.elementID=e.file;var n=i("#"+e.elementID);if(0===n.length)throw new Error("Cannot find element #"+e.elementID);i.get("/ajax/"+e.file+e.args+e.page,e.params,function(i){e.fadeIn?n.fadeOut(100,function(){n.html(i),window.cmPictureFill(),n.fadeIn(250)}):(n.html(i),window.cmPictureFill()),"function"==typeof e.success&&e.success(),"function"==typeof t&&t(i),void 0!==e.anchor&&o(e.anchor)})};var o=t.goToAnchor=function(e){if(""!==i.trim(e)||e instanceof i){e=e instanceof i?e:"#"+e;var t=i("#toolbar-status"),n=0;0!==t.length&&(n+=t.height()),i.scrollTo(e,600,{offset:n*-1,margin:!0})}},a=(t.centerWindow=function(e,t){if(e instanceof i){t=t||600;var n=e.offset().top,s=e.height(),r=i(window).height(),o=n;s<r&&(o=n-(r/2-s/2)),i("html, body").animate({scrollTop:o},t)}},t.intval=function(e,t){return e=parseInt(e,t||10),isNaN(e)?0:e});t.truncate=function(e,t,n){if(e.length<=t)return e;n=n||"...";var i=n.length,s=t-i,r=Math.ceil(s/2),o=Math.floor(s/2);return e.substr(0,r)+n+e.substr(e.length-o)},t.md5=function(e){function t(e,t,n,i,s,r){return t=d(d(t,e),d(i,r)),d(t<<s|t>>>32-s,n)}function n(e,n,i,s,r,o,a){return t(n&i|~n&s,e,n,r,o,a)}function i(e,n,i,s,r,o,a){return t(n&s|i&~s,e,n,r,o,a)}function s(e,n,i,s,r,o,a){return t(n^i^s,e,n,r,o,a)}function r(e,n,i,s,r,o,a){return t(i^(n|~s),e,n,r,o,a)}function o(e,t){var o=e[0],a=e[1],l=e[2],c=e[3];o=n(o,a,l,c,t[0],7,-680876936),c=n(c,o,a,l,t[1],12,-389564586),l=n(l,c,o,a,t[2],17,606105819),a=n(a,l,c,o,t[3],22,-1044525330),o=n(o,a,l,c,t[4],7,-176418897),c=n(c,o,a,l,t[5],12,1200080426),l=n(l,c,o,a,t[6],17,-1473231341),a=n(a,l,c,o,t[7],22,-45705983),o=n(o,a,l,c,t[8],7,1770035416),c=n(c,o,a,l,t[9],12,-1958414417),l=n(l,c,o,a,t[10],17,-42063),a=n(a,l,c,o,t[11],22,-1990404162),o=n(o,a,l,c,t[12],7,1804603682),c=n(c,o,a,l,t[13],12,-40341101),l=n(l,c,o,a,t[14],17,-1502002290),a=n(a,l,c,o,t[15],22,1236535329),o=i(o,a,l,c,t[1],5,-165796510),c=i(c,o,a,l,t[6],9,-1069501632),l=i(l,c,o,a,t[11],14,643717713),a=i(a,l,c,o,t[0],20,-373897302),o=i(o,a,l,c,t[5],5,-701558691),c=i(c,o,a,l,t[10],9,38016083),l=i(l,c,o,a,t[15],14,-660478335),a=i(a,l,c,o,t[4],20,-405537848),o=i(o,a,l,c,t[9],5,568446438),c=i(c,o,a,l,t[14],9,-1019803690),l=i(l,c,o,a,t[3],14,-187363961),a=i(a,l,c,o,t[8],20,1163531501),o=i(o,a,l,c,t[13],5,-1444681467),c=i(c,o,a,l,t[2],9,-51403784),l=i(l,c,o,a,t[7],14,1735328473),a=i(a,l,c,o,t[12],20,-1926607734),o=s(o,a,l,c,t[5],4,-378558),c=s(c,o,a,l,t[8],11,-2022574463),l=s(l,c,o,a,t[11],16,1839030562),a=s(a,l,c,o,t[14],23,-35309556),o=s(o,a,l,c,t[1],4,-1530992060),c=s(c,o,a,l,t[4],11,1272893353),l=s(l,c,o,a,t[7],16,-155497632),a=s(a,l,c,o,t[10],23,-1094730640),o=s(o,a,l,c,t[13],4,681279174),c=s(c,o,a,l,t[0],11,-358537222),l=s(l,c,o,a,t[3],16,-722521979),a=s(a,l,c,o,t[6],23,76029189),o=s(o,a,l,c,t[9],4,-640364487),c=s(c,o,a,l,t[12],11,-421815835),l=s(l,c,o,a,t[15],16,530742520),a=s(a,l,c,o,t[2],23,-995338651),o=r(o,a,l,c,t[0],6,-198630844),c=r(c,o,a,l,t[7],10,1126891415),l=r(l,c,o,a,t[14],15,-1416354905),a=r(a,l,c,o,t[5],21,-57434055),o=r(o,a,l,c,t[12],6,1700485571),c=r(c,o,a,l,t[3],10,-1894986606),l=r(l,c,o,a,t[10],15,-1051523),a=r(a,l,c,o,t[1],21,-2054922799),o=r(o,a,l,c,t[8],6,1873313359),c=r(c,o,a,l,t[15],10,-30611744),l=r(l,c,o,a,t[6],15,-1560198380),a=r(a,l,c,o,t[13],21,1309151649),o=r(o,a,l,c,t[4],6,-145523070),c=r(c,o,a,l,t[11],10,-1120210379),l=r(l,c,o,a,t[2],15,718787259),a=r(a,l,c,o,t[9],21,-343485551),e[0]=d(o,e[0]),e[1]=d(a,e[1]),e[2]=d(l,e[2]),e[3]=d(c,e[3])}function a(e){var t,n=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=n;t+=64)o(i,l(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=e.length;for(t=0;t<r;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(o(i,s),t=16;t--;)s[t]=0;return s[14]=8*n,o(i,s),i}function l(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function c(e){for(var t="",n=0;n<4;n++)t+=h[e>>8*n+4&15]+h[e>>8*n&15];return t}function u(e){for(var t=e.length,n=0;n<t;n++)e[n]=c(e[n]);return e.join("")}function d(e,t){return e+t&4294967295}function d(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}var h="0123456789abcdef".split("");return"5d41402abc4b2a76b9719d911017c592"!=u(a("hello")),u(a(e))},t.showThenHideTipsy=s.quickDisplay,t.prefixedEvent=function(e,t,n){for(var i=["webkit","moz","MS","o",""],s=0,r=i.length;s<r;s++)i[s]||(t=t.toLowerCase()),e.on(t,n)},t.getRandStr=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",n=t.length,i="",s=0;s<e;s++)i+=t.substr(Math.floor(Math.random()*n),1);return i},t.getQueryParams=function(){for(var e=window.location.search.substring(1),t=e.split("&"),n={},i=0;i<t.length;i++){var s=t[i].indexOf("=");if(s>0){var r=t[i].substring(0,s),o=t[i].substring(s+1);n[r]=decodeURIComponent(o)}}return n},t.containsLinks=function(e){for(var t=e.split(/\s+/),n=0;n<t.length;n++)if(t[n].match(r.URL))return!0;return!1};var l=t.stripAllLowerASCII=function(e,t){return t=t||"",e.replace(/[\x00-\x1F\x7F]+/g,t)},c=t.stripHtml=function(e){return e.replace(/<\/?[^>]*>/g,"")};t.sanitize=function(e){return e=l(e),e=c(e),e=e.replace(/(<|>)/,"")},t.ucFirst=function(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}}),function(e){"function"==typeof define&&define.amd?define("vendor/jquery/select2",["jquery"],e):e(jQuery)}(function(e){var t=e;!function(e){"undefined"==typeof e.fn.each2&&e.fn.extend({each2:function(t){for(var n=e([0]),i=-1,s=this.length;++i<s&&(n.context=n[0]=this[i])&&t.call(n[0],i,n)!==!1;);return this}})}(t),function(e,t){"use strict";function n(e,t){var n,i=0,s=t.length;if("undefined"==typeof e)return-1;if(e.constructor===String){for(;i<s;i+=1)if(0===e.localeCompare(t[i]))return i}else for(;i<s;i+=1)if(n=t[i],n.constructor===String){if(0===n.localeCompare(e))return i}else if(n===e)return i;return-1}function i(e,n){return e===n||e!==t&&n!==t&&(null!==e&&null!==n&&(e.constructor===String?0===e.localeCompare(n):n.constructor===String&&0===n.localeCompare(e)))}function s(t,n){var i,s,r;if(null===t||t.length<1)return[];for(i=t.split(n),s=0,r=i.length;s<r;s+=1)i[s]=e.trim(i[s]);return i}function r(e){return e.outerWidth(!1)-e.width()}function o(n){var i="keyup-change-value";n.bind("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.bind("keyup",function(){var s=e.data(n,i);s!==t&&n.val()!==s&&(e.removeData(n,i),n.trigger("keyup-change"))})}function a(n){n.bind("mousemove",function(n){var i=D;i!==t&&i.x===n.pageX&&i.y===n.pageY||e(n.target).trigger("mousemove-filtered",n)})}function l(e,n,i){i=i||t;var s;return function(){var t=arguments;window.clearTimeout(s),s=window.setTimeout(function(){n.apply(i,t)},e)}}function c(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}}function u(e,t){var i=l(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){n(e.target,t.get())>=0&&i(e)})}function d(e){e.preventDefault(),e.stopPropagation()}function h(e){e.preventDefault(),e.stopImmediatePropagation()}function f(t){if(!E){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);E=e("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),e("body").append(E)}return E.text(t.val()),E.width()}function p(e,t,n){var i=e.toUpperCase().indexOf(t.toUpperCase()),s=t.length;return i<0?void n.push(e):(n.push(e.substring(0,i)),n.push("<span class='select2-match'>"),n.push(e.substring(i,i+s)),n.push("</span>"),void n.push(e.substring(i+s,e.length)))}function m(t){var n,i=0,s=null,r=t.quietMillis||100;return function(o){window.clearTimeout(n),n=window.setTimeout(function(){i+=1;var n=i,r=t.data,a=t.transport||e.ajax,l=t.traditional||!1,c=t.type||"GET";r=r.call(this,o.term,o.page,o.context),null!==s&&s.abort(),s=a.call(null,{url:t.url,dataType:t.dataType,data:r,type:c,traditional:l,success:function(e){if(!(n<i)){var s=t.results(e,o.page);o.callback(s)}}})},r)}}function g(t){var n,i=t,s=function(e){return""+e.text};return e.isArray(i)||(s=i.text,e.isFunction(s)||(n=i.text,
s=function(e){return e[n]}),i=i.results),function(t){var n,r=t.term,o={results:[]};return""===r?void t.callback({results:i}):(n=function(i,o){var a,l;if(i=i[0],i.children){a={};for(l in i)i.hasOwnProperty(l)&&(a[l]=i[l]);a.children=[],e(i.children).each2(function(e,t){n(t,a.children)}),(a.children.length||t.matcher(r,s(a)))&&o.push(a)}else t.matcher(r,s(i))&&o.push(i)},e(i).each2(function(e,t){n(t,o.results)}),void t.callback(o))}}function v(n){return e.isFunction(n)?n:function(i){var s=i.term,r={results:[]};e(n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===s||i.matcher(s,n))&&r.results.push(e?this:{id:this,text:this})}),i.callback(r)}}function b(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function y(t){return e.isFunction(t)?t():t}function w(t){var n=0;return e.each(t,function(e,t){t.children?n+=w(t.children):n++}),n}function k(e,n,s,r){var o,a,l,c,u,d=e,h=!1;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return t;for(;;){for(a=-1,l=0,c=r.tokenSeparators.length;l<c&&(u=r.tokenSeparators[l],a=e.indexOf(u),!(a>=0));l++);if(a<0)break;if(o=e.substring(0,a),e=e.substring(a+u.length),o.length>0&&(o=r.createSearchChoice(o,n),o!==t&&null!==o&&r.id(o)!==t&&null!==r.id(o))){for(h=!1,l=0,c=n.length;l<c;l++)if(i(r.id(o),r.id(n[l]))){h=!0;break}h||s(o)}}return 0!=d.localeCompare(e)?e:void 0}function _(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var x,C,F,S,T,E,D,M;x={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case x.LEFT:case x.RIGHT:case x.UP:case x.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case x.SHIFT:case x.CTRL:case x.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},M=e(document),T=function(){var e=1;return function(){return e++}}(),M.bind("mousemove",function(e){D={x:e.pageX,y:e.pageY}}),M.ready(function(){M.bind("mousedown touchend",function(n){var i,s=e(n.target).closest("div.select2-container").get(0);s?M.find("div.select2-container-active").each(function(){this!==s&&e(this).data("select2").blur()}):(s=e(n.target).closest("div.select2-drop").get(0),M.find("div.select2-drop-active").each(function(){this!==s&&e(this).data("select2").blur()})),s=e(n.target),i=s.attr("for"),"LABEL"===n.target.tagName&&i&&i.length>0&&(i=i.replace(/([\[\].])/g,"\\$1"),s=e("#"+i),s=s.data("select2"),s!==t&&(s.focus(),n.preventDefault()))})}),C=_(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var i,s,r=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+T()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=c(function(){return n.element.closest("body")}),n.element.attr("class")!==t&&this.container.addClass(n.element.attr("class").replace(/validate\[[\S ]+] ?/,"")),this.container.css(y(n.containerCss)),this.container.addClass(y(n.containerCssClass)),this.opts.element.data("select2",this).hide().before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(y(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=i=this.container.find(r),this.search=s=this.container.find("input.select2-input"),s.attr("tabIndex",this.opts.element.attr("tabIndex")),this.resultsPage=0,this.context=null,this.initContainer(),this.initContainerWidth(),a(this.results),this.dropdown.delegate(r,"mousemove-filtered",this.bind(this.highlightUnderEvent)),u(80,this.results),this.dropdown.delegate(r,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&i.mousewheel(function(e,t,n,s){var r=i.scrollTop();s>0&&r-s<=0?(i.scrollTop(0),d(e)):s<0&&i.get(0).scrollHeight-i.scrollTop()+s<=i.height()&&(i.scrollTop(i.get(0).scrollHeight-i.height()),d(e))}),o(s),s.bind("keyup-change",this.bind(this.updateResults)),s.bind("focus",function(){s.addClass("select2-focused")," "===s.val()&&s.val("")}),s.bind("blur",function(){s.removeClass("select2-focused")}),this.dropdown.delegate(r,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0?(this.highlightUnderEvent(t),this.selectHighlighted(t)):this.focusSearch(),d(t)})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(n.element.is(":disabled")||n.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(n){var r,o,a,l;if(r=n.element,"select"===r.get(0).tagName.toLowerCase()&&(this.select=o=n.element),o&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(i,s,r){var o,a=this.opts.id,l=this;(o=function(i,s,c){var u,d,h,f,p,m,g,v,b;for(u=0,d=i.length;u<d;u+=1)h=i[u],f=a(h)!==t,p=h.children&&h.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+c),m.addClass("select2-result"),m.addClass(f?"select2-result-selectable":"select2-result-unselectable"),p&&m.addClass("select2-result-with-children"),m.addClass(l.opts.formatResultCssClass(h)),g=e("<div></div>"),g.addClass("select2-result-label"),b=n.formatResult(h,g,r),b!==t&&g.html(l.opts.escapeMarkup(b)),m.append(g),p&&(v=e("<ul></ul>"),v.addClass("select2-result-sub"),o(h.children,v,c+1),m.append(v)),m.data("select2-data",h),s.append(m)})(s,i,0)}},e.fn.select2.defaults,n),"function"!=typeof n.id&&(a=n.id,n.id=function(e){return e[a]}),o?(n.query=this.bind(function(n){var i,s,o,a={results:[],more:!1},l=n.term;o=function(e,t){var i;e.is("option")?n.matcher(l,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class")}):e.is("optgroup")&&(i={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){o(t,i.children)}),i.children.length>0&&t.push(i))},i=r.children(),this.getPlaceholder()!==t&&i.length>0&&(s=i[0],""===e(s).text()&&(i=i.not(s))),i.each2(function(e,t){o(t,a.results)}),n.callback(a)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(l=n.element.data("ajax-url"),l&&l.length>0&&(n.ajax.url=l),n.query=m(n.ajax)):"data"in n?n.query=g(n.data):"tags"in n&&(n.query=v(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection=function(t,r){var o=[];e(s(t.val(),n.separator)).each(function(){var t=this,s=this,r=n.tags;e.isFunction(r)&&(r=r()),e(r).each(function(){if(i(this.id,t))return s=this.text,!1}),o.push({id:t,text:s})}),r(o)})),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"),this.opts.element.removeAttr("disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"),this.opts.element.attr("disabled","disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,s=this.container.offset(),r=this.container.outerHeight(!1),o=this.container.outerWidth(!1),a=this.dropdown.outerHeight(!1),l=e(window).scrollLeft()+document.documentElement.clientWidth,c=e(window).scrollTop()+document.documentElement.clientHeight,u=s.top+r,d=s.left,h=u+a<=c,f=s.top-a>=this.body().scrollTop(),p=this.dropdown.outerWidth(!1),m=d+p<=l,g=this.dropdown.hasClass("select2-drop-above");"static"!==this.body().css("position")&&(t=this.body().offset(),u-=t.top,d-=t.left),g?(n=!0,!f&&h&&(n=!1)):(n=!1,!h&&f&&(n=!0)),m||(d=s.left+o-p),n?(u=s.top-a,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),i=e.extend({top:u,left:d,width:o},y(this.opts.dropdownCss)),this.dropdown.css(i)},shouldOpen:function(){var t;return!this.opened()&&(t=e.Event("open"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(window.setTimeout(this.bind(this.opening),1),!0)},opening:function(){var t=this.containerId,n=this.containerSelector,i="scroll."+t,s="resize."+t;this.container.parents().each(function(){e(this).bind(i,function(){var t=e(n);0==t.length&&e(this).unbind(i),t.select2("close")})}),window.setTimeout(function(){e(window).bind(s,function(){var t=e(n);0==t.length&&e(window).unbind(s),t.select2("close")})},10),this.clearDropdownAlignmentPreference()," "===this.search.val()&&this.search.val(""),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.updateResults(!0),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible(),this.focusSearch()},close:function(){if(this.opened()){var t=this;this.container.parents().each(function(){e(this).unbind("scroll."+t.containerId)}),e(window).unbind("resize."+this.containerId),this.clearDropdownAlignmentPreference(),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(e.Event("close"))}},clearSearch:function(){},ensureHighlightVisible:function(){var t,n,i,s,r,o,a,l=this.results;if(n=this.highlight(),!(n<0)){if(0==n)return void l.scrollTop(0);t=l.find(".select2-result-selectable"),i=e(t[n]),s=i.offset().top+i.outerHeight(!0),n===t.length-1&&(a=l.find("li.select2-more-results"),a.length>0&&(s=a.offset().top+a.outerHeight(!0))),r=l.offset().top+l.outerHeight(!0),s>r&&l.scrollTop(l.scrollTop()+(s-r)),o=i.offset().top-l.offset().top,o<0&&"none"!=i.css("display")&&l.scrollTop(l.scrollTop()+o)}},moveHighlight:function(t){for(var n=this.results.find(".select2-result-selectable"),i=this.highlight();i>-1&&i<n.length;){i+=t;var s=e(n[i]);if(s.hasClass("select2-result-selectable")&&!s.hasClass("select2-disabled")){this.highlight(i);break}}},highlight:function(t){var i=this.results.find(".select2-result-selectable").not(".select2-disabled");return 0===arguments.length?n(i.filter(".select2-highlighted")[0],i.get()):(t>=i.length&&(t=i.length-1),t<0&&(t=0),i.removeClass("select2-highlighted"),e(i[t]).addClass("select2-highlighted"),void this.ensureHighlightVisible())},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.results.find(".select2-result-selectable");this.highlight(i.index(n))}else 0==n.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,s=this,r=this.search.val(),o=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),e<=0&&(n.addClass("select2-active"),this.opts.query({term:r,page:i,context:o,matcher:this.opts.matcher,callback:this.bind(function(e){s.opened()&&(s.opts.populateResults.call(this,t,e.results,{term:r,page:i,context:o}),e.more===!0?(n.detach().appendTo(t).text(s.opts.formatLoadMore(i+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):n.remove(),s.positionDropdown(),s.resultsPage=i)})})))},tokenize:function(){},updateResults:function(n){function s(){c.scrollTop(0),l.removeClass("select2-active"),d.positionDropdown()}function r(e){c.html(d.opts.escapeMarkup(e)),s()}var o,a,l=this.search,c=this.results,u=this.opts,d=this;if(n===!0||this.showSearchInput!==!1&&this.opened()){if(l.addClass("select2-active"),u.maximumSelectionSize>=1&&(o=this.data(),e.isArray(o)&&o.length>=u.maximumSelectionSize&&b(u.formatSelectionTooBig,"formatSelectionTooBig")))return void r("<li class='select2-selection-limit'>"+u.formatSelectionTooBig(u.maximumSelectionSize)+"</li>");if(l.val().length<u.minimumInputLength)return void r(b(u.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+u.formatInputTooShort(l.val(),u.minimumInputLength)+"</li>":"");u.formatSearching()&&r("<li class='select2-searching'>"+u.formatSearching()+"</li>"),a=this.tokenize(),a!=t&&null!=a&&l.val(a),this.resultsPage=1,u.query({term:l.val(),page:this.resultsPage,context:null,matcher:u.matcher,callback:this.bind(function(o){var a;if(this.opened()){if(this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&""!==l.val()&&(a=this.opts.createSearchChoice.call(null,l.val(),o.results),a!==t&&null!==a&&d.id(a)!==t&&null!==d.id(a)&&0===e(o.results).filter(function(){return i(d.id(this),d.id(a))}).length&&o.results.unshift(a)),0===o.results.length&&b(u.formatNoMatches,"formatNoMatches"))return void r("<li class='select2-no-results'>"+u.formatNoMatches(l.val())+"</li>");c.empty(),d.opts.populateResults.call(this,c,o.results,{term:l.val(),page:this.resultsPage,context:null}),o.more===!0&&b(u.formatLoadMore,"formatLoadMore")&&(c.append("<li class='select2-more-results'>"+d.opts.escapeMarkup(u.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),s()}})})}},cancel:function(){this.close()},blur:function(){this.close(),this.container.removeClass("select2-container-active"),this.dropdown.removeClass("select2-drop-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.opts.element.triggerHandler("blur")},focusSearch:function(){this.search.show(),this.search.focus(),window.setTimeout(this.bind(function(){this.search.show(),this.search.focus(),this.search.val(this.search.val())}),10)},selectHighlighted:function(){var e=this.highlight(),t=this.results.find(".select2-highlighted").not(".select2-disabled"),n=t.closest(".select2-result-selectable").data("select2-data");n&&(t.addClass("select2-disabled"),this.highlight(e),this.onSelect(n))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function n(){var n,i,s,r,o;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(n=this.opts.element.attr("style"),n!==t)for(i=n.split(";"),r=0,o=i.length;r<o;r+=1)if(s=i[r].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==s&&s.length>=1)return s[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var i=n.call(this);null!==i&&this.container.attr("style","width: "+i)}}),F=_(C,{createContainer:function(){var t=e("<div></div>",{"class":"select2-container"}).html(["    <a href='javascript:void(0)' onclick='return false;' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},opening:function(){this.search.show(),this.parent.opening.apply(this,arguments),this.dropdown.removeClass("select2-offscreen")},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show())},focus:function(){this.close(),this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments),this.selection.focus()},initContainer:function(){var e,t=this.container,n=this.dropdown,i=!1;this.selection=e=t.find(".select2-choice"),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===x.PAGE_UP||e.which===x.PAGE_DOWN)return void d(e);if(this.opened())switch(e.which){case x.UP:case x.DOWN:return this.moveHighlight(e.which===x.UP?-1:1),void d(e);case x.TAB:case x.ENTER:return this.selectHighlighted(),void d(e);case x.ESC:return this.cancel(e),void d(e)}else{if(e.which===x.TAB||x.isControl(e)||x.isFunctionKey(e)||e.which===x.ESC)return;if(this.opts.openOnEnter===!1&&e.which===x.ENTER)return;if(this.open(),e.which===x.ENTER)return}}})),this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")})),this.search.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active"),window.setTimeout(this.bind(function(){var e=this.opts.element.attr("tabIndex");e?this.selection.attr("tabIndex",e):this.selection.removeAttr("tabIndex")}),10)})),e.delegate("abbr","mousedown",this.bind(function(e){this.enabled&&(this.clear(),h(e),this.close(),this.triggerChange(),this.selection.focus())})),e.bind("mousedown",this.bind(function(e){i=!0,this.opened()?(this.close(),this.selection.focus()):this.enabled&&this.open(),i=!1})),n.bind("mousedown",this.bind(function(){this.search.focus()})),e.bind("focus",this.bind(function(){this.container.addClass("select2-container-active"),this.search.attr("tabIndex","-1")})),e.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active"),window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)})),e.bind("keydown",this.bind(function(e){if(this.enabled)return e.which==x.DOWN||e.which==x.UP||e.which==x.ENTER&&this.opts.openOnEnter?(this.open(),void d(e)):e.which==x.DELETE||e.which==x.BACKSPACE?(this.opts.allowClear&&this.clear(),void d(e)):void 0})),e.bind("keypress",this.bind(function(e){var t=String.fromCharCode(e.which);this.search.val(t),this.open()})),this.setPlaceholder(),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder()},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text())this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return"select"===t.element.get(0).tagName.toLowerCase()&&(t.initSelection=function(t,n){var i=t.find(":selected");e.isFunction(n)&&n({id:i.attr("value"),text:i.text(),element:i})}),t},setPlaceholder:function(){var e=this.getPlaceholder();if(""===this.opts.element.val()&&e!==t){if(this.select&&""!==this.select.find("option:first").text())return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(t,n){var s=0,r=this,o=!0;this.results.find(".select2-result-selectable").each2(function(e,t){if(i(r.id(t.data("select2-data")),r.opts.element.val()))return s=e,!1}),this.highlight(s),n===!0&&(o=this.showSearchInput=w(t.results)>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[o?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[o?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(e){var t=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.close(),this.selection.focus(),i(t,this.id(e))||this.triggerChange()},updateSelection:function(e){var n,i=this.selection.find("span");this.selection.data("select2-data",e),i.empty(),n=this.opts.formatSelection(e,i),n!==t&&i.append(this.opts.escapeMarkup(n)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,n=null,i=this;if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],this.select)this.select.val(e).find(":selected").each2(function(e,t){return n={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(n),this.setPlaceholder(),this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e)return this.clear(),void this.triggerChange();this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),i.triggerChange()})}},clearSearch:function(){this.search.val("")},data:function(e){var n;return 0===arguments.length?(n=this.selection.data("select2-data"),n==t&&(n=null),n):void(e&&""!==e?(this.opts.element.val(e?this.id(e):""),this.updateSelection(e)):this.clear())}}),S=_(C,{createContainer:function(){var t=e("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return"select"===t.element.get(0).tagName.toLowerCase()&&(t.initSelection=function(t,n){var i=[];t.find(":selected").each2(function(e,t){i.push({id:t.attr("value"),text:t.text(),element:t})}),e.isFunction(n)&&n(i)}),t},initContainer:function(){var t,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===x.BACKSPACE&&""===this.search.val()){this.close();var n,i=t.find(".select2-search-choice-focus");if(i.length>0)return this.unselect(i.first()),this.search.width(10),void d(e);n=t.find(".select2-search-choice:not(.select2-locked)"),n.length>0&&n.last().addClass("select2-search-choice-focus")}else t.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case x.UP:case x.DOWN:return this.moveHighlight(e.which===x.UP?-1:1),void d(e);case x.ENTER:case x.TAB:return this.selectHighlighted(),void d(e);case x.ESC:return this.cancel(e),void d(e)}e.which===x.TAB||x.isControl(e)||x.isFunctionKey(e)||e.which===x.BACKSPACE||e.which===x.ESC||this.opts.openOnEnter===!1&&e.which===x.ENTER||(this.open(),e.which!==x.PAGE_UP&&e.which!==x.PAGE_DOWN||d(e))}})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(n,"mousedown",this.bind(function(t){this.enabled&&(e(t.target).closest(".select2-search-choice").length>0||(this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.delegate(n,"focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled"))},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0))},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):" "===this.search.val()&&this.search.val("")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch()},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var i=[],s=[],r=this;e(t).each(function(){n(r.id(this),i)<0&&(i.push(r.id(this)),s.push(this))}),t=s,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){r.addSelectedChoice(this)}),r.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e){this.addSelectedChoice(e),!this.select&&this.opts.closeOnSelect||this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.positionDropdown()):this.close(),this.triggerChange({added:e}),this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var i,s=!n.locked,r=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),o=e("<li class='select2-search-choice select2-locked'><div></div></li>"),a=s?r:o,l=this.id(n),c=this.getVal();i=this.opts.formatSelection(n,a.find("div")),i!=t&&a.find("div").replaceWith("<div>"+this.opts.escapeMarkup(i)+"</div>"),s&&a.find(".select2-search-choice-close").bind("mousedown",d).bind("click dblclick",this.bind(function(t){this.enabled&&(e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),d(t))})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),a.data("select2-data",n),a.insertBefore(this.searchContainer),c.push(l),this.setVal(c)},unselect:function(e){var t,i,s=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";t=e.data("select2-data"),i=n(this.id(t),s),i>=0&&(s.splice(i,1),this.setVal(s),this.select&&this.postprocessResults()),e.remove(),this.triggerChange({removed:t})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result-selectable"),i=this.results.find(".select2-result-with-children"),s=this;t.each2(function(t,i){var r=s.id(i.data("select2-data"));n(r,e)>=0?i.addClass("select2-disabled").removeClass("select2-result-selectable"):i.removeClass("select2-disabled").addClass("select2-result-selectable")}),i.each2(function(e,t){t.is(".select2-result-selectable")||0!=t.find(".select2-result-selectable").length?t.removeClass("select2-disabled"):t.addClass("select2-disabled")}),this.highlight()==-1&&t.each2(function(e,t){if(!t.hasClass("select2-disabled")&&t.hasClass("select2-result-selectable"))return s.highlight(0),!1})},resizeSearch:function(){var e,t,n,i,s,o=r(this.search);e=f(this.search)+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,s=n-(t-i)-o,s<e&&(s=n-o),s<40&&(s=n-o),this.search.width(s)},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),s(e,this.opts.separator))},setVal:function(t){var i;this.select?this.select.val(t):(i=[],e(t).each(function(){n(this,i)<0&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))},val:function(){var n,i=[],s=this;if(0===arguments.length)return this.getVal();if(n=arguments[0],!n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void this.triggerChange();if(this.setVal(n),this.select)this.select.find(":selected").each(function(){i.push({id:e(this).attr("value"),text:e(this).text()})}),this.updateSelection(i),this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e(t).map(s.id);s.setVal(n),s.updateSelection(t),s.clearSearch(),s.triggerChange()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var n,i=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(t||(t=[]),n=e.map(t,function(e){return i.opts.id(e)}),this.setVal(n),this.updateSelection(t),this.clearSearch(),void 0)}}),e.fn.select2=function(){var i,s,r,o,a=Array.prototype.slice.call(arguments,0),l=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(0===a.length||"object"==typeof a[0])i=0===a.length?{}:e.extend({},a[0]),i.element=e(this),"select"===i.element.get(0).tagName.toLowerCase()?o=i.element.attr("multiple"):(o=i.multiple||!1,"tags"in i&&(i.multiple=o=!0)),s=o?new S:new F,s.init(i);else{if("string"!=typeof a[0])throw"Invalid arguments to select2 plugin: "+a;if(n(a[0],l)<0)throw"Unknown method: "+a[0];if(r=t,s=e(this).data("select2"),s===t)return;if(r="container"===a[0]?s.container:s[a[0]].apply(s,a.slice(1)),r!==t)return!1}}),r===t?this:r;
},e.fn.select2.defaults={width:"copy",closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n){var i=[];return p(e.text,n.term,i),i.join("")},formatSelection:function(e,n){return e?e.text:t},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:k,escapeMarkup:function(e){return e&&"string"==typeof e?e.replace(/&/g,"&amp;"):e},blurOnChange:!1},window.Select2={query:{ajax:m,local:g,tags:v},util:{debounce:l,markMatch:p},"class":{"abstract":C,single:F,multi:S}}}}(t)}),function(e){"use strict";e("vendor/jquery/scrollto",["jquery"],function(e){function t(t){return e.isFunction(t)||e.isPlainObject(t)?t:{top:t,left:t}}var n=e.scrollTo=function(t,n,i){return e(window).scrollTo(t,n,i)};return n.defaults={axis:"xy",duration:0,limit:!0},n.window=function(){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!==-1;if(!n)return t;var i=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||"BackCompat"===i.compatMode?i.body:i.documentElement})},e.fn.scrollTo=function(i,s,r){return"object"==typeof s&&(r=s,s=0),"function"==typeof r&&(r={onAfter:r}),"max"===i&&(i=9e9),r=e.extend({},n.defaults,r),s=s||r.duration,r.queue=r.queue&&r.axis.length>1,r.queue&&(s/=2),r.offset=t(r.offset),r.over=t(r.over),this._scrollable().each(function(){function o(e){c.animate(d,s,r.easing,e&&function(){e.call(this,u,r)})}if(null!==i){var a,l=this,c=e(l),u=i,d={},h=c.is("html,body");switch(typeof u){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(u)){u=t(u);break}if(u=h?e(u):e(u,this),!u.length)return;case"object":(u.is||u.style)&&(a=(u=e(u)).offset())}var f=e.isFunction(r.offset)&&r.offset(l,u)||r.offset;e.each(r.axis.split(""),function(e,t){var i="x"===t?"Left":"Top",s=i.toLowerCase(),p="scroll"+i,m=l[p],g=n.max(l,t);if(a)d[p]=a[s]+(h?0:m-c.offset()[s]),r.margin&&(d[p]-=parseInt(u.css("margin"+i),10)||0,d[p]-=parseInt(u.css("border"+i+"Width"),10)||0),d[p]+=f[s]||0,r.over[s]&&(d[p]+=u["x"===t?"width":"height"]()*r.over[s]);else{var v=u[s];d[p]=v.slice&&"%"===v.slice(-1)?parseFloat(v)/100*g:v}r.limit&&/^\d+$/.test(d[p])&&(d[p]=d[p]<=0?0:Math.min(d[p],g)),!e&&r.queue&&(m!==d[p]&&o(r.onAfterFirst),delete d[p])}),o(r.onAfter)}}).end()},n.max=function(t,n){var i="x"===n?"Width":"Height",s="scroll"+i;if(!e(t).is("html,body"))return t[s]-e(t)[i.toLowerCase()]();var r="client"+i,o=t.ownerDocument.documentElement,a=t.ownerDocument.body;return Math.max(o[s],a[s])-Math.min(o[r],a[r])},n})}("function"==typeof define&&define.amd?define:function(e,t){"use strict";"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}),define("shared/plugins/text_width",["require","exports","module"],function(e,t,n){$.fn.getTextWidth=function(){var e=this.val()+"M",t={"font-family":this.css("font-family"),"font-size":this.css("font-size"),"font-style":this.css("font-style"),letterspacing:this.css("letterspacing"),"font-weight":this.css("font-weight"),"white-space":"pre",padding:0,margin:0,position:"absolute"},n=$("<span>").html(e).css(t).appendTo("body"),i=parseInt(n.width(),10);return n.remove(),i}}),function(e,t,n){"use strict";var i,s;if(e.uaMatch=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/i.exec(e)||[];return{browser:t[3]||t[1]||"",version:t[2]||"0",platform:n[0]||""}},i=e.uaMatch(t.navigator.userAgent),s={},i.browser&&(s[i.browser]=!0,s.version=i.version,s.versionNumber=parseInt(i.version)),i.platform&&(s[i.platform]=!0),(s.android||s.ipad||s.iphone||s["windows phone"])&&(s.mobile=!0),(s.cros||s.mac||s.linux||s.win)&&(s.desktop=!0),(s.chrome||s.opr||s.safari)&&(s.webkit=!0),s.rv){var r="msie";i.browser=r,s[r]=!0}if(s.opr){var o="opera";i.browser=o,s[o]=!0}if(s.safari&&s.android){var a="android";i.browser=a,s[a]=!0}s.name=i.browser,s.platform=i.platform,e.browser=s}(jQuery,window),define("vendor/jquery/jquery.browser",function(){}),define("shared/plugins/auto_resize",["require","exports","module","jquery","vendor/jquery/jquery.browser"],function(e,t,n){var i=e("jquery");e("vendor/jquery/jquery.browser");!function(e,t){function n(t){var n=e(t),i=n.val(),s=n.val("").height(),r=t.scrollHeight,o=r>s?r-s:0;return n.data("minHeight",s),n.data("scrollOffset",o),n.css("overflow-y","hidden"),e.browser.msie&&n.css("overflow-y","hidden").scroll(function(){this.scrollTop=0}),n.val(i)}function i(){var n,i=e(this),s=i.height(),r=i.data("scrollOffset"),o=(i.data("minHeight"),t.scrollTop());i.height("0"),n=i.prop("scrollHeight")-r+(parseInt(i.css("padding-top"),10)+parseInt(i.css("padding-bottom"),10)),i.height(n),t.scrollTop(o),s!==n&&i.trigger("autoresize:resize",n)}function s(){n(this).bind(o,i),i.call(this)}var r="textarea",o="keyup change paste input";e.fn.autoResize=function(){return this.filter(r).each(s)}}(i,i(window))}),define("shared/plugins/auto_resize_text_input",["require","exports","module","jquery","shared/util"],function(e,t,n){function i(e){return c.html(r.val().replace(/</gm,"&lt;").replace(/>/gm,"&gt;")+"&nbsp;"),Math.min(Math.max(d.intval(c.width())+l,o),a)}function s(e){var t=i();r.css({width:t,overflow:t===a&&a!==-1?"auto":"hidden"})}var r,o,a,l,c,u=e("jquery"),d=e("shared/util"),h={init:function(e){r=u(this),o=d.intval(e.min),a=d.intval(e.max),l=d.intval(e.adjust);for(var t={position:"absolute",top:"-999999em",left:"-999999em"},n=["line-height","font-weight","font-size","font-size-adjust","font-family","font-stretch","font-variant","font-style","text-transform","letter-spacing","text-indent","word-spacing","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-style","border-right-style","border-bottom-style","border-left-style","padding-top","padding-right","padding-bottom","padding-left","height"],i=0,h=n.length;i<h;++i)t[n[i]]=r.css(n[i]);return c=u("<div>").css(t),r.after(c).on("keyup input change beforepaste blur focus",s).trigger("keyup"),this}};u.fn.autoResizeTextInput=function(e){return h[e]?h[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(u.error("Method "+e+" does not exist on jQuery.autoResizeTextInput"),this):h.init.apply(this,arguments)}}),define("shared/plugins/checkbox_range",["require","exports","module","jquery"],function(e,t,n){var i=e("jquery");i.fn.createCheckboxRange=function(e){var t=jQuery.extend(e&&e.constructor==Object?e:{bind:"shiftKey",click:e},e),n=0,s=this,r=i.isFunction(t.click);return r&&this.each(function(){t.click.apply(this,[i.event.fix({type:null}),i(this).is(":checked")])}),this.each(function(){if("checkbox"!=this.type)return!1;var e=function(e){n=s.index(e.target)},o=function(e){var i=this.checked,o=s.index(e.target),a=Math.min(n,o),l=Math.max(n+1,o);if(r&&t.click.apply(this,[e,i]),e[t.bind]){for(var c=a;c<l;c++){var u=s.eq(c).attr("checked",i).trigger("change");r&&t.click.apply(u[0],[e,i])}return!0}};return i(this).unbind("click.createCheckboxRange").bind("click.createCheckboxRange",o).bind("click.createCheckboxRange",e),!0})}}),function(e){"function"==typeof define&&define.amd?define("vendor/jquery/mentions_input",["jquery","underscore"],e):e(jQuery,_)}(function(e,t,n){var i={BACKSPACE:8,TAB:9,RETURN:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,COMMA:188,SPACE:32,HOME:36,END:35},s={triggerChar:"@",onDataRequest:e.noop,minChars:2,maxOptions:0,showAvatars:!0,elastic:!1,onCaret:!1,parseValue:function(e){return e.name},classes:{autoCompleteItemActive:"active"},templates:{wrapper:t.template('<div class="mentions-input-box"></div>'),autocompleteList:t.template('<div class="mentions-autocomplete-list"></div>'),autocompleteListItem:t.template('<li data-ref-id="<%= id %>" data-ref-type="<%= type %>" data-display="<%= display %>"><%= content %></li>'),autocompleteListItemAvatar:t.template('<img src="<%= avatar %>" />'),autocompleteListItemIcon:t.template('<div class="icon <%= icon %>"></div>'),mentionsOverlay:t.template('<div class="mentions"><div></div></div>'),mentionItemSyntax:t.template("@[<%= value %>](<%= type %>:<%= id %>)"),mentionItemHighlight:t.template("<strong><span><%= value %></span></strong>")}},r={htmlEncode:function(e){return t.escape(e)},highlightTerm:function(e,t){return t||t.length?e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>"):e},setCaratPosition:function(e,t){if(e.createTextRange){var n=e.createTextRange();n.move("character",t),n.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus()},getCaratPosition:function(e){if(e.selectionStart)return e.selectionStart;if(e.ownerDocument.selection){var t=e.ownerDocument.selection.createRange();if(!t)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(t.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}},rtrim:function(e){return e.replace(/\s+$/,"")}},o=function(n){function o(){D=e(E),"true"!=D.attr("data-mentions-input")&&(M=D.parent(),$=e(n.templates.wrapper()),D.wrapAll($),$=M.find("> div"),D.attr("data-mentions-input","true"),D.bind("keydown",k),D.bind("keypress",w),D.bind("input",y),D.bind("click",v),D.bind("blur",b),n.elastic&&D.elastic())}function a(){A=e(n.templates.autocompleteList()),A.appendTo($),A.delegate("li","mousedown",m),A.delegate("li","mouseenter",g)}function l(){P=e(n.templates.mentionsOverlay()),P.prependTo($)}function c(){var e=f();t.each(j,function(t){var i=n.templates.mentionItemSyntax(t);e=e.replace(t.value,i)});var i=r.htmlEncode(e);t.each(j,function(e){var s=t.extend({},e,{value:r.htmlEncode(e.value)}),o=n.templates.mentionItemSyntax(s),a=n.templates.mentionItemHighlight(s);i=i.replace(o,a)}),i=i.replace(/\n/g,"<br />"),i=i.replace(/ {2}/g,"&nbsp; "),D.data("messageText",e),P.find("div").html(i)}function u(){q=[]}function d(){var e=f();j=t.reject(j,function(t,n){return!t.value||e.indexOf(t.value)==-1}),j=t.compact(j)}function h(e){var t=f(),i=r.getCaratPosition(D[0]),s=t.substr(0,i).lastIndexOf(n.triggerChar),o=s+L.length,a=t.substr(0,s),l=t.substr(o+1,t.length),d=(a+e.value).length+1;j.push(e),u(),L="",_();var h=a+e.value+" "+l;D.val(h),c(),D.focus(),r.setCaratPosition(D[0],d)}function f(){return e.trim(D.val())}function p(t){var i,s,r,o,a,l,c,u,d,h,f;if((d=t[0])&&e(d).is("textarea")&&null!=d.selectionEnd){for(c={position:"absolute",overflow:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word",boxSizing:"content-box",top:0,left:-9999},u=["boxSizing","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","textDecoration","textIndent","textTransform","width","word-spacing"],h=0,f=u.length;h<f;h++)a=u[h],c[a]=e(d).css(a);return s=d.value.substring(0,d.selectionEnd),s=s.substring(0,s.lastIndexOf(n.triggerChar)),r=document.createElement("div"),e(r).css(c),e(d).after(r),s=document.createTextNode(s),i=document.createTextNode(d.value.substring(d.selectionEnd)),o=document.createElement("span"),o.innerHTML="&nbsp;",r.appendChild(s),r.appendChild(o),r.appendChild(i),r.scrollTop=d.scrollTop,l=e(o).position(),e(r).remove(),l}}function m(t){var n=e(this),i=O[n.attr("data-uid")];return h(i),!1}function g(t){x(e(this))}function v(e){u()}function b(e){_()}function y(e){c(),d();var i=t.lastIndexOf(q,n.triggerChar);i>-1&&(L=q.slice(i+1).join(""),L=r.rtrim(L),t.defer(t.bind(S,this,L)))}function w(e){if(e.keyCode!==i.BACKSPACE){var t=String.fromCharCode(e.which||e.keyCode);q.push(t)}}function k(n){if(n.keyCode==i.LEFT||n.keyCode==i.RIGHT||n.keyCode==i.HOME||n.keyCode==i.END)return t.defer(u),void(navigator.userAgent.indexOf("MSIE 9")>-1&&t.defer(c));if(n.keyCode==i.BACKSPACE)return void(q=q.slice(0,-1+q.length));if(!A.is(":visible"))return!0;switch(n.keyCode){case i.UP:case i.DOWN:var s=null;return s=n.keyCode==i.DOWN?I&&I.length?I.next():A.find("li").first():e(I).prev(),s.length&&x(s),!1;case i.RETURN:case i.TAB:if(I&&I.length)return I.trigger("mousedown"),!1}return!0}function _(){I=null,A.empty().hide()}function x(e){I&&I[0]===e[0]||(e.addClass(n.classes.autoCompleteItemActive),e.siblings().removeClass(n.classes.autoCompleteItemActive),I=e)}function C(i,s){var o=t.pluck(j,"value");if(s=t.reject(s,function(e){return t.include(o,e.name)}),!s.length)return void _();A.empty();var a,l,c,u,d,h=e("<ul>").appendTo(A).hide(),f=n.maxOptions?Math.min(n.maxOptions,s.length):s.length;for(a=0;a<f;a++)c=s[a],l=t.uniqueId("mention_"),O[l]=t.extend({},c,{value:n.parseValue(c)}),u=e(n.templates.autocompleteListItem({id:r.htmlEncode(c.id),display:r.htmlEncode(c.name),type:r.htmlEncode(c.type),content:r.highlightTerm(c.display?c.display:c.name,i)})).attr("data-uid",l),0===a&&x(u),n.showAvatars&&(d=e(c.avatar?n.templates.autocompleteListItemAvatar({avatar:c.avatar}):n.templates.autocompleteListItemIcon({icon:c.icon})),d.prependTo(u)),u.appendTo(h);A.show(),n.onCaret&&F(A,D),h.show()}function F(e,t){var n=p(t),i=parseInt(t.css("line-height"),10)||18;e.css("left",n.left),e.css("top",i+n.top)}function S(e){e&&e.length&&e.length>=n.minChars?n.onDataRequest.call(this,"search",e,function(t){C(e,t)}):_()}function T(t){if(t){j=[];for(var i,s=t,r=(e.isArray(n.triggerChar)?n.triggerChar.join("|"):n.triggerChar,new RegExp("\\[("+n.triggerChar+")(.*?)\\]\\((.*?):(.*?)\\)","gi")),o=s;null!=(i=r.exec(s));)o=o.replace(i[0],i[1]+i[2]),j.push({id:i[4],type:i[3],value:i[1]+i[2],trigger:i[1]});D.val(o),c()}else D.val(""),j=[],c()}var E,D,M,A,$,P,I,L,j=[],O={},q=[];return n=e.extend(!0,{},s,n),{init:function(e){E=e,o(),a(),l(),T(f()),n.prefillMention&&h(n.prefillMention)},val:function(e){if(t.isFunction(e)){var n=j.length?D.data("messageText"):f();e.call(this,n)}},reset:function(e){T(e)},getMentions:function(e){t.isFunction(e)&&e.call(this,j)}}};e.fn.mentionsInput=function(n,i){var s=arguments;return"object"!=typeof n&&n||(i=n),this.each(function(){var r=e.data(this,"mentionsInput")||e.data(this,"mentionsInput",new o(i));return t.isFunction(r[n])?r[n].apply(this,Array.prototype.slice.call(s,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist"):r.init.call(this,this)})}}),define("shared/plugins/mentions",["require","jquery","underscore","vendor/jquery/mentions_input"],function(e){var t=e("jquery"),n=e("underscore"),i=(e("vendor/jquery/mentions_input"),{}),s=[],r={},o=function(e){return e.username===e.name?e.name:e.name+" <span>("+e.username+")</span>"};return i.fetchFollowing=function(){var e=[],n=!1,i=!1,s=[];return function(r){return i?r(e):(s.push(r),void(n||(n=!0,t.getJSON("/ajax/following",function(t){for(var n=0;n<t.length;n++)e.push({id:t[n].ID,name:t[n].name,username:t[n].username,avatar:t[n].avatar,type:"user"});for(i=!0;s.length;)s.pop()(e)}))))}}(),i.init=function(e){i.fetchFollowing(i.add),e.each(function(){var e=t(this),i=e.mentionsInput({onDataRequest:function(e,t,i){t=t.toLowerCase();var r=n.filter(s,function(e){return e.name.toLowerCase().indexOf(t)>-1||e.username.toLowerCase().indexOf(t)>-1});i.call(this,r)},parseValue:function(e){return"@"+e.name},onCaret:!0,templates:{wrapper:n.template('<div class="mentions-input-box"></div>'),autocompleteList:n.template('<div class="mentions-autocomplete-list"></div>'),autocompleteListItem:n.template('<li data-ref-id="<%= id %>" data-ref-type="<%= type %>" data-display="<%= display %>"><%= content %></li>'),autocompleteListItemAvatar:n.template('<img src="<%= avatar %>" />'),autocompleteListItemIcon:n.template('<div class="icon <%= icon %>"></div>'),mentionsOverlay:n.template('<div class="mentions"><div id="textarea-value"></div></div>'),mentionItemSyntax:n.template("[<%= value %>](<%= type %>:<%= id %>)"),mentionItemHighlight:n.template("<strong><span><%= value %></span></strong>")}});e.data("mentions",i)})},i.add=function(e){var t,n;for(t=0;t<e.length;t++)n=e[t].id,r.hasOwnProperty(n)||(r[n]=!0,e[t].type="user",e[t].display=o(e[t]),s.push(e[t]))},i}),define("adamantium/validation/validators",["require","exports","module"],function(e,t,n){return function(e){var t={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},n={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},i={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace("_"," ")},label:function(e,t){return t.labels[e]||i.sentenceCase(e,t)}},s=function(e){return String(e).replace(/^\s+|\s+$/,"")},r=function(t,n){return i[e](t,n)},o=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})},a=function(e){return _.isNumber(e)||_.isString(e)&&e.match(t.number)},l=function(e){return!(_.isNull(e)||_.isUndefined(e)||_.isString(e)&&""===s(e))};return{fn:function(e,t,n,i,s){return _.isString(n)&&(n=i[n]),n.call(i,e,t,s)},required:function(e,t,i,s,a){var c=_.isFunction(i)?i.call(s,e,t,a):i;return!(!c&&!l(e))&&(c&&!l(e)?o(n.required,r(t,s)):void 0)},acceptance:function(e,t,i,s){if("true"!==e&&(!_.isBoolean(e)||e===!1))return o(n.acceptance,r(t,s))},min:function(e,t,i,s){if(!a(e)||e<i)return o(n.min,r(t,s),i)},max:function(e,t,i,s){if(!a(e)||e>i)return o(n.max,r(t,s),i)},range:function(e,t,i,s){if(!a(e)||e<i[0]||e>i[1])return o(n.range,r(t,s),i[0],i[1])},length:function(e,t,i,a){if(!l(e)||s(e).length!==i)return o(n.length,r(t,a),i)},minLength:function(e,t,i,a){if(!l(e)||s(e).length<i)return o(n.minLength,r(t,a),i)},maxLength:function(e,t,i,a){if(!l(e)||s(e).length>i)return o(n.maxLength,r(t,a),i)},rangeLength:function(e,t,i,a){if(!l(e)||s(e).length<i[0]||s(e).length>i[1])return o(n.rangeLength,r(t,a),i[0],i[1])},oneOf:function(e,t,i,s){if(!_.include(i,e))return o(n.oneOf,r(t,s),i.join(", "))},equalTo:function(e,t,i,s,a){if(e!==a[i])return o(n.equalTo,r(t,s),r(i,s))},pattern:function(e,i,s,a){if(!l(e)||!e.toString().match(t[s]||s))return o(n.pattern,r(i,a),s)}}}}),define("adamantium/validation/validation",["require","exports","module","underscore","adamantium/validation/validators"],function(e,t,n){var i=e("underscore"),s=e("adamantium/validation/validators"),r={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase"},o=i.extend({},r),a=function(){return s(o.labelFormatter)},l=function(e,t){return e&&e[t]?i.isFunction(e[t])?e[t]():e[t]:null},c=function(e){return i.reduce(i.keys(l(e,"validation")||{}),function(e,t){return e[t]=void 0,e},{})},u=function(e,t){var n=l(e,"validation")?l(e,"validation")[t]||{}:{};return(i.isFunction(n)||i.isString(n))&&(n={fn:n}),i.isArray(n)||(n=[n]),i.reduce(n,function(e,t){return i.each(i.without(i.keys(t),"msg"),function(n){e.push({fn:a()[n],val:t[n],msg:t.msg})}),e},[])},d=function(e,t,n,s){return i.reduce(u(e,t),function(i,r){var o=r.fn.call(a(),n,t,r.val,e,s);return o!==!1&&i!==!1&&(o&&!i?r.msg||o:i)},"")},h=function(e,t){var n,s,r={},o=!0,a=i.clone(t);for(s in t)n=d(e,s,t[s],a),n&&(r[s]=n,o=!1);return{invalidAttrs:r,isValid:o}};return{preValidate:function(e,t){return d(this,e,t,i.extend({},this.attributes))},isValid:function(e){if(i.isString(e))return!d(this,e,this.get(e),i.extend({},this.attributes));if(i.isArray(e)){for(var t=0;t<e.length;t++)if(d(this,e[t],this.get(e[t]),i.extend({},this.attributes)))return!1;return!0}return e===!0&&this.validate(),!this.validation||this._isValid},validate:function(e,t){o=i.extend({},r,this.validationOptions,t);var n=this,s=!e,a=i.extend(c(n),n.attributes,e),l=e||a,u=h(n,a);n._isValid=u.isValid;for(var d in a){var f=u.invalidAttrs.hasOwnProperty(d),p=l.hasOwnProperty(d);f&&(p||s)&&n.trigger("invalid",d,u.invalidAttrs[d],o.selector),f||n.trigger("valid",d,o.selector)}if(i.defer(function(){n.trigger("validated",n._isValid,n,u.invalidAttrs),n.trigger("validated:"+(n._isValid?"valid":"invalid"),n,u.invalidAttrs)}),!o.forceUpdate&&i.intersection(i.keys(u.invalidAttrs),i.keys(l)).length>0)return u.invalidAttrs}}}),define("adamantium/model",["require","exports","module","backbone","adamantium/validation/validation"],function(e,t,n){var i=e("backbone"),s=e("adamantium/validation/validation"),r=i.Model.extend(s,{});return r}),define("shared/feature_switch",["require","config","shared/util"],function(e){var t=e("config"),n=e("shared/util"),i=t.featureSwitches||{},s={},r={};return r.isEnabled=function(e){var t=s[e]||n.md5(e);return s[e]=t,i.hasOwnProperty(t)&&i[t]},r}),define("apis/facebook",["require","exports","module","globals","underscore","jquery","shared/cookies","backbone","shared/feature_switch"],function(e,t,n){var i=e("globals"),s=e("underscore"),r=e("jquery"),o=e("shared/cookies"),a=e("backbone"),l=e("shared/feature_switch"),c=!1,u=!1,d="email,user_location",h=s.extend({},a.Events,{onLoad:function(){var e={appId:i.FACEBOOK_APP_ID,channelUrl:"//"+window.location.host+"/channel.html",status:!0,cookie:!0,xfbml:!0};l.isEnabled("fs_facebook-upgrade")&&(e.version="v2.5"),FB.init(e),u=!0,this.trigger("facebook_initialized",FB)},loadScript:function(){if(!c){var e,t=window.document,n=t.createElement("div");e=t.createElement("script"),e.async=!0,l.isEnabled("fs_facebook-upgrade")?e.src="//connect.facebook.com/en_US/sdk.js":e.src="//connect.facebook.net/en_US/all.js",n.setAttribute("id","fb-root"),n.appendChild(e),t.body.appendChild(n),c=!0}},before:function(e){var t=this;if(u)e();else{var n=function(i){t.off("facebook_initialized",n),e(i)};this.loadScript(),this.on("facebook_initialized",n)}},onFB:function(e,t){this.before(function(n){n.Event.subscribe(e,t)})},loginStatus:function(){var e=new r.Deferred;return this.before(function(){FB.getLoginStatus(function(t){e.resolve(t)})}),e.promise()},isConnected:function(){var e=new r.Deferred;return this.loginStatus().then(function(t){"connected"===t.status?e.resolve(t):e.reject(t)}),e.promise()},login:function(e){var t=new r.Deferred;return this.before(function(){FB.login(function(e){"connected"===e.status?t.resolve(e):t.reject(e)},{scope:d})}),t.promise()},loginPages:function(e){var t=new r.Deferred;return this.before(function(){FB.login(function(e){"connected"===e.status?t.resolve(e):t.reject(e)},{scope:"pages_show_list"})}),t.promise()},approvePublish:function(e){var t=new r.Deferred,n="silence_publish_actions_"+e;return o.get(n)?(t.resolve(),t.promise()):(this.isConnected().then(function(){FB.login(function(e){"connected"===e.status?(o.set(n,1,1296e3),t.resolve(e)):t.reject(e)},{scope:"publish_actions"})}),t.promise())},logout:function(){var e=new r.Deferred,t=this;return this.before(function(){t.loginStatus().then(function(t){"connected"===t.status?FB.logout(function(t){e.resolve(t)}):e.resolve()},function(){e.resolve()})}),e.promise()},deletePermissions:function(){var e=new r.Deferred;return this.loginStatus().then(function(t){"connected"===t.status?FB.api("me/permissions","delete",function(t){!t||t.error?e.reject(t):e.resolve(t)}):e.reject()}),e.promise()},getUserInfo:function(){var e=new r.Deferred;return this.before(function(){FB.api("/me",function(t){t.error?e.reject(t):e.resolve(t)})}),e.promise()},getUserPagesInfo:function(){var e=new r.Deferred;return this.before(function(){FB.api("/me/accounts",function(t){t.error?e.reject(t):e.resolve(t)})}),e.promise()},getUserAvatar:function(){var e=new r.Deferred;return this.before(function(){FB.api("/me/picture?redirect=false&width=200&height=200",function(t){t.error?e.reject(t):e.resolve(t)})}),e.promise()},connectAccount:function(){var e,t=new r.Deferred,n=this;return this.login().then(function(t){return e=t.authResponse,n.getUserInfo()}).then(function(t){return l.isEnabled("fs_facebook-upgrade")&&(t.username=t.name),r.post("/ajax/add/facebook-user",s.extend({},t,e))}).then(function(e){t.resolve(e)}).fail(function(){t.reject.apply(t,arguments)}),t.promise()},requestPages:function(){var e=new r.Deferred,t=this;return this.loginPages().then(function(e){return t.getUserPagesInfo()}).then(function(t){e.resolve(t)}).fail(function(){e.reject.apply(e,arguments)}),e.promise()},connectPage:function(e){var t=r.ajax({url:"/ajax/add/facebook-business-page",type:"post",data:e});return t},like:function(e){var t=new r.Deferred;return this.loginStatus().then(function(n){"connected"===n.status?FB.api("me/og.likes","post",{object:e},function(e){!e||e.error?t.reject(e):t.resolve(e)}):t.reject()}),t.promise()},share:function(e){var t=new r.Deferred;return FB.ui({method:"share",href:e},function(e){e.post_id?t.resolve(e):t.reject(e)}),t.promise()}});return window.fbAsyncInit=s.bind(h.onLoad,h),h}),define("shared/utm",["require","underscore","shared/util","shared/cookies"],function(e){var t=e("underscore"),n=e("shared/util"),i=e("shared/cookies"),s={init:function(){var e=this.getParams();t.isEmpty(e)||i.set("cm_utms_last",JSON.stringify(e))},utmMap:{utm_campaign:"UTM Campaign",utm_content:"UTM Content",utm_medium:"UTM Medium",utm_source:"UTM Source",utm_term:"UTM Term"},getParams:function(){var e=t.keys(this.utmMap);return t.pick(n.getQueryParams(),e)},getCookieLast:function(){var e=JSON.parse(i.get("cm_utms_last"));return e},getDefault:function(){if(!window.mixpanel)return{};var e={};return t(this.utmMap).forEach(function(t,n){var i=window.mixpanel.get_property(n);i&&(e[t]=i)}),e},getFirst:function(){var e=this.getDefault(),n={};return t.isEmpty(e)||t(this.utmMap).forEach(function(t,i){n[t+" First"]=e[t]||"N/A"}),n},getLast:function(){var e=this.getCookieLast(),n=this.utmMap,i={};return e&&t(n).forEach(function(t,n){var s=e[n]||"N/A";i[t+" Last"]=s}),i},isEmpty:function(){return t.isEmpty(this.getParams())}};return s.init(),s}),define("shared/models/session",["require","jquery","underscore","adamantium/model","event_bus","globals","apis/facebook","shared/utm","shared/utm","shared/feature_switch"],function(e){var t=e("jquery"),n=e("underscore"),i=e("adamantium/model"),s=e("event_bus"),r=e("globals"),o=e("apis/facebook"),a=e("shared/utm"),a=e("shared/utm"),l=e("shared/feature_switch"),c=i.extend({USERNAME_MIN_LENGTH:2,USERNAME_MAX_LENGTH:20,PASSWORD_MIN_LENGTH:4,NAME_MAX_LENGTH:128,_validating:{},_valuesChecked:{},_requesting:{},sessionDisabled:!1,sessionMethod:null,sessionSource:null,sessionModule:null,fbLoginStatus:!1,fbAuthResponse:!1,requestMethods:{signup:"/ajax/add/user/",signin:"/ajax/add/session/",facebook_signin:"/session/facebook/signin/",facebook_link:"/session/facebook/link/"},disable:function(){this.sessionDisabled=!0},validation:function(){var e={userName:{required:!0,minLength:this.USERNAME_MIN_LENGTH},password:{required:!0,minLength:this.PASSWORD_MIN_LENGTH}};if("signup"===this.sessionMethod&&(e=n.extend({},e,{firstName:{required:!0,maxLength:this.NAME_MAX_LENGTH},lastName:{required:!0,maxLength:this.NAME_MAX_LENGTH},email:{required:!0,pattern:"email"}}),window.optimizely_7355080124)){var t=window.optimizely_7355080124_1?"Please agree to the Terms <br/> of Use, License Terms, and <br/> Privacy Statement to continue.":"Please agree to the Terms of <br> Use and Privacy Statement to <br>continue.";e=n.extend({},e,{termsAgree:{acceptance:!0,msg:t}})}return e},labels:{userName:"Username",password:"Password",firstName:"First Name",lastName:"Last Name",email:"Email Address"},initialize:function(e,t){t||(t={}),this.on("sync",this.onSync,this),window.EventBus.on("session:hydrate",this.hydrate,this),window.analytics&&window.analytics._readied?this.identify():s.on("analytics:ready",this.identify,this)},isLoggedIn:function(){return!this.isNew()},url:function(){var e=this.requestMethods[this.sessionMethod];return r.isProduct?"signup"===this.sessionMethod?e+=r.purchase.isFreeGood?"free-goods":"product":"signin"===this.sessionMethod&&(e+="product"):r.isBundle?e+="product":this.sessionSource&&(e+=this.sessionSource),e},toJSON:function(e){return n.extend(n.clone(this.attributes),{token:r._session_token})},fullName:function(){return this.get("firstName")+" "+this.get("lastName")},shopUrl:function(){return"/"+this.get("userName")},numCredits:function(){return this.get("numCredits")||0},alias:function(){window.analytics.alias(this.id)},shouldFetchProperties:function(){var e=parseInt(this.get("dlt"),10);return n.isNaN(e)&&(e=0),!e||Date.now()/1e3-e>43200},identify:function(){var e=a.getFirst(),i=a.getLast(),s={URL:window.location.pathname,"Page Name":document.title,"Page Type":r.page_type_text,"Signed In":!!this.id,"Is First Time Visitor":!!this.get("ftv")};if(n.isEmpty(e)||(window.mixpanel.register_once(e),window.mixpanel.people.set_once(e)),n.isEmpty(i)||n.extend(s,i),this.isLoggedIn()){var o={id:this.id,firstName:this.get("firstName"),
lastName:this.get("lastName"),email:this.get("email"),createdAt:this.get("createdAt"),username:this.get("userName"),displayName:this.get("userName"),"User Id":this.id,"Name First":this.get("firstName"),"Name Last":this.get("lastName"),"Profile URL":"https://"+r.domain+this.get("resourcePath"),"Is Shop Owner":!!this.get("hasShop"),"Is Affiliate":!!this.get("isAffiliate")};n.extend(s,o),this.get("nps")&&!n.isUndefined(window.drift)&&window.drift.identify(this.id,s),this.shouldFetchProperties()?t.ajax({url:"/ajax/properties"}).then(function(e){n.isObject(e)&&n.has(e,"tracking")&&(e.tracking["Is Fraudster"]=e.tracking.isCcCustomer,delete e.tracking.isCcCustomer,n.extend(s,e.tracking))}).always(function(){window.analytics.identify(this.id,s)}):window.analytics.identify(this.id,s)}else window.analytics.identify(s);!t("#widget-purchase").hasClass("pp-auth")&&t("#pp-auth-prompt").length&&l.isEnabled("fs_purchase-rewrite")&&t("body").attr("data-refresh","true")},checkDuplicateAttr:function(e,t){return this.sessionMethod="signup",""===t?(this.trigger("valid",e),!1):!this.preValidate(e,t)&&(this._validating[e]!==t&&(this._requesting[e]&&this._requesting[e].abort(),void this._requestAttrDuplicate(e,t)))},_requestAttrDuplicate:function(e,i){if(n.isString(this._validating[e]))return!1;var s=e+":"+i;this._validating[e]=i,this._valuesChecked[s]?(this._validating[e]=!1,this._triggerAsyncValidation(e,this._valuesChecked[s])):this._requesting[e]=t.get("/ajax/check/"+e,{value:i},n.bind(function(t){var n=!!t.available;this._validating[e]=!1,this._requesting[e]=!1,this._valuesChecked[s]=n,this._triggerAsyncValidation(e,n,t.message)},this))},_triggerAsyncValidation:function(e,t,n){void 0==n&&(n=this.labels[e]+" is already in use"),t?this.trigger("valid",e):this.trigger("invalid",e,n)},signup:function(e,t){return this.sessionMethod="signup",this.sessionSource=e,this.sessionModule=t||"Modal - Standard",!this.validate()&&this.save()},signin:function(e,t){return this.sessionMethod="signin",this.sessionSource=e,this.sessionModule="purchase_process"===e?"Checkout":t||"Modal - Standard",!this.validate()&&(this.setProductID(),this.save())},facebookSignIn:function(e,t){var i,s,a=this;this.sessionMethod="facebook_signin","purchase_process"===e?this.purchase&&(this.sessionModule="Checkout - Standard",r.purchase.isFreeGood&&(this.sessionModule="Checkout - Free Good")):this.sessionModule=t||"Modal - Standard",this.trigger("facebook_auth:start"),o.login().then(function(e){return i=e.authResponse,o.getUserInfo()}).then(function(e){return s=e,o.getUserAvatar()}).then(function(e){var t=n.omit(n.extend({},i,s,{avatar:e.data}),"id");a.clear({silent:!0}),a.setProductID(),a.save(t)}).fail(n.once(n.bind(function(){this._throwFacebookError()},this)))},finishFacebookSignIn:function(){if(this.fbAuthResponse!==!1&&"connected"===this.fbLoginStatus){this.trigger("facebook_auth:start"),this.sessionMethod="facebook_signin",this.sessionSource="auto_login";var e=n.omit(this.fbAuthResponse,"id");this.clear({silent:!0}),this.setProductID(),this.save(e)}},facebookLink:function(e){this.sessionMethod="facebook_link",this.sessionSource=e,this.save()},facebookAutoLogin:function(){if(!this.sessionDisabled){var e=this;this.isLoggedIn()||o.loginStatus().then(function(t){if("connected"===t.status){e.sessionMethod="facebook_signin",e.sessionSource="auto_login";var i=n.omit(t.authResponse,"id");e.clear({silent:!0}),e.setProductID(),e.save(i)}})}},setFacebookLoginStatus:function(){var e=this;o.loginStatus().then(function(t){e.fbLoginStatus=t.status,e.fbAuthResponse=t.authResponse})},_throwFacebookError:function(e){this.trigger("facebook_auth:error",e)},setProductID:function(){r.isProduct&&this.purchase&&this.set("productID",this.purchase.id,{silent:!0})},track:function(e){var t={UserId:this.id,Module:this.sessionModule,url:window.location.href};switch(/^facebook/.test(this.sessionMethod)?t.Method="Facebook":t.Method="Email",this.sessionMethod){case"signin":case"facebook_signin":case"facebook_link":window.analytics.track("Signed In",t);break;case"signup":case"facebook_signup":var i=a.getLast(),s={},r={};if(n(i).forEach(function(e,t){/^UTM.*Last$/.test(t)&&(s[t.replace(/Last$/,"SU")]=e)}),!n.isEmpty(s)){var o=n.keys(s);n.extend(t,s),r.Mixpanel={peopleProperties:o,superProperties:o}}window.analytics.track("Signed Up",t,r)}e&&setTimeout(function(){e()},200)},authenticate:function(e,n,i){var r=new t.Deferred;return e||(e="sign-in"),null==n&&(n={}),i=i||"",this.isLoggedIn()?(s.trigger("session:success",this),r.resolve(this)):(s.on("session:create",function o(){s.trigger("session:success",this),r.resolve(this),s.off(null,o,null)},this),s.on("session:error session:reject",function a(){r.reject(this),s.off(null,a,null)}),s.trigger("session:request",this,e,n,i)),r.promise()},sync:function(e,i,r){var o=this,a=n.extend({type:"POST",contentType:"application/x-www-form-urlencoded",url:i.url()},r);a.success=function(e){try{e=t.parseJSON(e)}catch(n){}if(o.set(e,{silent:!0}),e.sessionMethod&&(o.sessionMethod=e.sessionMethod),e.link_auth)s.trigger("facebook_auth:link");else{/signup/.test(o.sessionMethod)&&o.alias(),o.identify();var i=this,a=arguments;o.track(function(){r.success.apply(i,a)})}},a.error=function(e){var t=e.responseJSON;t&&t.error&&t.error.param&&"facebook"===t.error.param&&o._throwFacebookError(),r.error&&r.error.apply(this,arguments)},this.sessionDisabled&&this.set({noSession:!0},{silent:!0}),a.data={model:JSON.stringify(i.toJSON())},t.ajax(a)},onSync:function(e,t,n){this._setPurchaseRating(),this._triggerGlobalCreate(this.sessionSource),this._clearPasswords()},_setPurchaseRating:function(){var e=this.get("purchase");if(this.purchase&&n.isObject(e)){var t=e.userRating;delete e.userRating,this.purchase.set(e).set("userRating",t,{silent:!0}),this.unset("purchase",{silent:!0})}},_triggerGlobalCreate:function(e){s.trigger("session:create",this,e)},_clearPasswords:function(){this.isNew()||(this.unset("password",{silent:!0}),this.unset("passwordConfirm",{silent:!0}))},hydrate:function(e,n){this.set(e,{silent:!0}),this.sessionMethod=n,this.sessionModule="Checkout - Standard",t("body").removeAttr("data-refresh"),window.EventBus.trigger("session:create",this),this.identify(),this.track()}});return new c(r.session)}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!shared/templates/follow_btn.tmpl",[],function(){return'<a href="#" data-follow="toggle" class="btn btn-small with-text btn-follow not-loaded" data-user-id="<%= id %>">\n\t<span class="following"><i class="icon-check-large-white"></i>Following</span>\n\t<span class="follow"><i class="icon-plus-dark3"></i>Follow</span>\n</a>'}),define("shared/plugins/follow_btn",["require","exports","module","jquery","underscore","shared/models/session","event_bus","text!shared/templates/follow_btn.tmpl"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("shared/models/session"),o=e("event_bus"),a=e("text!shared/templates/follow_btn.tmpl");t.render=s.template(a),t.load=function(){var e,t,n=[],s=i(".btn-follow.not-loaded"),a=function(e){var t,n,i;for(t=0,n=s.length;t<n;t++)i=s.eq(t).removeClass("not-loaded").attr("data-user-id"),o.trigger("follow",i,!!e[i])};for(e=0,t=s.length;e<t;e++)n.push(s.eq(e).attr("data-user-id"));r.isLoggedIn()?n.length>0&&i.ajax({url:"/ajax/following",dataType:"json",data:{user_ids:n.join(",")},success:a}):a({})},o.on("follow",function(e,t){i(".btn-follow[data-user-id="+e+"]").toggleClass("is-following",t).toggleClass("is-not-following btn-grey",!t).blur();var n=i(".num-followers[data-user-id="+e+"]");if(n.length){var s=parseInt(n.html().replace(/,/,""),10);n.html(s+(t?1:-1))}}),i(document).on("click",'[data-follow="toggle"]',function(e){e.preventDefault(),r.authenticate(!1,!1,"Follow").then(s.bind(function(){var e=i(this).hasClass("is-following"),t=i(this).data("user-id"),n="/ajax/add/user-follower/"+t;e&&(n="/ajax/rm/user-follower/"+t),i.post(n),o.trigger("follow",t,!e),e||analytics.track("Followed",{"Followee ID":t,"Follower ID":r.id})},this))}),i(t.load)}),define("shared/template_loader",["require","underscore"],function(e){var t=e("underscore"),n=function(e,t,n){this.view=e,this.options=t,this.url=n,this.templates=[]};return n.prototype.register=function(e,n){n=n&&t.once(n);var i,s=[],r=function(e){return i?e(i):void s.push(e)};return this.templates.push({name:e,callback:function(e){for(i=e;s.length;)s.pop()(e);n&&n(e)}}),r},n.prototype.reset=function(e){this.xhr&&this.xhr.abort(),this.templates=[],this.options=e||{}},n.prototype.execute=function(e){var n=this;n.xhr=$.ajax({method:n.options.server_method||"GET",url:n.url||"/ajax/render",data:{view:n.view,template:t.uniq(t.pluck(n.templates,"name")),options:JSON.stringify(n.options)},success:function(t){n.onResponse(t),e&&e()}})},n.prototype.onResponse=function(e){var n,i,s=this,r=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n].callback(t)};if("string"==typeof e)return r(s.templates,e);for(n in e)e.hasOwnProperty(n)&&(i=t.filter(s.templates,{name:n}),r(i,e[n]))},n}),define("shared/keyboard",["require","underscore"],function(e){var t=e("underscore"),n=function(e){this.key=e.originalEvent.which||e.keyCode,this.typedChar=String.fromCharCode(this.key),this.shiftKey=e.shiftKey,this.ctrlKey=e.ctrlKey,this.metaKey=e.metaKey};return t.extend(n.prototype,{charCodes:{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,esc:27,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftsuper:91,rightsuper:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalpoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},name:function(){return this.typedChar},is:function(e){return this.charCodes[e]===this.key},isNot:function(e){return!this.is(e)},isModifier:function(){return this.is("delete")||this.is("backspace")||this.is("tab")||this.is("esc")||this.is("enter")||(this.ctrlKey===!0||this.metaKey===!0)&&(this.is("a")||this.is("r")||this.is("l"))||this.is("leftsuper")||this.is("rightsuper")||this.is("select")||this.key>=35&&this.key<=39},isNotModifier:function(){return!this.isModifier()},isNotNumber:function(e){return e?this.key<48||this.key>57:this.shiftKey||(this.key<48||this.key>57)&&(this.key<96||this.key>105)},isNumber:function(){return!this.isNotANumber()}}),n}),define("adamantium/view",["require","jquery","underscore","globals","backbone","shared/template_loader","shared/feature_switch","shared/keyboard"],function(e){var t=e("jquery"),n=e("underscore"),i=(e("globals"),e("backbone")),s=e("shared/template_loader"),r=e("shared/feature_switch"),o=e("shared/keyboard"),a=i.View.extend({serverView:null,serverTemplate:null,serverViewOptions:null,autoReload:!0,templateLoaderUrl:null,autoReloadDelay:100,autoPaging:!1,autoPagingKeys:["page"],autoScroll:!0,linkedViews:[],historyMethod:"replace",reloadMethod:"replace",_rendered:!1,html:function(e){return n.isUndefined(e)?this.$el.html():void this.$el.html(e)},delegateEvents:function(){var e=this.events,s=this;return"function"==typeof e&&(e=e.apply(this,[])),this.autoPaging&&(e=n.extend({},e,{"click.adamantium a[data-page]":"_onPageClick","click.adamantium [rel=next]":"_onNextClick","click.adamantium [rel=prev]":"_onPrevClick","click.adamantium [rel=more]":"_onMoreClick"}),r.isEnabled("fs_keyboard-pagination")&&t(document).off("keyup").on("keyup",function(e){s._handleKeyPress(e)})),i.View.prototype.delegateEvents.apply(this,[e])},setElement:function(){var e=i.View.prototype.setElement.apply(this,arguments),t=this.getViewOptions();return t.set(this._getViewOptions(),{silent:!0}),e},undelegateEvents:function(){return this.$el.off(".adamantium"),i.View.prototype.undelegateEvents.apply(this,arguments)},_handleKeyPress:function(e){if(!(t('a[rel="more"]').length>0)){var n=this.getViewOptions(),i=n.get("page");void 0===i&&n.set({page:1},{silent:!0});var s=new o(e);s.is("right")?this._onNextClick(e):s.is("left")&&this._onPrevClick(e)}},_onPrevClick:function(e){return!t(e.currentTarget).hasClass("disabled")&&(e.preventDefault(),void this._advance(-1))},_onNextClick:function(e){return!t(e.currentTarget).hasClass("disabled")&&(e.preventDefault(),void this._advance(1))},_onPageClick:function(e){var n=t(e.currentTarget);if(n.hasClass("disabled"))return!1;var i=parseInt(n.attr("data-page"),10);e.preventDefault(),this._page(i)},_onMoreClick:function(e){var n=this.$('a[rel="more"]');this.autoScroll=!1,this.reloadMethod="append",n.addClass("disabled"),t(".button-text",n).hide(),void 0!==this.loadingIndicator&&this.loadingIndicator.show(),e.preventDefault(),this._advance(1)},_onOptionsChange:function(){var e,t,i,s,r,o,a;if(e=this.getViewOptions(),t=n.clone(this.autoPagingKeys),t.unshift(n.keys(e.changedAttributes())),i=n.without.apply(n,t),i.length){for(s={},r=0,o=this.autoPagingKeys.length;r<o;r++)a=this.autoPagingKeys[r],"page"===a?s.page=1:s[a]=null;e.set(s,{slient:!0})}},_advance:function(e){var t=this.getViewOptions();return this._page(Math.max(1,t.get("page")+e)),!1},_page:function(e){return this.getViewOptions().set({page:e}),this._scroll=this.autoScroll,!1},setScroll:function(e){this._scroll=!!e},_textIsSelected:function(e){var t="";return window.getSelection?t=window.getSelection():document.getSelection?t=document.getSelection():document.selection&&(t=document.selection.createRange().text),e===t.toString()},_startAutoReload:function(){if(this.autoReload){var e=this,n=this.getViewOptions(),i=this._scroll,s=n.toJSON();this._scroll=!1,this.reload(s,function(){i&&"function"==typeof window.scrollTo&&(e.options&&e.options.scrollTo?t("body").scrollTo(e.options.scrollTo):window.scrollTo(0,0))})}},linkView:function(e,t){this.linkedViews.push({view:e,options:t})},unlinkView:function(e){for(var t=0,n=this.linkedViews.length;t<n;t++)if(this.linkedViews[t].view===e)return void this.linkedViews.splice(t,1)},appendWithProvider:function(e,n,i){var s=this;window.setTimeout(function(){e(function(e){var i=s.$('a[rel="more"]'),r=t(e),o=r.find(s.appendSelector).children(),a=r.data("options"),l=s.getViewOptions();l.set(a,{silent:!0}),s.$el.data("options",a),0!==o.length?(s.$el.find(s.appendSelector).append(o),s.trigger("reload"),t(".button-text",i).show(),i.removeClass("disabled")):i.text("No results found"),void 0!==s.loadingIndicator&&s.loadingIndicator.hide(),n&&n()})},0)},reload:function(e,n,i){var s,r,o,a,l=this,c=function(e,t,n,i){"append"===l.reloadMethod?e.appendWithProvider(a.register(e.serverTemplate),function(){n&&n()},i):e.reloadWithProvider(a.register(e.serverTemplate),function(){t&&t.once&&l.unlinkView(e),n&&n()},i)};for(e.adamantium="pageViewed",e=t.extend(l.getViewOptions().toJSON(),e),a=l._loader||(l._loader=l.constructor.createTemplateLoader()),a.reset(e),c(l,null,n,i),s=0,r=this.linkedViews.length;s<r;s++)o=this.linkedViews[s],c(o.view,o.options,i);a.execute()},reloadWithProvider:function(e,n,i){var s=this;s.trigger("before-reload"),s.model&&s.model.get("hide_loading_class")||s.$el.addClass("view-reload"),window.setTimeout(function(){s.$el.addClass("loading"),e(function(e){var r=t(e);if(s.model&&s.model.get("hide_loading_class")||r.addClass("view-reload loading"),s.$el.replaceWith(r),s.setElement(r),"undefined"==typeof i||i){var o=r.attr("data-canonical"),a=s.historyMethod&&s.historyMethod+"State";a&&o&&window.history[a]&&(window.history[a]({url:window.location.href,options:s.getViewOptions().toJSON()},null,o),s.trigger("history-update"))}window.setTimeout(function(){r.removeClass("loading"),s.trigger("reload"),n&&n()},0)})},0)},reloadHTML:function(e,n){e=t.extend(this.getViewOptions().toJSON(),e),this.constructor.loadHTML(e,n)},getViewOptions:function(){return this.serverViewOptions||(this.serverViewOptions=new i.Model(this._getViewOptions()),this.serverViewOptions.on("change",this._onOptionsChange,this),this.serverViewOptions.on("change",n.debounce(n.bind(this._startAutoReload,this),this.autoReloadDelay))),this.serverViewOptions},_getViewOptions:function(){try{return JSON.parse(this.$el.attr("data-options")||"{}")}catch(e){return{}}}},{createTemplateLoader:function(e){var t=this.prototype.serverView;if(!t)throw new Error('"serverView" property not set');return new s(t,e,this.prototype.templateLoaderUrl)},loadHTML:function(e,t){var n,i;if(n=this.prototype.serverTemplate,!n)throw new Error('"serverTemplate" property not set');i=this.createTemplateLoader(e),i.register(n,t),i.execute()},load:function(e,n){var i=this;this.loadHTML(e,function(e){var s=new i({el:t(e)});n&&n(s)})}});return a}),define("text!shared/templates/loading.tmpl",[],function(){return'<span class="cm-loading">\n\t<span class="loading-dot"></span>\n\t<span class="loading-dot"></span>\n\t<span class="loading-dot"></span>\n</span>'}),define("shared/loading",["require","jquery","underscore","text!shared/templates/loading.tmpl"],function(e){var t=e("jquery"),n=e("underscore"),i=e("text!shared/templates/loading.tmpl"),s={size:"small",color:"white"},r=function(e,i){if(!e)throw new Error("el not defined - Loader needs a target element");this.options=n.extend({},s,i),this.$el=t(e),this.render()};return r.prototype.render=function(){var e=n.template(i);this.loading=t(e()),"large"===this.options.size&&this.loading.addClass("cm-loading-large"),"dark"===this.options.color&&this.loading.addClass("cm-loading-dark"),this.loading.addClass("hidden"),this.$el.append(this.loading)},r.prototype.toggle=function(e){var t=!this.loading.hasClass("hidden"),n=e?"show":"hide";if(t!==e)return this[n]()},r.prototype.show=function(){return this.loading.removeClass("hidden"),this},r.prototype.hide=function(){return this.loading.addClass("hidden"),this},r.prototype.remove=function(){return this.loading.remove(),this},r.setupButton=function(e,t){e.html("<span>"+e.html()+"</span>");var n=e.children(),i=new r(e,t),s=!1;return i.toggle=function(e){e?i.show():i.hide()},i.show=function(){if(!s){s=!0;var t=e.outerWidth();e.css({width:t||"auto"}),e.addClass("disabled"),n.hide(),r.prototype.show.apply(this,arguments)}},i.hide=function(){s&&(s=!1,n.show(),e.removeClass("disabled"),r.prototype.hide.apply(this,arguments))},i.remove=function(){n.show(),e.removeClass("disabled"),r.prototype.remove.apply(this,arguments)},i},r}),define("text!shared/templates/error_marker.tmpl",[],function(){return'<div class="marker-error marker-error-left notvisible" data-error="<%= error %>">\n\t<i class="icon-exclamation-mark"></i>\n</div>'}),define("shared/marker",["require","exports","module","jquery","underscore","adamantium/view","text!shared/templates/error_marker.tmpl"],function(e,t,n){var i=(e("jquery"),e("underscore")),s=e("adamantium/view"),r=s.extend({className:"marker-error marker-error-left notvisible",template:i.template(e("text!shared/templates/error_marker.tmpl")),events:{mouseenter:"showTooltip",mouseleave:"hideTooltip"},initialize:function(){this.message=this.options.message||"There was an error",this.render()},render:function(){this.html('<i class="icon-exclamation-mark"></i>'),this._initializeTipsy(),this.setMessage()},_initializeTipsy:function(e){var t=this;this.$el.tipsy({title:function(){return t.$el.data("error")},gravity:this.options.direction||"e",offset:8,trigger:"manual",html:!0,fade:!0,fadeSpeed:400})},setMessage:function(e){this.$el.data("error",e||this.message)},show:function(){this.$el.removeClass("notvisible")},hide:function(){this.hideTooltip(),this.$el.addClass("notvisible")},showTooltip:function(){this.$el.tipsy("show").addClass("showing-tooltip")},hideTooltip:function(){this.$el.tipsy("hide").removeClass("showing-tooltip")},quickDisplayTooltip:function(){this.showTooltip(),i.delay(i.bind(this.hideTooltip,this),5e3)}});return r}),define("shared/views/facebook_connect_button",["require","exports","module","underscore","globals","event_bus","adamantium/view","shared/tooltip","shared/loading","shared/marker","shared/models/session"],function(e,t,n){var i=(e("underscore"),e("globals")),s=e("event_bus"),r=e("adamantium/view"),o=(e("shared/tooltip"),e("shared/loading")),a=e("shared/marker"),l=e("shared/models/session"),c=r.extend({tagName:"a",className:"btn btn-full btn-facebook facebook-login",events:{click:"onClick"},attributes:function(){return{"data-tracking":"Continue with Facebook"}},marker:null,loading:null,method:"",initialize:function(){this.options.className&&(this.className=this.options.className),this.setLabel(),this.model.on("facebook_auth:start",this.onStart,this),this.model.on("facebook_auth:error",this.onError,this),s.on("session:create session:reject",this.onSessionCreate,this),s.on("sessionModal:show",this.onShowModal,this)},setLabel:function(){switch(this.options.label){case"signin":this.label="Sign in using <strong>Facebook</strong>";break;case"signup":this.label="Sign up using <strong>Facebook</strong>";break;default:this.label=this.options.label}},render:function(){return this.$el.attr("disabled",!1),this.$el.removeClass("no-text"),this.html(this.label||""),this},onShowModal:function(e){e&&(this.method=e)},onClick:function(e){e.preventDefault();var t=$(e.currentTarget),n=t.parents("div.signup-pane").length?"purchase_process":"";if(this.loading)return!1;this.marker&&this.marker.hideTooltip(),this.marker=null;var i=this.$el.parent('[data-btn="facebook-sign-up"]').data("options"),s=i&&i.method?i.method:this.method;i&&i.next&&(this.options.next=i.next,this.model.set({next:i.next},{silent:!0})),l.facebookSignIn(n,s)},onStart:function(){this.$el.attr("disabled",!0),this.$el.addClass("no-text"),this.html(""),this.loading=new o(this.$el),this.loading.show()},onSessionCreate:function(){this.loading&&(this.options.next&&(window.location.href=this.options.next,delete this.options.next),this.resetState())},onError:function(e){return!this.marker&&(this.resetState(),this.marker=new a({message:e||i.msg.session.facebook_generic}),this.$el.append(this.marker.el),void this.marker.show())},resetState:function(){this.render(),this.loading=null}});return c}),define("shared/panes/session",["require","jquery","underscore","event_bus","adamantium/view","shared/views/facebook_connect_button","shared/loading","text!shared/templates/error_marker.tmpl","shared/models/session","vendor/jquery/tipsy"],function(e){var t=e("jquery"),n=e("underscore"),i=(e("event_bus"),e("adamantium/view")),s=e("shared/views/facebook_connect_button"),r=e("shared/loading"),o=e("text!shared/templates/error_marker.tmpl"),a=e("shared/models/session"),l=(e("vendor/jquery/tipsy"),i.extend({className:"hidden",events:{"focus input":"onFocus","keypress input":"onKeypress","focusout input":"onBlur","submit form":"onSubmit","mouseenter .marker-error":"onMarkerEnter","mouseleave .marker-error":"onMarkerLeave","click .cm-checkbox":"onCheckboxClick"},isVisible:!1,formData:{},_spinner:null,errorTemplate:n.template(o),initialize:function(){this.model=a,this._registerModelEvents()},_registerModelEvents:function(){this.model.on("error",this.onSyncError,this).on("invalid",this.onValidationError,this).on("valid",this.onValidationSuccess,this).on("validated:invalid",this.onInvalidSubmission,this).on("change",this.removeGlobalMarker,this)},render:function(){return this.$el.html(this.template()),this.options.facebook!==!1&&this.renderFacebookButton(),this._rendered=!0,this},renderFacebookButton:function(e){var t=this;if("pane-sign-up"===this.__proto__.id&&window.optimizely_7355080124){var n=s.extend({onClick:function(e){if(!t.$('[name="termsAgree"]').is(":checked")){var n=window.optimizely_7355080124_1?"Please agree to the Terms <br/> of Use, License Terms, and <br/> Privacy Statement to continue.":"Please agree to the Terms of <br> Use and Privacy Statement to <br>continue.";return t.model.trigger("invalid","termsAgree",n),!1}s.prototype.onClick.apply(this,arguments)}});this.facebookButton=new n({model:this.model,label:e})}else this.facebookButton=new s({model:this.model,label:e});return this.$el.prepend(this.facebookButton.render().el),this},_renderSpinner:function(){this._spinner=new r(this.$('button[type="submit"]')),this._spinner.show()},_removeSpinner:function(){this._spinner&&this._spinner.remove()},_disableButton:function(){this.$('button[type="submit"]').data("default-text",this.$('button[type="submit"]').text()).addClass("disabled").html("")},_enableButton:function(){this.$('button[type="submit"]').removeClass("disabled").text(this.$('button[type="submit"]').data("default-text"))},_disableInputs:function(e){var t=e?"attr":"removeAttr";this.$("form input")[t]("disabled")},display:function(e){return this.isVisible===e?this:(e?(this.delegateEvents(),this._registerModelEvents()):(this.$(".input-error").removeClass("input-error"),this.$(".marker-error").tipsy("hide").remove(),this.$("form")[0].reset(),this.stopListening(),this.undelegateEvents(),this.model.clear({silent:!0}),this.fillForm()),this.isVisible=e,this.$el.toggleClass("hidden",!e),this)},onSubmit:function(e){e.preventDefault();var n=this;return this.$("input:not(.awesome)").each(function(){var e=t(this);"termsAgree"!==e.attr("name")&&n.model.set(e.attr("name"),e.val(),{silent:!0})}),t("#termsAgree").length&&window.optimizely_7355080124&&this.model.set("termsAgree",t("#termsAgree").is(":checked"),{silent:!0}),this._disableButton(),this._disableInputs(!0),this._renderSpinner(),this.formHasSubmitted.apply(this,arguments),!1},onFocus:function(e){this.trigger("paneError:hide"),t(e.currentTarget).tipsy("hide")},onKeypress:function(e){var n=13;if(e.keyCode===n)e.preventDefault(),this.$el.find("form").trigger("submit");else{var i=t(e.target),s=i.attr("name");this.model.set(s,i.val(),{silent:!0})}},onBlur:function(e){var n=t(e.target),i=n.attr("name"),s=n.val();t.trim(s)?this.model.set(i,s):this.model.unset(i,{silent:!0})},onMarkerEnter:function(e){var n=t(e.target);n.hasClass("notvisible")||n.tipsy("show")},onMarkerLeave:function(e){t(e.target).tipsy("hide")},onCheckboxClick:function(e){var n=t(e.currentTarget).siblings('[type="checkbox"]');analytics.track("Clicked",{Action:n.is(":checked")?"Select Opt-In":"Deselect Opt-In",Module:"Sign-up Modal"})},onValidationSuccess:function(e,t){var n=this.$("[name~="+e+"]"),i=n.closest(".control-group"),s=i.find(".marker-error");if(e.match(/stName$/)){if(!this.model.isValid(["firstName","lastName"]))return!1;n=this.$("[name$=stName]")}n.removeClass("input-error"),n.is(":checkbox")&&n.siblings(".cm-checkbox").removeClass("cm-checkbox-error"),this._removeMarker(s)},onValidationError:function(e,n){var i=e?this.$("input[name~="+e+"]"):this.$('button[type="submit"]'),s=i.closest(".control-group"),r=s.find(".marker-error"),o=t(this.errorTemplate({error:n}));/stName$/.test(e)&&n.indexOf("required")>-1&&(n="First Name and Last Name Required",i=this.$("[name$=stName]"),o.data("error",n)),i.addClass("input-error"),i.is(":checkbox")&&i.siblings(".cm-checkbox").addClass("cm-checkbox-error"),r.length?r.tipsy("hide").data("error",n):this._renderMarker(o,s)},onInvalidSubmission:function(){this._disableInputs(!1),this._enableButton(),this._removeSpinner()},onSyncError:function(e,t,n){if(!t.status)return!1;var i=JSON.parse(t.responseText),s=i.error.message||"Unknown Error",r=i.error.param;this._disableInputs(!1),this._enableButton(),this._removeSpinner(),this.model.trigger("invalid",r,s)},removeGlobalMarker:function(){this.$('button[type="submit"]').hasClass("input-error")&&(this.$('button[type="submit"]').removeClass("input-error"),this._removeMarker(this.$('button[type="submit"]').find(".marker")))},resetForm:function(){this.$("form")[0].reset(),this.$(".input-error").removeClass("input-error"),this.$(".marker-error").remove(),this.fillForm()},fillForm:function(){var e=this.formData;n.isObject(e)&&n.each(e,function(e,n){t("[name="+n+"]",this.$("form")).val(e)})},_renderMarker:function(e,t){e.appendTo(t),this._addTooltipToMarker(e),e[0].offsetWidth,e.removeClass("notvisible")},_removeMarker:function(e){e.tipsy("hide").removeAttr("data-error").addClass("notvisible"),setTimeout(function(){e.remove()},400)},_addTooltipToMarker:function(e){return e.tipsy({title:function(){return e.data("error")},gravity:"e",trigger:"manual",offset:8,fade:!0,fadeSpeed:400,html:!0})}}));return l}),define("shared/form",["require","jquery","underscore"],function(e){var t={},n=e("jquery"),i=e("underscore"),s=i.template('<div class="marker-error marker-error-left notvisible" data-error="<%= error %>"><i class="icon-exclamation-mark"></i></div>');return t.setError=function(e,n,i){e.toggleClass("input-error",!!n),t.setMarker(e,n,i)},t.setMarker=function(e,t,n){e[0];t?this.addMarker(e,t,n):this.removeMarker(e)},t.removeMarker=function(e){var t=e[0].$marker;t&&(t.tipsy("hide"),t.remove())},t.addMarker=function(e,i,r){r=n.extend({side:"left"},r),e[0].$marker&&t.removeMarker(e);var o=n(s({error:i}));e[0].$marker=o;var a=e.position();o.insertAfter(e).css({position:"absolute",top:a.top+e.outerHeight()/2-o.height()/2}),"right"===r.side?o.removeClass("marker-error-left").css({left:a.left+e.outerWidth()-3}):o.css({left:-o.width()+3}),o.tipsy({title:"data-error",gravity:"left"===r.side?"e":"w",offset:8,fade:!0,fadeSpeed:400}),o.stop().animate({opacity:1},400)},t.clearErrors=function(e){n(".input-error").removeClass("input-error");var t=n(".marker-error",e);t.tipsy("hide").remove()},t.reskinCheckboxes=function(e){var t=function(e,t,n,i){e.prop("checked",n),t.toggleClass("cm-checkbox-checked",n),"undefined"!=typeof i&&t.toggleClass("disabled",i)};n("input[type=checkbox]",e).each(function(){if(!this.skinned){this.skinned=!0;var e=n(this).hide(),i=n("<span>").addClass("cm-checkbox"),s=e.is(":checked"),r=e.hasClass("disabled"),o=e.attr("value");o&&"on"!==o||(o="1"),e[0].$skinned=i,i[0].$input=e,i.insertBefore(e),e.attr("value",o),t(e,i,s,r)}}),e.on("change","input[type=checkbox]",function(e){if(!e||!e.emulated){var i=n(this),s=i[0].$skinned;s&&t(i,s,i.is(":checked"),i.hasClass("disabled"))}}),e.on("tap click",".cm-checkbox",function(e){if(!n(this).hasClass("disabled")){var i=n(this),s=i[0].$input||n(),r=!s.is(":checked");return t(s,i,r),s.trigger("change",{emulated:!0}),!1}}),e.on("tap click",".checkbox-group",function(e){return n(e.target).hasClass("cm-checkbox")||n(".cm-checkbox",this).trigger("click"),!1})},t.reskinRadioButtons=function(e){var t={},i=function(e,t,n,i){e.prop("checked",n),t.toggleClass("cm-radiobtn-checked",n),"undefined"!=typeof i&&t.toggleClass("disabled",i)};n("input[type=radio]",e).each(function(){if(!this.skinned){this.skinned=!0;var e=n(this).hide(),s=e.is(":checked"),r=e.attr("name")||"",o=e.hasClass("disabled"),a=n("<span>").addClass("cm-radiobtn");e[0].$skinned=a,a[0].$input=e,a.insertBefore(e),i(e,a,s,o),t.hasOwnProperty(r)||(t[r]=[]),t[r].push(a)}}),e.on("change","input[type=radio]",function(e){if(!e||!e.emulated){var t=n(this),s=t[0].$skinned;s&&i(t,s,t.is(":checked"),t.hasClass("disabled"))}}),e.on("tap click",".cm-radiobtn",function(){if(!n(this).hasClass("disabled")){for(var e=n(this),s=e[0].$input||n(),r=s.attr("name")||"",o=t[r]||[],a=0;a<o.length;a++)o[a][0]!==this&&o[a].removeClass("cm-radiobtn-checked");return i(s,e,!0),s.trigger("change",{emulated:!0}),!1}}),e.on("tap click",".radiobtn-group",function(e){return console.log("yo"),n(e.target).hasClass("cm-radiobtn")||n(".cm-radiobtn",this).trigger("click"),!1})},t.init=function(e){e=n(e),t.reskinCheckboxes(e),t.reskinRadioButtons(e)},t}),define("text!shared/templates/sign_in_pane.tmpl",[],function(){return'<% if (!obj.facebookLink) { %>\n\t<span class="divider">OR</span>\n<% } %>\n\n<form action="/op/sign-in" method="post">\n\t<div class="control-group">\n\t\t<input type="text" id="username-sign-in" name="userName" tabindex="1" placeholder="<% if (obj.facebookLink) { %>Email Address<% } else { %>Username<% } %>" val="<%= obj.email || \'\' %>">\n\t</div>\n\t<div class="control-group">\n\t\t<a href="/recover-account" class="forgot" target="_blank">Forgot?</a>\n\t\t<input type="password" id="password-sign-in" name="password" tabindex="2" placeholder="Password">\n\t</div>\n\t<div class="control-group">\n\t\t<button class="btn btn-full" type="submit" tabindex="3">Sign In</button>\n\t</div>\n</form>';
}),define("shared/panes/sign_in",["require","exports","module","underscore","shared/panes/session","shared/form","text!shared/templates/sign_in_pane.tmpl"],function(e,t,n){var i=e("underscore"),s=e("shared/panes/session"),r=e("shared/form"),o=e("text!shared/templates/sign_in_pane.tmpl"),a=s.extend({id:"pane-sign-in",template:i.template(o),render:function(){var e=$("username-sign-in"),t=e.parents(".modal:first");return t.css("height","340"),this.html(this.template({usernameMaxLength:this.model.USERNAME_MAX_LENGTH})),s.prototype.renderFacebookButton.call(this,"signin"),r.init(this.$el),this},formHasSubmitted:function(e){this.model.signin(this.options.source,this.options.method)}});return a}),define("vendor/mailcheck",["require","exports","module"],function(e,t,n){var i={mailcheck:{threshold:3,defaultDomains:["yahoo.com","google.com","hotmail.com","gmail.com","me.com","aol.com","mac.com","live.com","comcast.net","googlemail.com","msn.com","hotmail.co.uk","yahoo.co.uk","facebook.com","verizon.net","sbcglobal.net","att.net","gmx.com","mail.com"],defaultTopLevelDomains:["co.uk","com","net","org","info","edu","gov","mil"],run:function(e){e.domains=e.domains||i.mailcheck.defaultDomains,e.topLevelDomains=e.topLevelDomains||i.mailcheck.defaultTopLevelDomains,e.distanceFunction=e.distanceFunction||i.sift3Distance;var t=i.mailcheck.suggest(encodeURI(e.email),e.domains,e.topLevelDomains,e.distanceFunction);t?e.suggested&&e.suggested(t):e.empty&&e.empty()},suggest:function(e,t,n,i){e=e.toLowerCase();var s=this.splitEmail(e),r=this.findClosestDomain(s.domain,t,i);if(r){if(r!=s.domain)return{address:s.address,domain:r,full:s.address+"@"+r}}else{var o=this.findClosestDomain(s.topLevelDomain,n);if(s.domain&&o&&o!=s.topLevelDomain){var a=s.domain;return r=a.substring(0,a.lastIndexOf(s.topLevelDomain))+o,{address:s.address,domain:r,full:s.address+"@"+r}}}return!1},findClosestDomain:function(e,t,n){var i,s=99,r=null;if(!e||!t)return!1;n||(n=this.sift3Distance);for(var o=0;o<t.length;o++){if(e===t[o])return e;i=n(e,t[o]),i<s&&(s=i,r=t[o])}return s<=this.threshold&&null!==r&&r},sift3Distance:function(e,t){if(null==e||0===e.length)return null==t||0===t.length?0:t.length;if(null==t||0===t.length)return e.length;for(var n=0,i=0,s=0,r=0,o=5;n+i<e.length&&n+s<t.length;){if(e.charAt(n+i)==t.charAt(n+s))r++;else{i=0,s=0;for(var a=0;a<o;a++){if(n+a<e.length&&e.charAt(n+a)==t.charAt(n)){i=a;break}if(n+a<t.length&&e.charAt(n)==t.charAt(n+a)){s=a;break}}}n++}return(e.length+t.length)/2-r},splitEmail:function(e){var t=e.split("@");if(t.length<2)return!1;for(var n=0;n<t.length;n++)if(""===t[n])return!1;var i=t.pop(),s=i.split("."),r="";if(0==s.length)return!1;if(1==s.length)r=s[0];else{for(var n=1;n<s.length;n++)r+=s[n]+".";s.length>=2&&(r=r.substring(0,r.length-1))}return{topLevelDomain:r,domain:i,address:t.join("@")}}}};return window.jQuery&&!function(e){e.fn.mailcheck=function(e){var t=this;if(e.suggested){var n=e.suggested;e.suggested=function(e){n(t,e)}}if(e.empty){var s=e.empty;e.empty=function(){s.call(null,t)}}e.email=this.val(),i.mailcheck.run(e)}}(jQuery),i.mailcheck}),define("shared/plugins/mailcheck",["require","exports","module","vendor/mailcheck"],function(e,t,n){var i=e("vendor/mailcheck");t.run=function(e){var t=e.parents(".modal:first"),n=e.siblings(".mailcheck"),s=!!n.length;e=$(e),i.run({email:e.val(),suggested:function(i){s||(n=$('<span class="mailcheck">').insertAfter(e),n.on("click",".suggestion",function(i){return e.val($.trim($(i.target).text())),n.removeClass("visible"),t.removeClass("has-email-suggestion"),!1})),t.addClass("has-email-suggestion"),n.html('Did you mean <a class="suggestion" href="#">'+i.full+"</a>?"),window.setTimeout(function(){n.addClass("visible")},0)},empty:function(){n.length&&(n.removeClass("visible"),t.removeClass("has-email-suggestion"))}})}}),define("text!shared/templates/sign_up_pane.tmpl",[],function(){return'<form action="/op/add/user" method="post" data-module="Sign-up Modal">\n\t<input type="text" class="awesome" id="emailaddress" name="emailaddress">\n\n\t<input type="text" class="awesome" id="email_address" name="email_address">\n\n\t<input type="text" class="awesome" id="name" name="name">\n\n\t<input type="text" class="awesome" id="address" name="address">\n\n\t<input type="text" class="awesome" id="url" name="url">\n\n\t<input type="text" class="awesome" id="website" name="website">\n\n\t<input type="text" class="awesome" id="id" name="id">\n\n\t<input type="text" class="awesome" id="login" name="login">\n\n\t<div class="sign-up-form">\n\t\t<div class="control-group inline">\n\t\t\t<input type="text" name="firstName" maxlength="<%= nameMaxLength %>" tabindex="1" placeholder="First name">\n\t\t\t<input type="text" name="lastName" maxlength="<%= nameMaxLength %>" tabindex="2" placeholder="Last name">\n\t\t</div>\n\n\t\t<div class="control-group">\n\t\t\t<input type="text" name="email" tabindex="3" placeholder="Email Address">\n\t\t</div>\n\t\t<div class="control-group">\n\t\t\t<input type="text" name="userName" maxlength="<%= usernameMaxLength %>" tabindex="4" placeholder="Username">\n\t\t</div>\n\t\t<div class="control-group">\n\t\t\t<input type="password" name="password" tabindex="5" placeholder="Password">\n\t\t</div>\n\n\t\t<div class="control-group">\n\t\t\t<button class="btn btn-full" type="submit" tabindex="6">Sign Up</button>\n\t\t</div>\n\t</div>\n\n\t<div class="control-group continue">\n\t\t<button class="btn btn-full" tabindex="6">Continue with Email</button>\n\t</div>\n\n\t<div class="control-group terms">\n\t\t<div class="checkbox-group">\n\t\t\t<input  type="checkbox" id="termsAgree" name="termsAgree" value="termsAgree">\n\t\t</div>\n\t\t<p class="terms-label">\n\t\t\t<span class="variation-1">I agree to the <a href="/terms" target="_blank">Terms of Use</a>, <a href="/licenses" target="_blank">License Terms</a>, and <a href="/privacy" target="_blank">Privacy Statement</a> (which may include transfer of my information to other countries where Creative Market operates).</span>\n\t\t\t<span class="variation-2">I agree to the <a href="/terms" target="_blank">Terms of Use</a> and <a href="/privacy" target="_blank">Privacy Statement</a>.</span>\n\t\t</p>\n\t</div>\n\n\t<p class="tos-agree">By creating an account, you agree to our <a href="/terms" target="_blank">terms</a> and <a href="/privacy" target="_blank">privacy policy</a>.</p>\n</form>'}),define("shared/panes/sign_up",["require","exports","module","jquery","underscore","shared/panes/session","event_bus","shared/form","shared/plugins/mailcheck","text!shared/templates/sign_up_pane.tmpl"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("shared/panes/session"),o=e("event_bus");Form=e("shared/form"),mailcheck=e("shared/plugins/mailcheck"),tmplSignUpPane=e("text!shared/templates/sign_up_pane.tmpl");var a=r.extend({events:function(){return s.extend({},r.prototype.events,{'focusout [name="userName"]':"onBlurUsername",'focusout [name="email"]':"onBlurEmailAddress","click #show-email-signup":"showEmailSignup","click #show-sign-in-link":"showSignInLink"})},id:"pane-sign-up",template:s.template(tmplSignUpPane),render:function(){return this.html(this.template({usernameMaxLength:this.model.USERNAME_MAX_LENGTH,nameMaxLength:this.model.NAME_MAX_LENGTH})),this.options.facebook!==!1&&(this.$el.prepend('<span class="divider">OR</span>'),r.prototype.renderFacebookButton.call(this,"signup")),Form.init(this.$el),this},showEmailSignup:function(e){e.preventDefault(),o.trigger("sign-up-splash:hide")},showSignInLink:function(e){e.preventDefault(),o.trigger("sign-up-splash:hide"),o.trigger("session-pane:show","sign-in")},onBlurEmailAddress:function(e){var t=i(e.target),n=i.trim(t.val()),s=this;clearTimeout(this._emailCheck),this._emailCheck=setTimeout(function(){s.model.checkDuplicateAttr("email",n)},400),mailcheck.run(t)},onBlurUsername:function(e){var t=i(e.target).val().trim(),n=this;clearTimeout(this._usernameCheck),this._usernameCheck=setTimeout(function(){n.model.checkDuplicateAttr("userName",t)},400)},formHasSubmitted:function(e){this.model.signup(this.options.source,this.options.method)}});return a}),define("text!shared/templates/modal.tmpl",[],function(){return'<% if (closeBtn) { %>\n\t<div class="close-btn"></div>\n<% } %>'}),define("shared/plugins/modal",["require","exports","module","jquery","underscore","config","shared/loading","backbone","shared/models/session","event_bus","text!shared/templates/modal.tmpl"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("config"),o=e("shared/loading"),a=e("backbone"),l=e("shared/models/session"),c=e("event_bus"),u=(e("text!shared/templates/modal.tmpl"),function(e,t){var n=this;this.enabled=!1,this.options=t||{},this.isShowing=!1,this.hideDelay=null,this.triggerProp=null,this.$el=i(e),this.$el.on("click.dismiss.modal",'[data-dismiss="modal"]',s.bind(this.hide,this)),d.getInstance().options.preventSessionClose=t.preventSessionClose,d.getInstance().options.preventClose=t.preventClose,d.getInstance().options.disableBackdropClick=t.disableBackdropClick,d.getInstance().on("hide",function(){t&&t.backdrop!==!1&&n.hide()}),c.on("modal:show",function(e){e!==n&&n.hide(null,{backdrop:!1})})});i.extend(u.prototype,{show:function(){if(!this.enabled){this.enabled=!0;var e=this,t=i.Event("beforeShow");if(this.$el.trigger(t),this.isShowing||t.isDefaultPrevented())return!1;this.options.disableScroll&&i("body").addClass("no-scroll"),this.options.disableBackdrop||d.show(),this._modal(),this._escape(),this._enforceFocus(),c.trigger("modal:show",this),i(window).triggerHandler("show.modal",this.$el),setTimeout(function(){e.isShowing=!0,e.$el.focus().trigger("show"),e.options.tracking&&analytics.track("Modal",s.extend(e.options.tracking,{Action:"Open",Module:e.options.method||e.options.tracking.method}))},400)}},hide:function(e,t){if((l.isLoggedIn()!==!1||this.options.preventSessionClose!==!0)&&this.options.preventClose!==!0){e&&e.preventDefault&&e.preventDefault();var n=this,r=i.Event("beforeHide");if(this.$el.trigger(r),this.isShowing&&!r.isDefaultPrevented()){if(e&&e.delay)return void(this.hideDelay=s.delay(s.bind(this.hide,this),e.delay));clearTimeout(this.hideDelay),this.enabled&&(this.enabled=!1,t&&t.backdrop===!1||d.hide(),this._modal(),i(document).off("focusin.modal"),setTimeout(s.bind(function(){c.trigger("modal:hide",n),i(window).triggerHandler("hide.modal",n.$el),n.$el.trigger("hide"),n.isShowing=!1,n.$el.addClass("hidden"),n.$el.removeClass("close")},this),400),this.options.disableScroll&&i("body").removeClass("no-scroll"),this.options.tracking&&analytics.track("Modal",s.extend(this.options.tracking,{Action:"Close"})))}}},_modal:function(){this.isShowing?this.$el.addClass("close").removeClass("visible"):(this.$el.parent().length||this.$el.appendTo(document.body),this.$el.removeClass("hidden"),this.$el[0].offsetWidth,this.$el.addClass("visible"))},_enforceFocus:function(){var e=this;i(document).on("focusin.modal",function(t){e.$el[0]===t.target||e.$el.has(t.target).length||e.$el.focus()})},_escape:function(){var e=this;this.isShowing?this.$el.off("keyup.dismiss.modal"):this.$el.on("keyup.dismiss.modal",function(t){27===t.which&&e.hide()})}}),u.show=function(){var t={};return function(n,o){if(!r||!r.modals[n])return void console.warn('No modal especified in config with the name of "'+n+'"');var a,l,c,u;return(c=t[n])?(c.show(),c.delegateEvents&&c.delegateEvents(),c):(a=i(r.modals[n]).appendTo(i("body")),u=a.attr("data-require"),u?(l=e(u),c=t[n]=new l(s.extend({el:a},o)),c.show(),c):(a.modal(o),c=t[n]=a.data("modal")))}}(),u.showRemote=function(e,t){var n,s="remote:"+e+":"+JSON.stringify(t);return r.modals.hasOwnProperty(s)?u.show(s):(n=d.getInstance(),n.show(),n.toggleLoading(!0),void i.ajax({url:"/ajax/render",data:{view:e,options:JSON.stringify(t)},complete:function(){n.toggleLoading(!1)},success:function(e){r.modals[s]=e,u.show(s,t)},error:function(){n.hide()}}))};var d=u.Backdrop=a.View.extend({events:{click:"onClickBackdrop"},initialize:function(){this.visible=!1},toggleLoading:function(e){this.loading||(this.loading=new o(this.el,{size:"large"})),this.loading.toggle(e)},render:function(){this.$el.attr({id:"modal-overlay"})},onClickBackdrop:function(){this.options.disableBackdropClick||this.hide()},show:function(){var e=this;e.visible||(e.visible=!0,e.timeout&&window.clearTimeout(e.timeout),e.$el.appendTo(document.body),e.el.offsetWidth,e.delegateEvents(),e.trigger("show"),window.setTimeout(function(){e.$el.addClass("visible")},0))},hide:function(){if((l.isLoggedIn()!==!1||this.options.preventSessionClose!==!0)&&this.options.preventClose!==!0){var e=this;e.visible&&(e.visible=!1,e.$el.removeClass("visible"),e.trigger("hide"),this.timeout=window.setTimeout(function(){e.$el.detach()},400))}}},{getInstance:function(){return d.instance=d.instance||new d,d.instance.render(),d.instance},show:function(){d.getInstance().show()},hide:function(){d.getInstance().hide()}}),h=i.fn.modal;return i.fn.modal=function(e,t){return this.each(function(){var n=i(this),r=n.data("modal"),o=s.extend({},i.fn.modal.defaults,n.data(),"object"==typeof e&&e);r||n.data("modal",r=new u(this,o)),"string"==typeof e?r[e](t||{}):o.show&&(r.options=o,r.show())})},i.fn.modal.noConflict=function(){return i.fn.modal=h,this},i.fn.modal.defaults={show:!0,overlay:!0,beforeHide:i.noop,onHide:i.noop},u}),define("shared/panes/facebook_link",["require","exports","module","underscore","shared/panes/session","text!shared/templates/sign_in_pane.tmpl"],function(e,t,n){var i=e("underscore"),s=e("shared/panes/session"),r=e("text!shared/templates/sign_in_pane.tmpl"),o=s.extend({id:"pane-sign-in",template:i.template(r),_registerModelEvents:function(){s.prototype._registerModelEvents.call(this)},render:function(){return this.html(this.template({facebookLink:!0})),this},focus:function(){this.$("#email-sign-in").focus()},formHasSubmitted:function(e){this.model.facebookLink("modal")}});return o}),define("text!shared/templates/facebook_link_modal.tmpl",[],function(){return'<span class="close-btn" data-dismiss="modal" aria-hidden="true"></span>\n<h2>Link Your Accounts</h2>\n<p>An account with your email address already exists. Enter your email and Creative Market password below to link your accounts.</p>'}),define("shared/modals/facebook_link",["require","exports","module","jquery","underscore","adamantium/view","globals","event_bus","shared/plugins/modal","shared/models/session","shared/panes/facebook_link","text!shared/templates/facebook_link_modal.tmpl"],function(e,t,n){var i=(e("jquery"),e("underscore")),s=e("adamantium/view"),r=(e("globals"),e("event_bus")),o=(e("shared/plugins/modal"),e("shared/models/session")),a=e("shared/panes/facebook_link"),l=s.extend({id:"modal-facebook-link",className:"modal hidden",template:i.template(e("text!shared/templates/facebook_link_modal.tmpl")),modal:null,signInPane:null,signUpPane:null,initialize:function(){this.render(),this._initEvents(),this._hideModalOnSessionCreate()},_initEvents:function(){this.$el.on("show",i.bind(this.onShow,this)),this.$el.on("hide",i.bind(this.onHide,this))},_hideModalOnSessionCreate:function(){r.on("session:create",this.hide,this)},render:function(){return this.$el.html(this.template()),this.facebookLinkPane=new a,this.$el.append(this.facebookLinkPane.render().display(!0).$el),this.facebookLinkPane.resetForm(),this},show:function(e){this.$el.modal({tracking:{Type:"Facebook Link Accounts"}})},onShow:function(){this.facebookLinkPane.focus()},hide:function(){this.$el.modal("hide")},onHide:function(){this.facebookLinkPane.resetForm(),r.trigger("session:reject")}});return new l({model:o})}),define("text!shared/templates/session_modal.tmpl",[],function(){return'<span class="close-btn" data-dismiss="modal" aria-hidden="true"></span>\n<div class="side-panel">\n\t<div class="cm-tag"></div>\n\t<div class="sign-in">\n\t\t<h2>Welcome Back to Creative Market</h2>\n\t\t<p class="separator">&mdash;</p>\n\t\t<p>Graphics, fonts, themes, photos and more, starting at $2!</p>\n\t</div>\n\t<div class="sign-up">\n\t\t<h2>Hey! Welcome to Creative Market</h2>\n\n\t\t<div class="description">\n\t\t\t<p class="separator">&mdash;</p>\n\t\t\t<p>Benefits of Joining:</p>\n\t\t\t<ul>\n\t\t\t\t<li class="discount">Receive a 10% off discount in your inbox</li>\n\t\t\t\t<li class="discount-promo hide">Save 20% Now Through December 4th</li>\n\t\t\t\t<li>Download 6 Free Products every week</li>\n\t\t\t\t<li>Discover 1,000s of new products daily</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</div>\n<div class="modal-inner">\n\t<div class="modal-header">\n\t\t<div class="sign-up">\n\t\t\t<h2>Create Your Free Account</h2>\n\t\t\t<p>Download 6 free products every week and <br> discover inspiring design resources starting at $2.</p>\n\t\t</div>\n\t\t<div class="sign-in">\n\t\t\t<h2>Sign Into Your Account</h2>\n\t\t</div>\n\t</div>\n\t<div class="modal-content">\n\t\t<!-- Wrapper for backbone views -->\n\t\t<div id="pane-session"></div>\n\t</div>\n\t<div class="modal-footer">\n\t\t<p class="sign-up">Already have an account? <a href="#" data-modal-pane="sign-in">Sign in!</a></p>\n\t\t<p class="sign-in">New to Creative Market? <a href="#" data-modal-pane="sign-up">Sign up!</a></p>\n\t</div>\n</div>\n'}),define("text!shared/modals.json",[],function(){return'[\n    {\n        "id": "a-optimizely-8175987295-1",\n        "module": "Header",\n        "pane": [\n            {\n                "title": "sign-in",\n                "hasBg": false,\n                "template": "<div class=\'content\' id=\'a-optimizely-id-1\'><h2>Welcome back to Creative Market</h2><div class=\'description\'><p class=\'separator\'>—</p><p>Graphics, fonts, themes, photos and more starting at $2!</p></div>"\n            },\n            {\n                "title": "sign-up",\n                "hasBg": false,\n                "template": "<div class=\'content\' id=\'a-optimizely-id-1\'><h2>Welcome to <br>Creative Market</h2><div class=\'description\'><p class=\'separator\'>—</p><p><b>Sign up today to get:</b></p><ul><li>A 10% off discount in your inbox</li><li>6 free goods now, plus 6 more every week</li><li>Access to over 1 <i>million</i> design products from independent creators around the world</li></ul></div></div>"\n            }\n        ]\n    },\n    {\n        "id": "d-optimizely-8175987295-1",\n        "module": "Conversion Box",\n        "pane": [\n            {\n                "title": "sign-in",\n                "hasBg": false,\n                "template": "<div class=\'content\' id=\'d-optimizely-id-1\'><h2>Welcome back to Creative Market</h2><div class=\'description\'><p class=\'separator\'>—</p><p>Graphics, fonts, themes, photos and more starting at $2!</p></div>"\n            },\n            {\n                "title": "sign-up",\n                "hasBg": true,\n                "template": "<div class=\'content\' id=\'d-optimizely-id-1\'><h2>One more step to finish your download!</h2><div class=\'description\'><p class=\'separator\'>—</p><p><b>Sign up today to also get:</b></p><ul><li>Access to dozens of free ebooks, worksheets, and creative resources</li><li>6 free goods now, plus 6 more every week</li><li>A 10% off discount in your inbox</li></ul></div></div>"\n            }\n        ]\n    },\n    {\n        "id": "e-optimizely-8175987295-1",\n        "module": "Free Goods - Ribbon",\n        "pane": [\n            {\n                "title": "sign-in",\n                "hasBg": false,\n                "template": "<div class=\'content\' id=\'e-optimizely-id-1\'><h2>Welcome back to Creative Market</h2><div class=\'description\'><p class=\'separator\'>—</p><p>Graphics, fonts, themes, photos and more starting at $2!</p></div>"\n            },\n            {\n                "title": "sign-up",\n                "hasBg": true,\n                "template": "<div class=\'content\' id=\'e-optimizely-id-1\'><h2>Get your discount and free goods</h2><div class=\'description\'><p class=\'separator\'>—</p><p><b>Creative Market members get:</b></p><ul><li>A 10% off discount in your inbox</li><li>6 free goods now, plus 6 more every week</li><li>Access to over 1 <i>million</i> design products from independent creators around the world</li></ul></div></div>"\n            }\n        ]\n    },\n    {\n        "id": "e-optimizely-8175987295-1",\n        "module": "Download",\n        "pane": [\n            {\n                "title": "sign-in",\n                "hasBg": false,\n                "template": "<div class=\'content\' id=\'e-optimizely-id-1\'><h2>Welcome back to Creative Market</h2><div class=\'description\'><p class=\'separator\'>—</p><p>Graphics, fonts, themes, photos and more, starting at $2!</p></div>"\n            },\n            {\n                "title": "sign-up",\n                "hasBg": true,\n                "template": "<div class=\'content\' id=\'e-optimizely-id-1\'><h2>One more step to get your free good!</h2><div class=\'description\'><p class=\'separator\'>—</p><p><b>Sign up today to also get:</b></p><ul><li>A 10% off discount in your inbox</li><li>6 free goods now, plus 6 more every week</li><li>Access to over 1 <i>million</i> design products from independent creators around the world</li></ul></div></div>"\n            }\n        ]\n    },\n    {\n        "id": "base-custom-modal",\n        "module": "Base Modal",\n        "pane": [\n            {\n                "title": "sign-in",\n                "hasBg": false,\n                "template": "<div class=\'content\'><h2>Welcome back to Creative Market</h2><div class=\'description\'><p class=\'separator\'>—</p><p>Graphics, fonts, themes, photos and more, starting at $2!</p></div>"\n            },\n            {\n                "title": "sign-up",\n                "hasBg": true,\n                "template": "<div class=\'content\'><h2>Hey! Welcome to Creative Market</h2><div class=\'description\'><p class=\'separator\'>—</p><p><b>Sign up today to also get:</b></p><ul><li>Access to dozens of free ebooks, worksheets, and creative resources</li><li>6 free goods now, plus 6 more every week</li><li>A 10% off discount in your inbox</li></ul></div></div>"\n            }\n        ]\n    }\n]\n'}),define("shared/modals/session",["require","exports","module","jquery","underscore","adamantium/view","shared/views/facebook_connect_button","shared/panes/sign_in","shared/panes/sign_up","shared/modals/facebook_link","shared/models/session","event_bus","shared/plugins/modal","config","shared/feature_switch","text!shared/templates/session_modal.tmpl","text!shared/modals.json"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("adamantium/view"),o=e("shared/views/facebook_connect_button"),a=e("shared/panes/sign_in"),l=e("shared/panes/sign_up"),c=e("shared/modals/facebook_link"),u=e("shared/models/session"),d=e("event_bus"),h=(e("shared/plugins/modal"),e("config")),f=e("shared/feature_switch"),p=r.extend({events:{"click .modal-footer a":"changePane","click .continue button":"showSignupForm"},className:"modal modal-session hidden",template:s.template(e("text!shared/templates/session_modal.tmpl")),referrer:{},modal:null,href:"",paneState:"",signInPane:null,signUpPane:null,silentHide:!1,modalData:e("text!shared/modals.json"),modalAttrs:null,currentModal:null,initialize:function(){if(this.render(),this._initEvents(),this._hideModalOnSessionCreate(),i("body").hasClass("section-blog")){var e=i.parseJSON(this.modalData);this.modalAttrs=e}d.on("session-pane:show",function(e){this.show(e)},this)},_initEvents:function(){this.$el.on("hide",s.bind(this.onHide,this))},_hideModalOnSessionCreate:function(){d.on("session:create",this.hide,this)},render:function(){return this.$el.html(this.template()),this.signInPane=new a({source:"modal",method:"Modal - Standard"}),this.signUpPane=new l({source:"modal",method:"Modal - Standard"}),this.$("#pane-session").append(this.signInPane.render().display(!0).$el),this.$("#pane-session").append(this.signUpPane.render().$el),this},show:function(e,t){var n=this.$(".close-btn");t||(t={}),this.referrer.path=window.location.pathname+window.location.search+window.location.hash,this.referrer.title=document.title,n.show(),t.preventSessionClose===!0&&n.hide(),t.method&&(this.signInPane.options.method=t.method,this.signUpPane.options.method=t.method,d.trigger("sessionModal:show",t.method)),i("body").hasClass("section-blog")&&(this.currentModal=s.find(this.modalAttrs,function(e){return e.module===t.method&&"Conversion Box"===e.module?"Conversion Box"===e.module:"Base Modal"===e.module})),f.isEnabled("fs_holiday-sale")&&this.$el.addClass("holiday-sale"),window.disable_modal_backdrop&&(t.disableBackdropClick=!0),t.tracking={Type:"sign-up"===e?"Sign Up":"Sign In"},this.$el.modal(t),this.activatePane(e),this.resetPaneForms(),i("body").hasClass("section-blog")&&i(".modal.modal-session").addClass("custom-modal-blog")},hide:function(e){return this.href?void(u.redirect=this.href):(e||(e={}),e.silent&&(this.silentHide=!0),void this.$el.modal("hide"))},onHide:function(){this.resetPaneForms(),this.silentHide||d.trigger("session:reject"),this.silentHide=!1},changePane:function(e){var t=i(e.target),n=t.data("modal-pane");e.preventDefault(),this.activatePane(n)},activatePane:function(e){this.$el.addClass("animating"),i("body").hasClass("section-blog")&&("undefined"!=typeof this.currentModal?this.displayCustomModal(e,this.currentModal):i(".modal .side-panel").removeClass().addClass("side-panel")),"sign-up"===e?this.displaySignUpPane():"sign-in"===e&&this.displaySignInPane(),s.delay(s.bind(function(){this.$el.removeClass("animating")},this),200)},displaySignUpPane:function(){this.paneState="sign-up",this.signInPane.display(!1),this.$el.attr("id","modal-sign-up"),this.ajustContentHeight(this.signUpPane.$el),this.signUpPane.display(!0)},displaySignInPane:function(){this.paneState="sign-in",this.signUpPane.display(!1),this.$el.attr("id","modal-sign-in"),this.ajustContentHeight(this.signInPane.$el),this.signInPane.display(!0)},displayCustomModal:function(e,t){var n=i(".modal .side-panel");n.removeClass().addClass("side-panel");var r=n.find("."+e),o=s.find(t.pane,function(t){return t.title===e});"sign-up"===e?n.addClass(t.id+" custom-image"):n.removeClass(t.id+" custom-image"),r.html(o.template)},ajustContentHeight:function(e){var t,n=this.$el.find(".modal-content");e.is(":visible")?t=e.outerHeight():(t=e.removeClass("hidden").outerHeight(),e.addClass("hidden")),n.height(2*Math.round(t/2))},resetPaneForms:function(){this.signInPane.resetForm(),this.signUpPane.resetForm()},attachFacebookSignUp:function(){i('[data-btn="facebook-sign-up"]').each(function(){var e=i(this).data("options"),t=e&&e.label?e.label:"Sign Up using <strong>Facebook</strong>",n={model:u,label:t,className:"btn btn-facebook facebook-login"},s=new o(n);i(this).prepend(s.render().el)})},showSignupForm:function(e){e.preventDefault();var t=i(e.currentTarget);t.hide(),this.$el.find(".sign-up-form").addClass("show"),this.ajustContentHeight(this.signUpPane.$el)}}),m=new p;return i(document).on("click",'[data-modal="sign-in"]',function(e){e.preventDefault(),e.stopPropagation();var t=i(this),n=t.data("method")?{method:t.data("method")}:{};m.show("sign-in",n),m.href=i(this).data("href")}),i(document).on("click",'[data-modal="sign-up"]',function(e){e.stopPropagation(),e.preventDefault();var t=i(this),n={};t.data("redirect")&&(u.redirect=t.data("redirect")),t.data("method")&&(n.method=t.data("method")),t.data("disable-backdrop-click")&&(n.disableBackdropClick=!0),m.show("sign-up",n),m.href=t.data("href"),t.data("sign-up-splash")&&d.trigger("sign-up-splash:show")}),m.attachFacebookSignUp(),d.on("session:request",function(e,t,n,i){if("undefined"!=typeof n&&(m.signUpPane.formData=n),i)var s={method:i};m.show(t,s)}),d.on("facebook_auth:link",function(){m.hide({silent:!0}),c.show()}),i(function(){h.show_signin_modal&&m.show("sign-in",{method:"Signin Param"})}),m}),define("shared/popup",["require","exports","module"],function(e,t,n){var i=window.popup=function(e){var t=($(window),e.w||400),n=e.h||300,i="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,s="undefined"!=typeof window.screenY?window.screenY:window.screenTop,r="undefined"!=typeof window.outerWidth?window.outerWidth:document.documentElement.clientWidth,o="undefined"!=typeof window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,a=i<0?window.screen.width+i:i,l=parseInt(a+(r-t)/2,10),c=parseInt(s+(o-n)/2.5,10),u=window.open(e.u,e.n||"","scrollbars=no,menubar=no,resizable=yes,toolbar=no,location=no,status=yes,left="+l+",top="+c+",width="+t+",height="+n);return u.focus(),u};return i}),function(e,t){"function"==typeof define&&define.amd?define("swipe",[],function(){return e.Swipe=t()}):"object"==typeof exports?module.exports=t():e.Swipe=t()}(this,function(){function e(e,i){"use strict";function s(){w=C.children,x=w.length,w.length<2&&(i.continuous=!1),y.transitions&&i.continuous&&w.length<3&&(C.appendChild(w[0].cloneNode(!0)),C.appendChild(C.children[1].cloneNode(!0)),w=C.children),k=new Array(w.length),_=e.getBoundingClientRect().width||e.offsetWidth,C.style.width=w.length*_*2+"px";for(var t=w.length;t--;){var n=w[t];n.style.width=_+"px",n.setAttribute("data-index",t),y.transitions&&(n.style.left=t*-_+"px",u(t,F>t?-_:F<t?_:0,0))}i.continuous&&y.transitions&&(u(a(F-1),-_,0),u(a(F+1),_,0)),y.transitions||(C.style.left=F*-_+"px"),e.style.visibility="visible"}function r(){i.continuous?c(F-1):F&&c(F-1)}function o(){i.continuous?c(F+1):F<w.length-1&&c(F+1)}function a(e){return(w.length+e%w.length)%w.length}function l(){var e=F;return e>=x&&(e-=x),e}function c(e,t){if(e="number"!=typeof e?parseInt(e,10):e,F!==e){if(y.transitions){var n=Math.abs(F-e)/(F-e);if(i.continuous){var s=n;n=-k[a(e)]/_,n!==s&&(e=-n*w.length+e)}for(var r=Math.abs(F-e)-1;r--;)u(a((e>F?e:F)-r-1),_*n,0);e=a(e),u(F,_*n,t||S),u(e,0,t||S),i.continuous&&u(a(e-n),-(_*n),0)}else e=a(e),h(F*-_,e*-_,t||S);F=e,b(function(){i.callback&&i.callback(l(),w[F])})}}function u(e,t,n){d(e,t,n),k[e]=t}function d(e,t,n){var i=w[e],s=i&&i.style;s&&(s.webkitTransitionDuration=s.MozTransitionDuration=s.msTransitionDuration=s.OTransitionDuration=s.transitionDuration=n+"ms",s.webkitTransform="translate("+t+"px,0)translateZ(0)",s.msTransform=s.MozTransform=s.OTransform="translateX("+t+"px)")}function h(e,t,n){if(!n)return void(C.style.left=t+"px");var s=+new Date,r=setInterval(function(){var o=+new Date-s;return o>n?(C.style.left=t+"px",D&&f(),i.transitionEnd&&i.transitionEnd.call(event,l(),w[F]),void clearInterval(r)):void(C.style.left=(t-e)*(Math.floor(o/n*100)/100)+e+"px")},4)}function f(){T=setTimeout(o,D)}function p(){D=0,clearTimeout(T)}function m(){p(),D=i.auto||0,f()}function g(e){return/^mouse/.test(e.type)}var v=function(){},b=function(e){setTimeout(e||v,0)},y={addEventListener:!!t.addEventListener,touch:"ontouchstart"in t||t.DocumentTouch&&n instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(void 0!==e.style[t[n]])return!0;return!1}(n.createElement("swipe"))};if(e){var w,k,_,x,C=e.children[0];i=i||{};var F=parseInt(i.startSlide,10)||0,S=i.speed||300;i.continuous=void 0===i.continuous||i.continuous,i.autoRestart=void 0!==i.autoRestart&&i.autoRestart;var T,E,D=i.auto||0,M={},A={},$={handleEvent:function(e){switch(e.type){case"mousedown":case"touchstart":this.start(e);break;case"mousemove":case"touchmove":this.move(e);break;case"mouseup":case"mouseleave":case"touchend":this.end(e);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":this.transitionEnd(e);break;case"resize":b(s)}i.stopPropagation&&e.stopPropagation()},start:function(e){var t;g(e)?(t=e,e.preventDefault()):t=e.touches[0],M={x:t.pageX,y:t.pageY,time:+new Date},E=void 0,A={},g(e)?(C.addEventListener("mousemove",this,!1),C.addEventListener("mouseup",this,!1),C.addEventListener("mouseleave",this,!1)):(C.addEventListener("touchmove",this,!1),C.addEventListener("touchend",this,!1));
},move:function(e){var t;if(g(e))t=e;else{if(e.touches.length>1||e.scale&&1!==e.scale)return;i.disableScroll&&e.preventDefault(),t=e.touches[0]}A={x:t.pageX-M.x,y:t.pageY-M.y},"undefined"==typeof E&&(E=!!(E||Math.abs(A.x)<Math.abs(A.y))),E||(e.preventDefault(),p(),i.continuous?(d(a(F-1),A.x+k[a(F-1)],0),d(F,A.x+k[F],0),d(a(F+1),A.x+k[a(F+1)],0)):(A.x=A.x/(!F&&A.x>0||F===w.length-1&&A.x<0?Math.abs(A.x)/_+1:1),d(F-1,A.x+k[F-1],0),d(F,A.x+k[F],0),d(F+1,A.x+k[F+1],0)))},end:function(e){var t=+new Date-M.time,n=Number(t)<250&&Math.abs(A.x)>20||Math.abs(A.x)>_/2,s=!F&&A.x>0||F===w.length-1&&A.x<0;i.continuous&&(s=!1);var r=A.x<0;E||(n&&!s?(r?(i.continuous?(u(a(F-1),-_,0),u(a(F+2),_,0)):u(F-1,-_,0),u(F,k[F]-_,S),u(a(F+1),k[a(F+1)]-_,S),F=a(F+1)):(i.continuous?(u(a(F+1),_,0),u(a(F-2),-_,0)):u(F+1,_,0),u(F,k[F]+_,S),u(a(F-1),k[a(F-1)]+_,S),F=a(F-1)),i.callback&&i.callback(l(),w[F])):i.continuous?(u(a(F-1),-_,S),u(F,0,S),u(a(F+1),_,S)):(u(F-1,-_,S),u(F,0,S),u(F+1,_,S))),g(e)?(C.removeEventListener("mousemove",$,!1),C.removeEventListener("mouseup",$,!1),C.removeEventListener("mouseleave",$,!1)):(C.removeEventListener("touchmove",$,!1),C.removeEventListener("touchend",$,!1))},transitionEnd:function(e){parseInt(e.target.getAttribute("data-index"),10)===F&&((D||i.autoRestart)&&m(),i.transitionEnd&&i.transitionEnd.call(e,l(),w[F]))}};return s(),D&&f(),y.addEventListener?(y.touch&&C.addEventListener("touchstart",$,!1),i.draggable&&C.addEventListener("mousedown",$,!1),y.transitions&&(C.addEventListener("webkitTransitionEnd",$,!1),C.addEventListener("msTransitionEnd",$,!1),C.addEventListener("oTransitionEnd",$,!1),C.addEventListener("otransitionend",$,!1),C.addEventListener("transitionend",$,!1)),t.addEventListener("resize",$,!1)):t.onresize=function(){s()},{setup:function(){s()},slide:function(e,t){p(),c(e,t)},prev:function(){p(),r()},next:function(){p(),o()},restart:function(){m()},stop:function(){p()},getPos:function(){return l()},getNumSlides:function(){return x},kill:function(){p(),C.style.width="",C.style.left="";for(var e=w.length;e--;){var n=w[e];n.style.width="",n.style.left="",y.transitions&&d(e,0,0)}y.addEventListener?(C.removeEventListener("touchstart",$,!1),C.removeEventListener("mousedown",$,!1),C.removeEventListener("webkitTransitionEnd",$,!1),C.removeEventListener("msTransitionEnd",$,!1),C.removeEventListener("oTransitionEnd",$,!1),C.removeEventListener("otransitionend",$,!1),C.removeEventListener("transitionend",$,!1),t.removeEventListener("resize",$,!1)):t.onresize=null}}}}var t=this,n=t.document;return(t.jQuery||t.Zepto)&&!function(t){t.fn.Swipe=function(n){return this.each(function(){t(this).data("Swipe",new e(t(this)[0],n))})}}(t.jQuery||t.Zepto),e}),define("shared/modals/free_goods",["require","exports","module","jquery","underscore","shared/cookies","shared/models/session","event_bus","adamantium/view","shared/views/facebook_connect_button","shared/plugins/modal","swipe"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("shared/cookies"),o=e("shared/models/session"),a=e("event_bus"),l=e("adamantium/view"),c=e("shared/views/facebook_connect_button");e("shared/plugins/modal"),e("swipe");return l.extend({Swipe:null,events:{"click .sign-up-continue a":"onClickContinue"},initialize:function(){this.model=o,this.facebookButton=new c({model:o,label:"Continue &rarr;"}),a.on("session:create",this.hide,this)},render:function(){this.$(".btn-facebook").replaceWith(this.facebookButton.render().el),this.$("[data-lazy]").laterload(),window.welcomeModalButtonText&&this.$(".sign-up-continue a").html(window.welcomeModalButtonText),window.welcomeModalHeaderText&&this.$(".modal-header h2:visible").html(window.welcomeModalHeaderText)},show:function(){if(!window.no_welcome_modal){var e="Entry";if(window.location.href.indexOf("/dribbble-bundle")>=1)this.remove();else{var t={tracking:{Type:"Welcome",Trigger:e},disableBackdropClick:!0};this.render(),this.$el.modal(t),this.$el.on("hide",s.bind(this.onHide,this)),a.trigger("discount-welcome-modal:show")}}},hide:function(){this.$el.modal("hide")},onHide:function(){this.remove(),r.set("wm","1",86400),a.trigger("discount-welcome-modal:hide")},onClickContinue:function(e){window.freegoods_redir&&(e.preventDefault(),i(e.currentTarget).removeAttr("data-modal"),r.set("wm","1",86400),window.location.href=window.freegoods_su?"/free-goods?su=1":"/free-goods")}})}),define("text!shared/templates/message_modal.tmpl",[],function(){return'<span class="close-btn" data-dismiss="modal"></span>\n\n<div class="send-message">\n\t<h2 style="color: #2b2927;"><%= title %></h2>\n\n\t<div class="wrapper">\n\t\t<form action="/ajax/add/message" method="post">\n\t\t\t<input type="text" name="username" <% if (readOnly) { %> readonly<% } %> value="<%= recipientUsername %>" placeholder="Name" maxlength="<%= userNameMaxLength %>">\n\t\t\t<div class="username-container"></div>\n\t\t\t<input type="text" name="subject" value="<%= subject %>" placeholder="Subject" maxlength="<%= subjectMaxLength %>">\n\t\t\t<textarea name="message-note-body" rows="1" cols="1" placeholder="Message"></textarea>\n\t\t\t<button class="btn" type="submit">Send Message</button>\n\t\t</form>\n\t</div>\n</div>\n\n<div class="success" style="display: none;">\n\t<h2 style="color: #2b2927;"><%= sentTitle %></h2>\n\n\t<div class="wrapper">Your message has been sent to <span class="username"><%= recipientUsername %></span>. <span class="view-message"></span></div>\n</div>'}),define("shared/modals/message",["require","exports","module","jquery","underscore","adamantium/view","globals","text!shared/templates/message_modal.tmpl","shared/util","vendor/jquery/tipsy","shared/models/session","shared/plugins/modal","shared/plugins/mentions"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("adamantium/view"),o=e("globals"),a=e("text!shared/templates/message_modal.tmpl"),l=e("shared/util"),c=(e("vendor/jquery/tipsy"),e("shared/models/session")),u=(e("shared/plugins/modal"),e("shared/plugins/mentions")),d=r.extend({id:"modal-send-message",className:"modal",events:{"click .tag .close":"onTagClick","submit form":"onSubmitMessage"},template:s.template(a),modal:null,$tipsy:null,render:function(e){return this.options=s.extend({},this.options,e),this.html(this.template({title:this.options.title||"Send a Private Message",sentTitle:this.options.sentTitle||"Private Message Sent!",subject:this.options.subject||"",readOnly:!!this.options.readOnly,recipientUsername:this.options.recipientUsername,userNameMaxLength:c.USERNAME_MAX_LENGTH,subjectMaxLength:128})),this._initTipsy('input[name="username"], input[name="subject"], input[name="message-note-body"], button.btn'),this.options.readOnly||this._initAutoComplete(),this},_initTipsy:function(e){this.$tipsy=this.$(e),this.$tipsy.tipsy({trigger:"manual",gravity:"w",offset:10,fade:!0,html:!0})},_initAutoComplete:function(){var e=this,t=i("body");t.on("autocompleteopen",".ui-autocomplete-input",function(){var e=i(this).data("ui-autocomplete"),t=e.menu;t.element.children().first().addClass("active"),t.option("active",1)}),t.on("hover.autocomplete.message",".ui-autocomplete .ui-menu-item",function(){e.$(".ui-menu-item").removeClass("active")}),u.fetchFollowing(s.bind(function(t){var n=[];i.each(t,function(e,t){var i=t.name;t.name!==t.username&&(i=t.name+" ("+t.username+")"),n.push({id:t.id,name:t.name,username:t.username,avatar:t.avatar,value:t.username,label:i})}),e.$field("username").autocomplete({minLength:1,source:function(e,t){var s=i.ui.autocomplete.filter(n,e.term);t(s.slice(0,10))},focus:function(e,t){return!1},select:function(t,n){return e.$field("username").hide().val(n.item.username),e.$(".username-container").html('<div class="tag">'+n.item.label+'<a href="#" class="close">×</a></div>').show(),!1}}).data("ui-autocomplete")._renderItem=function(e,t){return i("<li>").data("ui-autocomplete-item",t).append('<img src="'+t.avatar+'"><a>'+t.label+"</a>").appendTo(e)}},this))},reset:function(){this.$field("message-note-body").val(""),this.disableSubmitButton(!1),this.$(".send-message").show(),this.$(".success").hide()},show:function(e){var t=this;c.authenticate(!1,!1,"Message").then(function(){t.render(e),t.$el.modal({tracking:{Type:"New Private Message",Module:e.title}}),t.$el.removeClass("success")})},hideTipsy:function(){this.$tipsy.tipsy("hide")},disableSubmitButton:function(e){var t=this.$("button.btn");t.prop("disabled",e).toggleClass("disabled",e)},onTagClick:function(e){e.preventDefault(),this.$(".username-container").hide().html(""),this.$field("username").val("").show().focus()},onSubmitMessage:function(e){e.preventDefault();var t=i(e.target),n=t.serialize();this.hideTipsy();var s=i.trim(this.$field("username").val()),r=i.trim(this.$field("subject").val()),o=i.trim(this.$field("message-note-body").val());return""===s?void l.showThenHideTipsy(this.$field("username"),"Please enter a username"):""===r?void l.showThenHideTipsy(this.$field("subject"),"Please enter a subject"):""===o?void l.showThenHideTipsy(this.$field("message-note-body"),"Please enter a message"):(this.disableSubmitButton(!0),void this.sendRequest(t.attr("action"),n))},sendRequest:function(e,t){i.post(e,t).then(s.bind(function(e){return"object"!=typeof e?this.throwError():void this.onSuccess(e)},this),s.bind(function(e){var t=JSON.parse(e.responseText);t.error?this.onError(t.error):this.throwError()},this))},throwError:function(){l.showThenHideTipsy(this.$("button.btn"),"Unknown Error"),this.disableSubmitButton(!1)},onSuccess:function(e){analytics.track("Messaged",{"Recipient Username":e.userName}),this.$(".success .wrapper span.username").html(e.userName),this.$(".success .wrapper span.view-message").html('<a href="/account/messages/'+e.messageID+'">View Message <span class="rarr">&rarr;</span></a>'),this.$el.addClass("success"),o.sendToMessage&&(window.location.href="/account/messages/"+e.messageID),this.$field("subject").val(""),this.$(".username-container").hide().html("a"),this.$field("username").show(),this.$(".send-message").hide(),this.$(".success").show(),this.hideTipsy(),this.$el.modal("hide",{delay:5e3}),i("body").off("autocompleteopen",".ui-autocomplete-input").off("hover.autocomplete.message")},onError:function(e){l.showThenHideTipsy(this.$("button.btn"),e.message),this.disableSubmitButton(!1)},$field:function(e){return this.$('form [name="'+e+'"]')}}),h=new d,f=t.showPrivateFeedbackModal=function(e){h.show({recipientUsername:e.recipientUsername,title:"Send Private Feedback",sentTitle:"Private Feedback Sent!",readOnly:!0,subject:"Feedback on "+s.escape(e.title)})};i(function(){i(document).on("click",'[data-modal="message"]',function(e){e.preventDefault(),h.show({readOnly:i(this).data("read-only"),recipientUsername:i(this).data("recipient-username")})}),i(document).on("click",'[data-modal="private-feedback"]',function(e){e.preventDefault(),f({recipientUsername:i(this).data("recipient-username"),title:i(this).data("subject")})})})}),define("shared/plugins/later_load",["require","exports","module","jquery","underscore","shared/feature_switch"],function(e,t,n){var i=e("jquery"),s=e("underscore");e("shared/feature_switch");i(function(){i.fn.laterload=function(e,t){var n,r=this,o={buffer:600,loadInvisible:!1};if(s.extend(o,e),r.length){r.one("setup_image",function(){var e=this;i(this);if(!e.hasAttribute("data-loaded")){var t,n=e.getAttribute("data-src")||"",s=e.getAttribute("data-src-retina"),r=s&&window.cmhasRetinaSupport,o=r?s:n,a=e.className+(r?" retina":"");t=new Image,t.className=a,t.alt=e.getAttribute("data-alt")||"",t.onerror=function(){i(this).trigger("failure")},t.src=o,e.appendChild(t),e.setAttribute("data-loaded",""),e.removeAttribute("data-lazy")}});var a=function(){var e=r.filter(function(){var e=i(this);if(o.loadInvisible||e.is(":visible")&&!e.is(":hidden")){var t=i(window).scrollTop(),n=t+i(window).height(),s=e.offset().top;s+e.height();return(o.loadInvisible||0!==e.css("opacity"))&&n>=t-o.buffer&&s<=n+o.buffer}});n=e.trigger("setup_image"),r=r.not(n)};return i(window).on("scroll",s.debounce(a,100)),i(window).on("resize",a),a(),this}}})}),define("shared/plugins/sliders",["require","exports","module","jquery"],function(e,t,n){var i=e("jquery");i(function(){i.fn.sliders=function(e,t){return 0===this.length?this:(this.each(function(){var e=i(this),t=null,n=null,s=e.find("li"),r=s.first().width();r/(e.children().length-1);s.on("failure","img",function(){i(this).closest("li").remove(),s=e.find("li")});var o=function(e){s.removeClass("active"),i(s[e]).addClass("active"),i("[data-lazy]",s).laterload({loadInvisible:!0})},a=function(){slide>=s.length&&(slide=0),o(slide),++slide},l=function(){n=setTimeout(function(){a(),t=setInterval(function(){a()},1300)},650)};e.on("mouseenter",function(e){slide=1,l()}),e.on("mouseout",function(e){clearTimeout(n),clearInterval(t),o(0)})}),void(t&&t()))}})}),define("shared/tracking_helper",["require","exports","module","underscore"],function(e,t,n){var i=(e("underscore"),["3D","3d","Add-Ons","Fonts","Graphics","Photos","Templates","Themes"]);t.hasSubcategory=function(e){if(0==/^[a-zA-Z0-9- ]*$/.test(e))return!0},t.formatTracking=function(e){return e.toLowerCase().split(" ").map(function(e){return e[0].toUpperCase+e.subString(1)}).join(" ").replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"")},t.getCategory=function(e){0==e.indexOf("/")&&(e=e.replace("/",""));var t=e.split("/")[0];return t=t.charAt(0).toUpperCase()+t.slice(1)},t.getSubcategory=function(e,t){0==t.indexOf("/")&&(t=t.replace("/",""));var n=t.substring(t.indexOf("/")+1),s=n.replace(/(^|\/|-)(\S)/g,function(e){return e.toUpperCase()});return s=s.replace(/\//g," - "),s=""!=e?s+" - "+e:s,i.indexOf(s)>-1&&(s="All"),s},t.getClickedValue=function(e){var t=e.split("/").pop();return t.charAt(0).toUpperCase()+t.slice(1)}}),define("shared/plugins/share",["require","exports","module","jquery","globals","event_bus","shared/tracking_helper"],function(e,t){var n=e("jquery"),i=e("globals"),s=e("event_bus"),r=e("shared/tracking_helper"),o={shareWindow:null,initialize:function(){this.attachEvents(),this.attachShortURL()},attachEvents:function(){var e=this;n("body").on("click","a[data-share]",function(t){return e.preShare(n(this)),!1}),n("body").on("click","input[data-short-url]",function(e){var t=n(this),s=n(e.currentTarget),o={"Share Asset Type":t.data("asset-type")||i.page_type_text,Channel:"Link",Title:t.data("title")?t.data("title"):document.title,"Share Asset URL":t.data("url")||window.location.href,"Share Text":"",Module:t.closest("[data-module]").data("module")};if(i.tracking_category){var a=s.closest("li").data("directory")||n('input[name="category-directory"]').val();o.Category=r.getCategory(a),o["Sub-Category"]=r.getSubcategory("",a)}t.select(),analytics.track("Shared",o)})},attachShortURL:function(e){var t=this;n("[data-share]",e).each(function(){var e=n(this),i=e.data("share");"twitter"===i&&t.loadShortURL(n(this))}),n("[data-short-url]",e).each(function(){var e=n(this);e.val()||e.val(window.location.href),n.when(t.loadShortURL(e)).done(function(t){null!==t&&e.val(t)})})},loadShortURL:function(e){var t=e.data("url")?e.data("url"):window.location.href+"?",i=e.data("title")?e.data("title"):document.title,s="twitter"===e.data("share")?"Twitter":"Link",r=n.Deferred();return e.data("short-url")?r.resolve(e.data("short-url")||t):(n.ajax({type:"POST",url:"/ajax/short-url",data:{url:t,source:s,medium:this.getMedium(),campaign:this.getCampaign(),content:i},success:function(n){"error"===n.status?r.resolve(t):(e.data("short-url",n.short_url),r.resolve(n.short_url))},dataType:"json"}),r.promise())},share:function(e){var t,n,r,a=e.data("share"),l=e.data("url")?e.data("url"):window.location.href,c=280,u=650,d=e.data("title")?e.data("title"):document.title,h=!!e.data("short-url")&&e.data("short-url"),f="",p=e.parents("[data-module]:first").data("module"),m=e.data("asset-type")||i.page_type_text,g=(new Date).getTime().toString();switch(a){case"facebook":n="Facebook",t="https://www.facebook.com/sharer.php?u=";break;case"pinterest":n="Pinterest",c=350,u=670,t="https://www.pinterest.com/pin/create/button/?",t+="media="+encodeURIComponent(e.data("media")),t+="&description="+encodeURIComponent(e.data("description")),t+="&url=";break;case"twitter":n="Twitter",c=252,u=500,t="https://twitter.com/share?",t+="&text="+encodeURIComponent(e.data("description")),t+="&url=",f=e.data("description");break;case"google-plus":n="Google Plus",t="https://plus.google.com/share?url="}if(!e.data("skip-utm")){var v=this.getCampaign(),b=n,y=this.getMedium(),w=d.replace(/\/\s*/g,"");l+="?utm_source="+b,l+="&utm_medium="+y,l+="&utm_campaign="+v,l+="&utm_content="+w,l+="&ts="+g}r=h?t+h:t+encodeURIComponent(l),this.shareWindow=popup({w:u,h:c,u:r});var k=setInterval(function(){o.shareWindow.opener||(clearInterval(k),s.trigger("shareWindow:closed",a,e))},500),_={"Share Asset Type":m,Channel:n,Module:p,"Share Asset URL":l,Title:d,"Share Text":f};return i.tracking_category&&(_.Category=i.tracking_category.Category,_.Subcategory=i.tracking_category.Subcategory),m.toLowerCase().indexOf("blog")>=0&&(_.Title=d+" ~ Creative Market Blog"),analytics.track("Shared",_),!1},preShare:function(e){var t=this,i=e.data("share");return"twitter"!==i?void this.share(e):void n.when(this.loadShortURL(e)).done(function(n){t.share(e)})},getCampaign:function(){return i.page_type_text+" Social Share"},getMedium:function(){return"CM Social Share"}};return o}),define("members/views/user_card",["require","vendor/jquery/tipsy","jquery","adamantium/view"],function(e){var t=(e("vendor/jquery/tipsy"),e("jquery")),n=e("adamantium/view"),i=n.extend({serverView:"card",serverTemplate:"members",templateLoaderUrl:"/members/card",initialize:function(){this.model=this.getViewOptions(),this.on("reload",this.onReload,this)},load:function(e){return this.deferred=t.Deferred(),this.model.set({userID:e}),this.deferred.promise()},onReload:function(){this.deferred.resolve(this.$el)}});return i}),define("shared/plugins/user_card",["require","exports","module","jquery","vendor/jquery/tipsy","members/views/user_card"],function(e,t){var n=e("jquery"),i=(e("vendor/jquery/tipsy"),e("members/views/user_card")),s={initialize:function(){this.attachEvents()},attachEvents:function(){var e=this;this.tipsyTimeout=!1,this.currentTarget=!1,n(document).on("mouseenter","[data-user-card]",function(t){var i=n(this);e.attachTipsy(i),e.hover(t)}),n(document).on("mouseleave","[data-user-card]",function(t){var i=n(this);e.attachTipsy(i),e.blur(t)})},attachTipsy:function(e){e.tipsy({html:!0,trigger:"manual",offset:-7,className:"user-card-tipsy",title:function(){var e=n(this).data("user-card");return n("#user-card-"+e).html()}})},hover:function(e){var t=n(e.currentTarget),i=t.data("user-card");this.currentTarget=t,n("#user-card-"+i).length>0?this.startTimeout(t):this.loadCard(t)},blur:function(e){return this.currentTarget=!1,clearTimeout(this.tipsyTimeout),!(n(e.relatedTarget).closest(".tipsy").length>0)&&void n(e.currentTarget).tipsy("hide")},loadCard:function(e){var t=new i,s=e.data("user-card"),r=this;n.when(t.load(s)).done(function(t){e.parent().append(t),r.currentTarget===e&&r.showTipsy(e)})},startTimeout:function(e){var t=this;n("[data-user-card]").tipsy("hide"),clearTimeout(this.tipsyTimeout),this.tipsyTimeout=setTimeout(function(){t.showTipsy(e)},500)},showTipsy:function(e){e.tipsy("show"),n(".tipsy").on("mouseleave",function(e){n(this).hide()}).find("[data-lazy]").laterload(),window.cmPictureFill()}};return s}),define("shared/views/notice",["require","adamantium/view","shared/cookies"],function(e){var t=e("adamantium/view"),n=e("shared/cookies"),i=t.extend({events:{"click .dismiss":"onDismiss"},onDismiss:function(){var e=this,t=this.$el.attr("data-dismiss");t&&n.set("cmnot"+t,"1",432e3),e.$el.fadeOut(400,function(){e.remove()})}},{autoInit:function(){$(".notice-msg").each(function(){new i({el:this})})}});return i}),function(e){"function"==typeof define&&define.amd?define("vendor/backbone/backbone.stickit",["underscore","backbone","exports"],e):"object"==typeof exports?e(require("underscore"),require("backbone"),exports):e(_,Backbone,{})}(function(e,t,n){n._handlers=[],n.addHandler=function(t){t=e.map(e.flatten([t]),function(t){return e.extend({updateModel:!0,updateView:!0,updateMethod:"text"},t)}),this._handlers=this._handlers.concat(t)},n.ViewMixin={_modelBindings:null,unstickit:function(t,n){if(e.isObject(n))return void e.each(e.keys(n),function(e){this.unstickit(t,e)},this);var i=[],s=[];e.each(this._modelBindings,function(e,r){t&&e.model!==t||n&&e.config.selector!=n||(s.push(e.config._destroy),e.model.off(e.event,e.fn),i.push(e.model),delete this._modelBindings[r])},this),e.invoke(e.uniq(i),"trigger","stickit:unstuck",this.cid),e.each(e.uniq(s),function(e){e.call(this)},this),this._modelBindings=e.compact(this._modelBindings),this.$el.off(".stickit"+(t?"."+t.cid:""),n)},stickit:function(t,n){var i=t||this.model,s=n||e.result(this,"bindings")||{};this._modelBindings||(this._modelBindings=[]),this.addBinding(i,s);var r=this.remove;r.stickitWrapped||(this.remove=function(){var e=this;return this.unstickit(),r&&(e=r.apply(this,arguments)),e}),this.remove.stickitWrapped=!0},addBinding:function(t,n,i){var r,p,m,g,v,b=t||this.model,y=".stickit."+b.cid,w=i||{},k=e.uniqueId();if(!e.isString(n)){var _=n;return void e.each(_,function(e,t){this.addBinding(b,t,_[t])},this)}v=n,r=":el"===v?this.$el:this.$(v),this.unstickit(b,v),r.length&&(e.isString(w)&&(w={observe:w}),e.isFunction(w.observe)&&(w.observe=w.observe.call(this)),g=u(r,w),g.selector=v,m=g.observe,g.bindId=k,g.view=this,p=e.extend({stickitChange:g},g.setOptions),g._destroy=function(){s(this,g.destroy,r,b,g)},d(this,r,g,b,m),h(this,r,g,b,m),m&&(e.each(g.events,function(t){var n=t+y,i=function(t){var n=g.getVal.call(this,r,t,g,e.rest(arguments));o(this,g.updateModel,n,t,g)&&l(b,m,n,p,this,g)};i=e.bind(i,this),":el"===v?this.$el.on(n,i):this.$el.on(n,v,i)},this),e.each(e.flatten([m]),function(e){a(b,this,"change:"+e,g,function(e,t,n){var i=n&&n.stickitChange&&n.stickitChange.bindId||null;i!==k&&f(this,r,g,c(e,m,g,this),e)})},this),f(this,r,g,c(b,m,g,this),b,!0)),s(this,g.initialize,r,b,g))}},e.extend(t.View.prototype,n.ViewMixin);var i=function(t,n){var i=(n||"").split("."),s=e.reduce(i,function(e,t){return e[t]},t);return null==s?t:s},s=function(t,n){if(n)return(e.isString(n)?i(t,n):n).apply(t,e.rest(arguments,2))},r=function(e){return e.find("option").not(function(){return!this.selected})},o=function(t,n){return e.isBoolean(n)?n:!(!e.isFunction(n)&&!e.isString(n))&&s.apply(this,arguments)},a=function(e,t,n,i,s){e.on(n,s,t),t._modelBindings.push({model:e,event:n,fn:s,config:i})},l=function(t,n,i,r,o,a){var l={};a.onSet&&(i=s(o,a.onSet,i,a)),a.set?s(o,a.set,n,i,r,a):(l[n]=i,e.isArray(n)&&e.isArray(i)&&(l=e.reduce(n,function(t,n,s){return t[n]=e.has(i,s)?i[s]:null,t},{})),t.set(l,r))},c=function(t,n,i,r){var o,a=function(e){return t[i.escape?"escape":"get"](e)},l=function(e){return null==e?"":e};return o=e.isArray(n)?e.map(n,a):a(n),i.onGet&&(o=s(r,i.onGet,o,i)),e.isArray(o)?e.map(o,l):l(o)},u=n.getConfiguration=function(t,i){var s=[{updateModel:!1,updateMethod:"text",update:function(e,t,n,i){e[i.updateMethod]&&e[i.updateMethod](t)},getVal:function(e,t,n){return e[n.updateMethod]()}}];s=s.concat(e.filter(n._handlers,function(e){return t.is(e.selector)})),s.push(i);var r=e.extend.apply(e,s);return r.visible&&!e.has(r,"updateView")?r.updateView=!1:e.has(r,"updateView")||(r.updateView=!0),r},d=function(t,n,i,s,r){var o=["autofocus","autoplay","async","checked","controls","defer","disabled","hidden","indeterminate","loop","multiple","open","readonly","required","scoped","selected"];e.each(i.attributes||[],function(l){var u,d,h="";l=e.clone(l),u=l.observe||(l.observe=r),d=function(){var i=e.indexOf(o,l.name,!0)>-1?"prop":"attr",r=c(s,u,l,t);"class"===l.name?(n.removeClass(h).addClass(r),h=r):n[i](l.name,r)},e.each(e.flatten([u]),function(e){a(s,t,"change:"+e,i,d)}),d()})},h=function(t,n,i,r,o){if(null!=i.visible){var l=function(){var a=i.visible,l=i.visibleFn,u=c(r,o,i,t),d=!!u;(e.isFunction(a)||e.isString(a))&&(d=!!s(t,a,u,i)),l?s(t,l,n,d,i):n.toggle(d)};e.each(e.flatten([o]),function(e){a(r,t,"change:"+e,i,l)}),l()}},f=function(e,t,n,i,r,a){o(e,n.updateView,i,n)&&(s(e,n.update,t,i,r,n),a||s(e,n.afterUpdate,t,i,n))};return n.addHandler([{selector:'[contenteditable="true"]',updateMethod:"html",events:["input","change"]},{selector:"input",events:["propertychange","input","change"],update:function(e,t){e.val(t)},getVal:function(e){return e.val()}},{selector:"textarea",events:["propertychange","input","change"],update:function(e,t){e.val(t)},getVal:function(e){return e.val()}},{selector:'input[type="radio"]',events:["change"],update:function(e,t){e.filter('[value="'+t+'"]').prop("checked",!0)},getVal:function(e){return e.filter(":checked").val()}},{selector:'input[type="checkbox"]',events:["change"],update:function(n,i,s,r){if(n.length>1)i||(i=[]),n.each(function(n,s){var r=t.$(s),o=e.indexOf(i,r.val())>-1;r.prop("checked",o)});else{var o=e.isBoolean(i)?i:i===n.val();n.prop("checked",o)}},getVal:function(n){var i;if(n.length>1)i=e.reduce(n,function(e,n){var i=t.$(n);return i.prop("checked")&&e.push(i.val()),e},[]);else{i=n.prop("checked");var s=n.val();"on"!==s&&null!=s&&(i=i?n.val():null)}return i}},{selector:"select",events:["change"],update:function(n,r,o,a){var l,c=a.selectOptions,u=c&&c.collection||void 0,d=n.prop("multiple");if(!c){c={};var h=function(e){return e.map(function(){return{value:this.value,label:this.text}}).get()};n.find("optgroup").length?(u={opt_labels:[]},n.find("> option").length&&(u.opt_labels.push(void 0),e.each(n.find("> option"),function(e){u[void 0]=h(t.$(e))})),e.each(n.find("optgroup"),function(e){var n=t.$(e).attr("label");u.opt_labels.push(n),u[n]=h(t.$(e).find("option"))})):u=h(n.find("option"))}c.valuePath=c.valuePath||"value",c.labelPath=c.labelPath||"label";var f=function(n,s,r){e.each(n,function(n){var o=t.$("<option/>"),a=n,l=function(t,n){o.text(t),a=n,o.data("stickit_bind_val",a),e.isArray(a)||e.isObject(a)||o.val(a)};"__default__"===n?l(c.defaultOption.label,c.defaultOption.value):l(i(n,c.labelPath),i(n,c.valuePath)),!d&&null!=a&&null!=r&&a===r||e.isObject(r)&&e.isEqual(a,r)?o.prop("selected",!0):d&&e.isArray(r)&&e.each(r,function(t){e.isObject(t)&&(t=i(t,c.valuePath)),(t===a||e.isObject(t)&&e.isEqual(a,t))&&o.prop("selected",!0)}),s.append(o)})};n.find("*").remove();var p=function(e,t){var n=window;return 0===t.indexOf("this.")&&(n=e),t=t.replace(/^[a-z]*\.(.+)$/,"$1"),i(n,t)};if(l=e.isString(u)?p(this,u):e.isFunction(u)?s(this,u,n,a):u,l instanceof t.Collection&&(l=l.toJSON()),c.defaultOption&&f(["__default__"],n),e.isArray(l))f(l,n,r);else if(l.opt_labels)e.each(l.opt_labels,function(e){var i=t.$("<optgroup/>").attr("label",e);f(l[e],i,r),n.append(i)});else{var m,g=[];for(var v in l)m={},m[c.valuePath]=v,m[c.labelPath]=l[v],g.push(m);f(e.sortBy(g,c.comparator||c.labelPath),n,r)}},getVal:function(e){var n;return n=e.prop("multiple")?t.$(r(e).map(function(){return t.$(this).data("stickit_bind_val")})).get():r(e).data("stickit_bind_val")}}]),t.Stickit=n,t.Stickit}),define("shared/views/link_builder",["require","exports","module","jquery","backbone","vendor/backbone/backbone.stickit","event_bus"],function(e,t,n){var i=e("jquery"),s=e("backbone"),r=(e("vendor/backbone/backbone.stickit"),e("event_bus")),o=s.Model.extend({valid_campaigns:["blog_","product_","freegood_","outsidesource_","other_"],valid_sources:["CMtwitter","CMfacebook","CMgoogle","CMblog","CMlinkedin","CMpinterest","CMtumblr","CMinstagram","CMdribbble"],defaults:{short_url:"",url:"",source:"",campaign:"",source_value:""},validate:function(e,t){return _.contains(this.valid_campaigns,e.campaign)?""==e.url?"Invalid url":_.contains(this.valid_sources,e.source)?void 0:"Invalid source":"Invalid campaign"},getContextID:function(){var e=this.get("campaign"),t=document.createElement("a");t.href=this.get("url").replace(/\/+$/,"");var n=t.pathname.split("/");if(delete t,"blog_"===e){if(!_.isUndefined(n[5]))return n[5]}else if(_.contains(["product_","freegood_"],e)){if(!_.isUndefined(n[2])){var i=n[2],s=i.match(/^(\d+-).*/);return i.replace(s[1],"")}}else if(_.contains(["outsidesource_","other_"],e))return this.get("source_value");return""},getMedium:function(){return"CMtwitter"===this.get("source")?"tweet":"post"},getURL:function(){var e=this.getContextID()||"";return composed_url=this.get("url")+"?"+["utm_source="+this.get("source"),"utm_medium="+this.getMedium(),"utm_campaign="+this.get("campaign")+e].join("&")},getShortURL:function(){var e=this;i.ajax({url:"/admin/ajax/link-builder",type:"GET",dataType:"text",data:{url:this.getURL()},success:function(t){e.set("short_url",t)}})}}),a=s.View.extend({events:{"click input":"handleFocus"},template:_.template('<p><strong><%= title %></strong><br><input type="text" value="<%= short_url %>" /></p>'),initialize:function(e){this.options=_.extend({},e),r.on("clear:links",function(e){this.remove()},this),this.model.on("change:short_url",this.render,this),this.model.getShortURL()},render:function(){return this.$el.html(this.template({short_url:this.model.get("short_url"),url:this.model.getURL(),source:this.model.get("source"),title:this.model.get("title")})),this},handleFocus:function(e){i(e.target).select()}}),l=s.View.extend({events:{'change [name="utm_campaign"]':"handleCampaignClick",'change [name="source"]':"handleSourceClick",'change [name="source_value"]':"handleSourceClick"},bindings:{'[name="url"]':"url",'[name="utm_campaign"]':"campaign",'[name="source_value"]':"source_value"},initialize:function(){this.model=new o,this.model.on("change:short_url",this.updateURL,this),this.model.set("url",window.location.href),this.model.on("change:url change:campaign",function(){r.trigger("clear:links")},this)},handleCampaignClick:function(e){this.$("#source-value").toggle(_.contains(["outsidesource_","other_"],i(e.target).val())).focus(),this.model.set("campaign",i(e.currentTarget).val()),this.processURLs()},handleSourceClick:function(e){r.trigger("clear:links",i(e.target).val()),this.processURLs()},processURLs:function(){var e=this;this.$('[name="source"]:checked').each(function(t){e.isValid(this)})},isValid:function(e){var t=i(e).val(),n=this.model.clone();return n.set({source:t,source_value:this.$("#source-value input").val(),title:i(e).attr("title")}),n.isValid()?void new a({model:n,source:t}).$el.appendTo(i("#links")):(alert(n.validationError),!1)}});t.init=function(){new l({el:i("#link-builder")})}}),define("shared/likes",["require","underscore","event_bus","apis/facebook","shared/models/session","shared/tracking_helper"],function(e){var t=e("underscore"),n=e("event_bus"),i=e("apis/facebook"),s=e("shared/models/session"),r=e("shared/tracking_helper"),o={};return o.toggle=function(e,o,a,l){var c=o?"like":"unlike",l=l||{};s.authenticate(!1,!1,"Like").then(function(){n.trigger("like:product",e,o),o&&a&&i.isConnected().then(function(){i.like(a+"?fb_ref=cm_facebook_like")});var s=e.directory?e.directory:$('input[name="category-directory"]').val(),u=r.getSubcategory("",s);$.post("/ajax/"+c+"/"+e.id,function(){o&&(t.extend(l,{"Product ID":e.id,"Product Name":e.title,Category:r.getCategory(s),Subcategory:u}),analytics.track("Liked",l))})})},o.fetch=function(e,t){return e&&e.length&&s.isLoggedIn()?void $.ajax({type:"POST",url:"/ajax/fetch-likes",data:{products:e},success:t,error:function(){t([])}}):t([])},o}),define("product/views/base",["require","exports","module","backbone","underscore"],function(e,t,n){var i=e("backbone"),s=e("underscore");return i.View.extend({initialize:function(){this.model&&this.model.on("change",s.bind(this.onModelChange,this))},onModelChange:function(){},assign:function(e,t){t.setElement(e),s.isFunction(t.onAssign)&&t.onAssign(),t.render()}})}),define("text!product/templates/collection/item.tmpl",[],function(){return'<div class="thumbwrap"><div class="crop-area"></div></div>\n<div class="info">\n<% if (isNew) { %>\n\t<div class="input-background"></div>\n\t<i class="icon-pencil-dark"></i>\n\t<h3 class="title input"><%= title %></h3>\n<% } else { %>\n\t<h3 class="title"><%= title %></h3>\n\t<p class="items"></p>\n<% } %>\n</div>';
}),define("text!product/templates/collection/num_items.tmpl",[],function(){return"<%= numItems %> Item<% if (numItems != 1) { %>s<% } %>"}),define("text!product/templates/collection/thumb.tmpl",[],function(){return'<% if (is_wishlist) { %>\n\t<span class="draft-overlay" original-title="Your Wish List is private" title="Your Wish List is private"></span>\n<% } %>\n<% if (thumb && thumb.src_1x){ %>\n\t<span data-src="<%= thumb.src_1x %>" data-picture="img" data-src-retina="<%= thumb.src_2x %>" class="thumbnail">\n\t\t<noscript><img src="<%= thumb.src_1x %>" class="thumbnail"></noscript>\n\t</span>\n<% } else { %>\n\t<span class="faux-img thumbnail"></span>\n<% } %>'}),define("product/views/collection",["require","exports","module","jquery","underscore","product/views/base","shared/tooltip","text!product/templates/collection/item.tmpl","text!product/templates/collection/num_items.tmpl","text!product/templates/collection/thumb.tmpl"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("product/views/base"),o=e("shared/tooltip"),a=e("text!product/templates/collection/item.tmpl"),l=e("text!product/templates/collection/num_items.tmpl"),c=e("text!product/templates/collection/thumb.tmpl");return r.extend({template:s.template(a),numItemsTemplate:s.template(l),thumbTemplate:s.template(c),active:!1,tagName:"li",className:"collection-item",parentView:null,events:{click:"onClick","keydown .input":"onKeyDown","keyup .input":"onKeyUp"},isActive:function(){return this.active},render:function(){this.$el.html(this.template(this.model.toJSON())),this.$title=this.$(".title"),this.$background=this.$(".input-background"),this.$input=this.$(".input"),this.updateView(),this.updateThumb(),this.updateNumItems(),this.$el.find("span.draft-overlay").tipsy({offset:4}),this.$el.on("mouseover","span.draft-overlay",function(){i(this).tipsy("show").addClass("showing-tooltip")}),this.$el.on("mouseout","span.draft-overlay",function(){i(this).tipsy("hide").removeClass("showing-tooltip")})},onModelChange:function(){this.updateView()},getParentView:function(){return this.parentView},getText:function(){return i.trim(this.$input.text())},updatePlaceholder:function(){this.$background.height(this.$input.outerHeight()-5),this.$background.width(this.$input.outerWidth()+17);var e=this.getText();""===e?this.$background.text("Collection Name"):this.$background.text("")},updateThumb:function(){var e={is_wishlist:this.model.get("is_wishlist"),thumb:{src_1x:this.model.getThumb("s"),src_2x:this.model.getThumb("s-r")}};this.$(".crop-area").html(i(this.thumbTemplate(e))),window.cmPictureFill()},updateNumItems:function(){var e=this.model.getNumItems();this.$(".items").text(this.numItemsTemplate({numItems:e}))},updateView:function(){this.$input.scrollTop(0),this.model.get("selected")?this.$el.addClass("selected"):this.$el.removeClass("selected")},endEdit:function(e){var t=this.getText();return""===t?1!==this.collection.length&&(this.clearValidationError(),e||this.destroy(),!1):this.model.collection.validateNewTitle(t,this.model)?(this.clearValidationError(),this.$input.removeClass("active"),this.model.set({title:t}),this.updateView(),this.active=!1,this.blur(),!0):(this.onValidationError(),!1)},onValidationError:function(){var e="Duplicate Title";this.parentView.onError(),this.clearValidationError(),this.focus(),this.model.set({error:!0},{silent:!0}),this.$input.addClass("error"),this.$input.tipsy(s.extend({fallback:e},o.DEFAULT_OPTS)),this.$input.tipsy("show")},clearValidationError:function(){this.model.set({error:!1},{silent:!0}),this.$input.removeClass("error"),this.$input.tipsy("hide")},updateValidationError:function(){this.model.get("error")&&this.$input.tipsy("show")},onKeyDown:function(e){if(13===e.which)return this.endEdit(),e.preventDefault(),!1},onKeyUp:function(e){this.updatePlaceholder()},onClick:function(e){e.preventDefault();var t=this.model.get("isNew"),n=i(e.target);if(t&&n.closest(".title").length)this.focus();else{if(this.parentView.validateActiveViews()===!1)return!1;t&&this.$input.hasClass("active")?this.endEdit(!0):(this.model.toggleSelected(),this.updateThumb(),this.updateNumItems(),this.parentView.onSelect())}return!1},focus:function(e){return(!e||this.parentView.validateActiveViews()!==!1)&&(this.$background.show(),this.active=!0,this.$input.addClass("active"),this.$input.attr("contenteditable",!0),this.$input.text(this.getText()),this.$input.focus(),void document.execCommand("selectAll",!1,null))},blur:function(){this.$input.removeClass("active"),this.$input.blur(),this.$input.attr("contenteditable",!1),this.$input.text(this.getText()),document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.parentView.clearError()},destroy:function(){this.$el.remove(),this.parentView.removeChild(this)}})}),define("product/models/collection",["require","exports","module","backbone","underscore","product/views/collection"],function(e,t,n){var i=e("backbone"),s=e("underscore"),r=e("product/views/collection");return i.Model.extend({view:null,defaults:{cid:null,title:"",numItems:0,thumb:null,thumbs:null,screenshot:null,selected_prev:!1,selected:!1,isNew:!1,is_wishlist:!1,error:!1},initialize:function(){this.on("remove",s.bind(this.onRemove,this))},getView:function(){return this.view||(this.view=new r({model:this,collection:this.collection})),this.view},getNumItems:function(){var e=this.get("numItems");return this.get("selected_prev")===!1&&this.get("selected")?e+1:this.get("selected_prev")&&this.get("selected")===!1?e-1:e},getThumb:function(e){var t,n,i=this.view.getParentView().getThisThumb(),r=this.get("screenshots");return s.isNull(r)&&(r=[]),this.get("isNew")&&!this.get("selected")?null:!1===this.get("selected_prev")&&this.get("selected")&&0===this.get("numItems")?i[e]:this.get("isNew")?i[e]:(t=r[r.length-1],n=r[r.length-2],t?this.get("selected_prev")&&!1===this.get("selected")?1===this.get("numItems")?null:i[e]===t[e]?n[e]:t[e]:this.get("selected_prev")&&this.get("selected")||!1===this.get("selected_prev")&&this.get("selected")?i[e]:t[e]:null)},toggleSelected:function(){var e=this.get("selected");this.set({selected:!e})},onRemove:function(){this.view&&this.view.remove()}})}),define("product/collections/collection",["require","exports","module","backbone","underscore","product/models/collection"],function(e,t,n){var i=e("backbone"),s=e("underscore"),r=e("product/models/collection");return i.Collection.extend({thumb:null,model:r,validateNewTitle:function(e,t){var n=this.reject(function(e){return e.cid===t.cid}),i=s.map(n,function(e){return e.get("title")});return s.indexOf(i,e)===-1},getProductID:function(){return this.product.id}})}),define("product/models/view_state",["require","exports","module","backbone"],function(e,t,n){var i=e("backbone");return i.Model.extend({defaults:{loaded:!1,loading:!1,old_state:null}})}),define("text!product/templates/collection/modal.tmpl",[],function(){return'<div class="close-btn"></div>\n<div class="modal-loading-spinner"></div>\n<div class="wrapper">\n\t<h2>Manage Collections</h2>\n\t<div class="collections">\n\t\t<ul class="collections-list"></ul>\n\t</div>\n\t<div class="button-wrapper">\n\t\t<a href="#" class="btn btn-new create-new-collection">+ Create New Collection</a>\n\t\t<a href="#" class="btn add-to-collection">Save to Collection</a>\n\t</div>\n</div>'}),define("product/modals/collection",["require","exports","module","jquery","underscore","globals","shared/models/session","product/collections/collection","product/models/collection","event_bus","shared/loading","adamantium/view","product/models/view_state","shared/plugins/modal","shared/tooltip","text!product/templates/collection/modal.tmpl"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("globals"),o=e("shared/models/session"),a=e("product/collections/collection"),l=e("product/models/collection"),c=e("event_bus"),u=e("shared/loading"),d=e("adamantium/view"),h=e("product/models/view_state"),f=(e("shared/plugins/modal"),e("shared/tooltip")),p=e("text!product/templates/collection/modal.tmpl"),m=d.extend({_cid:0,ajaxEndpoint:"/ajax/collection/",className:"modal",id:"modal-add-to-collection",loading:null,locked:!1,template:s.template(p),this_thumb:null,viewstate:new h,saveBtnText:{none:"Save Collections",single:"Save to Collection",multi:"Save to Collections"},events:{"click .create-new-collection":"createNew","click .add-to-collection":"submit","click .close-btn":"hide",click:"onClick"},initialize:function(e){this.viewstate.on("change",this.updateView,this),this.collection.on("add",this.onAdd,this),this.product=e.product},render:function(){return this.loading=new u(this.$(".modal-loading-spinner"),{size:"large",color:"dark"}),this.loading.show(),this.$button=this.$(".add-to-collection"),this.$list=this.$(".collections-list"),this},updateSubviews:function(){this.collection.map(function(e){e.getView().updateView()})},show:function(){var e=this,t="Collection";o.authenticate(!1,!1,t).then(function(){return o.isLoggedIn()?(e.html(e.template()),e.locked=!1,e.$button=e.$(".add-to-collection"),e.$list=e.$(".collections-list"),e.loading=new u(e.$(".modal-loading-spinner"),{size:"large",color:"dark"}),e.loading.show(),e.viewstate.set({loading:!0}),e.loadCollections(),e.$el.modal({tracking:{Type:"Add to Collection",Method:t}}),e.$el.on("hide",s.bind(e.onHide,e)),e.$el.on("show",s.bind(e.onShow,e)),void e.onSelect()):void alert("You must be logged in to add this to your collections!")})},updateView:function(){window.cmPictureFill();var e=this.viewstate.changedAttributes();e.loading?(this.$(".modal-loading-spinner").show(),this.$(".wrapper").hide()):(this.$(".modal-loading-spinner").hide(),this.$(".wrapper").fadeIn(),this.updateSubviews(),0===this.collection.length&&this.$(".create-new-collection").trigger("click"))},loadCollections:function(){var e="/ajax/collections/";this.product&&this.product.id!==!1&&(e+="?productID="+this.product.id),i.ajax(e,{dataType:"JSON",success:s.bind(function(e,t,n){var i=this.onAjax(e);this.viewstate.set({loaded:!0,loading:!1,old_state:i})},this),error:s.bind(function(e,t,n){alert("You must be logged in to add this to your collections!")},this)})},submit:function(e){if(e.preventDefault(),this.validateActiveViews()===!1)return!1;if(this.locked)return!1;this.locked=!0;var t=this.getChangedState();return c.trigger("collections:save",t),i.ajax(this.ajaxEndpoint,{type:"POST",data:{context:JSON.stringify(t),type:"Add To Collection"},success:s.bind(function(e,n,i){if(e.error)this.onSubmitFail();else{this.onSubmitSuccess();var o=s.extend(this.options.trackProps,{"Product ID":this.product.id,"Product Name":this.product.title,Category:this.product.category,Subcategory:this.product.subCategory,Price:r.purchase?this.product.price/100:this.product.price});t.selected_collections.length&&analytics.track("Added To Collection",o),t.deselected_collections.length&&analytics.track("Removed From Collection",o),t.new_collections.forEach(function(e){analytics.track("Collection Added",{Title:e.title})})}},this),error:s.bind(function(e,t,n){this.onSubmitFail()},this)}),!1},onAjax:function(e){var t=[],n=this.product.id;return s.each(e.results,function(e){var i={cid:e.id,title:""!==e.title?e.title:"Wish List",numItems:e.numProducts,thumb:e.thumb,thumbs:e.thumbs,screenshots:e.screenshots,is_wishlist:1===e.isWishlist};s.indexOf(e.products,n)>-1&&(t.push(e.id),i.selected=!0,i.selected_prev=!0);var r=new l(i);this.collection.add(r)},this),t},onAdd:function(e){var t=e.getView();t.parentView=this,this.$list.prepend(t.$el),t.render(),e.get("isNew")&&t.focus(),t.updateView(),t.updatePlaceholder(),r.isMobile||this.$list.scrollTo(0)},onClick:function(e){return e.preventDefault(),this.validateActiveViews(),!1},onSelect:function(){var e;e=0===this.numSelected()?this.saveBtnText.none:this.numSelected()>1?this.saveBtnText.multi:this.saveBtnText.single,this.$button.text(e)},onError:function(){this.$list.addClass("error")},clearError:function(){this.$list.removeClass("error")},makeFormError:function(e){this.$(".add-to-collection");this.clearFormError();this.$button.tipsy(s.extend({fallback:e},f.DEFAULT_OPTS)),this.$button.tipsy("show")},clearFormError:function(){this.$button.tipsy("hide")},clearSubValidationErrors:function(){var e=function(e){e.getView().clearValidationError()};this.collection.map(e)},onHide:function(){this.viewstate.set({loaded:!1,loading:!1,old_state:null},{silent:!0}),this.clearSubValidationErrors(),this.remove()},onShow:function(){r.isMobile&&i(window).scrollTo(0,1)},hide:function(){this.$el.modal("hide")},onSubmitSuccess:function(){this.viewstate.set({loaded:!1,loading:!1,old_state:null},{silent:!0}),this.hide()},onSubmitFail:function(){var e="Error, please try again later";this.makeFormError(e)},createNew:function(e){if(this.validateActiveViews()){var t=new l({isNew:!0,cid:"new"+this._cid,selected:!0});this._cid++,this.collection.add(t)}return!1},removeChild:function(e){this.collection.remove(e.model)},getThisThumb:function(){return this.this_thumb},getModelAttr:function(e){return function(t){return t.get(e)}},getChangedState:function(){var e=function(e){return e.toJSON()},t=function(t){return s.pluck(s.map(t,e),"cid")},n=this.collection.filter(this.getModelAttr("isNew")),i=this.viewstate.get("old_state"),r=this.collection.filter(this.getModelAttr("selected")),o=s.filter(r,this.getModelAttr("isNew")),a=s.reject(r,this.getModelAttr("isNew")),l=s.difference(i,t(a)),c=s.difference(t(a),i),u=function(e){return""===e.get("title")};n=s.reject(n,u);var d={productID:this.product.id,new_collections:s.map(n,e),old_selected_collections:i,selected_new_collections:t(o),selected_collections:t(a),selected_collections_delta:c,deselected_collections:l};return d},numSelected:function(){return this.collection.filter(this.getModelAttr("selected")).length},validateActiveViews:function(){var e=function(e){return e.getView().isActive()},t=this.collection.filter(e),n=function(e){return e.getView().endEdit()},i=s.all(s.map(t,n,this),s.identity,this);return i?this.clearError():this.onError(),i}}),g=t.collect=function(e,t,n,i){var s=new a,r=new m({collection:s,product:e,trackProps:i||{}});r.this_thumb={s:t,"s-r":n},r.show()};t.init=function(){i(function(){i('[data-hoard="collect"]').click(function(e){e.preventDefault();var t=r.purchase,n=i(e.currentTarget).parents("[data-module]").data("module"),s=n?{Module:n}:{};r.tracking_category&&(t.category=r.tracking_category.Category,t.subCategory=r.tracking_category.Subcategory),r.purchase&&g(t,i(this).data("product-thumb"),i(this).data("product-thumb-retina"),s)})})}}),define("text!shared/templates/thumbnail_actions.tmpl",[],function(){return'<span class="thumbnail-actions-overlay">\n\t<span class="thumbnail-actions">\n\t\t<span class="thumbnail-action thumbnail-action-like">\n\t\t\t<i class="icon-heart"></i>\n            <span class="text">Like</span>\n\t\t</span>\n\t\t<span class="thumbnail-action thumbnail-action-favorite mobile-hidden" data-hoard="collect">\n\t\t\t<i class="icon-collection add"></i>\n            <span class="text">Save</span>\n\t\t</span>\n\t</span>\n</span>\n<a href="#" class="btn btn-pinterest overlay mobile-hidden" data-url="<%= url %>" data-media="<%= media %>" data-description="<%= description %>" data-share="pinterest"></a>\n'}),define("shared/views/thumbnail_actions",["require","exports","module","jquery","underscore","event_bus","shared/likes","globals","shared/feature_switch","shared/models/session","product/modals/collection","shared/tracking_helper","text!shared/templates/thumbnail_actions.tmpl"],function(e,t,n){var i=e("jquery"),s=e("underscore"),r=e("event_bus"),o=e("shared/likes"),a=(e("globals"),e("shared/feature_switch"),e("shared/models/session")),l=e("product/modals/collection"),c=e("shared/tracking_helper"),u=s.template(e("text!shared/templates/thumbnail_actions.tmpl")),d=function(){i(document).on("click",".thumbnail-action-like",m),i(document).on("click",".react-like",m),i(document).on("click",".thumbnail-action-favorite",g),r.on("like:product",y),r.on("session:create",f),r.on("collections:save",b),a.isLoggedIn()?f():h()},h=function(e){i("[data-likeable]").each(function(){if(!i(this)[0].actionsRendered){var t=i(this),n=t.is("a")?t:t.children("a"),s=t.data("id");t[0].actionsRendered=!0;var r={url:t.data("url"),media:t.data("media"),description:t.data("description")},o=i(u(r)),a=i(".thumbnail-actions-admin",this);o.appendTo(t),a.length&&(i(".thumbnail-actions-overlay").addClass("thumbnail-actions-overlay-admin"),i(".thumbnail-actions",o[0]).append(a.children()),3===i(".thumbnail-actions",o[0]).children().length&&i(".thumbnail-actions-overlay").addClass("short")),n.removeClass("like-loaded"),e&&e(t,s),n.addClass("like-loaded")}})},f=t.refresh=function(){p(w(),function(e){h(function(t,n){s.indexOf(e.likes,n)!==-1&&(t.find(".thumbnail-action-like i").addClass("green"),t.find(".thumbnail-action-like").addClass("thumbnail-action-selected"),t.find(".thumbnail-action-like .text").text("Liked")),s.indexOf(e.favorites,n)!==-1&&v(t,!0)})})},p=function(e,t){return e&&e.length&&a.isLoggedIn()?void i.ajax({type:"POST",url:"/ajax/fetch-hoarding",data:{products:e},success:t,error:function(){t([])}}):t([])},m=function(e){var t=i(e.currentTarget),n=t.parents("[data-likeable]:first"),s=n.siblings().data(s),r=n.data("canonical"),a=!t.hasClass("thumbnail-action-selected"),l={id:n.data("id"),title:n.data("title"),category:n.data("category"),subCategory:n.data("subcategory"),directory:n.data("directory")};if(e.preventDefault(),i("body.optimizely-8347460123")){var c=t.closest(".similar-products").attr("id"),u="";switch(c){case"products-by":u="Recommended Shop Products - Below the Fold";break;case"similar-recommended":u="Recommended Products - Below the Fold";break;default:u="Product Thumbnail"}}else u="Product Thumbnail";o.toggle(l,a,r,{Module:t.data("module")||u})},g=function(e){var t,n,s=i(e.currentTarget),r=s.closest("li").data("directory")||"",o=s.parents("[data-likeable]:first"),a=(o.data("id"),s.parents("[data-module]").data("module")),u=a?{Module:a}:{},d=o.find("a.thumbwrap span");d.length?(t=d.data("src"),n=d.data("src-retina")):(t=o.data("src"),n=o.data("src_retina"));var h={id:o.data("id"),title:o.data("title"),category:c.getCategory(r),subCategory:c.getSubcategory("",r),price:o.data("price")};e.preventDefault(),l.collect(h,t,n,u)},v=function(e,t){var n=e.find(".thumbnail-action-favorite i");0!==n.length&&(n.parent().toggleClass("thumbnail-action-selected",t),t?n.addClass("icon-collection added").removeClass("add"):n.removeClass("added").addClass("add"),e.find(".thumbnail-action-favorite .text").html(t?"Saved":"Save"))},b=function(e){i('[data-likeable][data-id="'+e.productID+'"]').each(function(){var t=!1;(e.selected_collections.length||e.selected_new_collections.length)&&(t=!0),v(i(this),t)})},y=function(e,t){i('[data-likeable][data-id="'+e.id+'"]').each(function(){var e=i(this);i(".thumbnail-action-like",e).toggleClass("thumbnail-action-selected",t).attr("title",t?"You like this. Click to undo.":"Like this?"),i(".icon-heart",e).toggleClass("green",t),e.find(".thumbnail-action-like .text").html(t?"Liked":"Like")})},w=function(){var e=[];return i("[data-likeable]").each(function(){e.push(parseInt(i(this).data("id"),10))}),s.uniq(e)};i(d)}),define("shared/views/global_header",["require","jquery","adamantium/view"],function(e){var t=e("jquery"),n=e("adamantium/view"),i=n.extend({events:{"click .sign-out":"onClickSignOut"},initialize:function(){function e(e){var n=t(e),i=n.closest("li");return{Type:i.data("is-free-good")?"Bonus Free Goods":"Product","Product ID":i.data("id"),"Product Name":i.data("title"),Category:i.data("category"),Subcategory:i.data("subcategory")}}analytics.trackLink(this.$(".cloud .download"),"Downloaded",e)},onClickSignOut:function(e){e.preventDefault(),window.location=t(e.currentTarget).attr("href")}});return i}),function(e,t){"function"==typeof define&&define.amd?define("sifter",t):"object"==typeof exports?module.exports=t():e.Sifter=t()}(this,function(){var e=function(e,t){this.items=e,this.settings=t||{diacritics:!0}};e.prototype.tokenize=function(e){if(e=i(String(e||"").toLowerCase()),!e||!e.length)return[];var t,n,r,a,l=[],c=e.split(/ +/);for(t=0,n=c.length;t<n;t++){if(r=s(c[t]),this.settings.diacritics)for(a in o)o.hasOwnProperty(a)&&(r=r.replace(new RegExp(a,"g"),o[a]));l.push({string:c[t],regex:new RegExp(r,"i")})}return l},e.prototype.iterator=function(e,t){var n;n=r(e)?Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++)e(this[t],t,this)}:function(e){for(var t in this)this.hasOwnProperty(t)&&e(this[t],t,this)},n.apply(e,[t])},e.prototype.getScoreFunction=function(e,t){var n,i,s,r;n=this,e=n.prepareSearch(e,t),s=e.tokens,i=e.options.fields,r=s.length;var o=function(e,t){var n,i;return e?(e=String(e||""),i=e.search(t.regex),i===-1?0:(n=t.string.length/e.length,0===i&&(n+=.5),n)):0},a=function(){var e=i.length;return e?1===e?function(e,t){return o(t[i[0]],e)}:function(t,n){for(var s=0,r=0;s<e;s++)r+=o(n[i[s]],t);return r/e}:function(){return 0}}();return r?1===r?function(e){return a(s[0],e)}:"and"===e.options.conjunction?function(e){for(var t,n=0,i=0;n<r;n++){if(t=a(s[n],e),t<=0)return 0;i+=t}return i/r}:function(e){for(var t=0,n=0;t<r;t++)n+=a(s[t],e);return n/r}:function(){return 0}},e.prototype.getSortFunction=function(e,n){var i,s,r,o,a,l,c,u,d,h,f;if(r=this,e=r.prepareSearch(e,n),f=!e.query&&n.sort_empty||n.sort,d=function(e,t){return"$score"===e?t.score:r.items[t.id][e]},a=[],f)for(i=0,s=f.length;i<s;i++)(e.query||"$score"!==f[i].field)&&a.push(f[i]);if(e.query){for(h=!0,i=0,s=a.length;i<s;i++)if("$score"===a[i].field){h=!1;break}h&&a.unshift({field:"$score",direction:"desc"})}else for(i=0,s=a.length;i<s;i++)if("$score"===a[i].field){a.splice(i,1);break}for(u=[],i=0,s=a.length;i<s;i++)u.push("desc"===a[i].direction?-1:1);return l=a.length,l?1===l?(o=a[0].field,c=u[0],function(e,n){return c*t(d(o,e),d(o,n))}):function(e,n){var i,s,r;for(i=0;i<l;i++)if(r=a[i].field,s=u[i]*t(d(r,e),d(r,n)))return s;return 0}:null},e.prototype.prepareSearch=function(e,t){if("object"==typeof e)return e;t=n({},t);var i=t.fields,s=t.sort,o=t.sort_empty;return i&&!r(i)&&(t.fields=[i]),s&&!r(s)&&(t.sort=[s]),o&&!r(o)&&(t.sort_empty=[o]),{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}},e.prototype.search=function(e,t){var n,i,s,r,o=this;return i=this.prepareSearch(e,t),t=i.options,e=i.query,r=t.score||o.getScoreFunction(i),e.length?o.iterator(o.items,function(e,s){n=r(e),(t.filter===!1||n>0)&&i.items.push({score:n,id:s})}):o.iterator(o.items,function(e,t){i.items.push({score:1,id:t})}),s=o.getSortFunction(i,t),s&&i.items.sort(s),i.total=i.items.length,"number"==typeof t.limit&&(i.items=i.items.slice(0,t.limit)),i};var t=function(e,t){return"number"==typeof e&&"number"==typeof t?e>t?1:e<t?-1:0:(e=String(e||"").toLowerCase(),t=String(t||"").toLowerCase(),e>t?1:t>e?-1:0)},n=function(e,t){var n,i,s,r;for(n=1,i=arguments.length;n<i;n++)if(r=arguments[n])for(s in r)r.hasOwnProperty(s)&&(e[s]=r[s]);return e},i=function(e){return(e+"").replace(/^\s+|\s+$|/g,"")},s=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},r=Array.isArray||$&&$.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o={a:"[aÀÁÂÃÄÅàáâãäå]",c:"[cÇçćĆčČ]",d:"[dđĐ]",e:"[eÈÉÊËèéêë]",i:"[iÌÍÎÏìíîï]",n:"[nÑñ]",o:"[oÒÓÔÕÕÖØòóôõöø]",s:"[sŠš]",u:"[uÙÚÛÜùúûü]",y:"[yŸÿý]",z:"[zŽž]"};return e}),define("vendor/highlight",["require","exports","module"],function(e,t,n){t.highlight=function(e,t){if("string"!=typeof t||t.length){var n="string"==typeof t?new RegExp(t,"i"):t,i=function(e){var t=0;if(3===e.nodeType){var s=e.data.search(n);if(s>=0&&e.data.length>0){var r=e.data.match(n),o=document.createElement("span");o.className="highlight";var a=e.splitText(s),l=(a.splitText(r[0].length),a.cloneNode(!0));o.appendChild(l),a.parentNode.replaceChild(o,a),t=1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName))for(var c=0;c<e.childNodes.length;++c)c+=i(e.childNodes[c]);return t};return e.each(function(){i(this)})}},t.unhighlight=function(e){return e.find("span.highlight").each(function(){var e=$(this),t=e.parent();e.replaceWith(e.html()),t[0].normalize()}).end()}}),define("search/views/autocomplete",["require","underscore","adamantium/view","sifter","shared/feature_switch","shared/models/session","vendor/highlight","event_bus","globals"],function(e){var t=e("underscore"),n=e("adamantium/view"),i=e("sifter"),s=(e("shared/feature_switch"),e("shared/models/session")),r=e("vendor/highlight"),o=e("event_bus"),a=(e("globals"),n.extend({initialize:function(e){var n=this;n.$el.attr({autocomplete:"off"}),n.$dropdown=$("<div>").addClass("dropdown-nohover dropdown-autocomplete").attr({id:e.id,"data-module":"Header - Search Suggestion"}).insertAfter(n.$el),n.$dropdownContent=$("<ul>").addClass("dropdown-menu dropdown-noitemhover").appendTo(n.$dropdown),n.activeID=null,n.data={},n.sifter=new i(n.data),n.loadedQueries={},n.lastQuery=null,n.ignoreBlur=!1,n.isOpen=!1,n.form=n.options.form,t.bindAll(n,"onBodyClick","onKeyPress","onDropdownMousedown","onDropdownClick","onChange","onFocus","onBlur","onItemClick","onItemEnter","onItemLeave"),n.onChange=t.debounce(n.onChange,250),n.onFocus=t.debounce(n.onFocus,250)},delegateEvents:function(){var e=this,t=$("body"),i=($(window),e.$dropdown),s=e.$el;return s.on("keyup keypress paste",e.onChange),s.on("focus",e.onFocus),s.on("blur",e.onBlur),i.on("mousedown",e.onDropdownMousedown),i.on("click",e.onDropdownClick),i.on("click","a",e.onItemClick),i.on("mouseenter","li",e.onItemEnter),i.on("mouseleave","li",e.onItemLeave),t.on("click",e.onBodyClick),this.$el.on("keydown",e.onKeyPress),n.prototype.delegateEvents.apply(e,arguments)},undelegateEvents:function(){var e=this;return e.$el.off(e.onChange),e.$el.off(e.onFocus),e.$el.off(e.onBlur),this.$el.off("keydown",e.onKeyPress),$("body").off("click",e.onBodyClick),n.prototype.undelegateEvents.apply(e,arguments)},remove:function(){this.$dropdown.remove()},getItemID:function(e){if(e)return $(e).attr("data-id")},getItem:function(e){return $('[data-id="'+e+'"]',this.$dropdownContent)},getActiveItem:function(){return this.getItem(self.activeID)},triggerItem:function(e,t){var n=e.data("parent-id")||this.getItemID(e),i=this.data[n];if(this.$el.val(i.r),i&&i.c){var s=e.data("child-index");if(void 0!==s){var r=i.c[s],a=this.$el.closest("form"),l=a.find('.dropdown.categories a[data-id="'+r.c+'"]');o.trigger("category:updateFromTarget",l),$("body").is(".page-search, .page-product-category")&&o.trigger("search:filter:category",{id:r.c,title:r.t})}}t&&t.preventDefault(),$("body").hasClass("page-search")?$("#global-q").closest("form").submit():this.form[0].submit()},activateItem:function(e){var t=this;$(".hover",t.$dropdownContent).removeClass("hover"),t.activeID=this.getItemID(e),e&&e.addClass("hover")},moveSelection:function(e){var t,n=this,i=n.getItem(n.activeID);if(i.length){if(t=i[1===e?"next":"prev"](),1===e&&!t.length)return}else{if(e===-1)return;t=n.$dropdownContent.children(":first")}n.activateItem(t)},renderItem:function(e){var n="/search?q="+e.r;if(e.c){var i='<li data-id="'+e.i+'"><a href="'+n+'" data-tracking="'+e.r+'" data-action="Search">'+e.r+"</a></li>";return t.each(e.c,function(t,n){var s="/search?q="+e.r+"&category="+t.c;i+='<li class="autocomplete-child" data-id="'+e.i+"-"+n+'" data-parent-id="'+e.i+'" data-child-index="'+n+'"><a href="'+s+'" data-tracking="'+e.r+" in "+t.t+'" data-action="Search"><strong>in </strong>'+t.t+"</li>"}),i}return'<li data-id="'+e.i+'" ><a href="'+n+'" data-tracking="'+e.r+'" data-action="Search">'+e.r+"</a></li>"},append:function(e){var t,n={},i=0;for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t],i++);return this.data=n,i>0},load:function(e,t,n,i){if(e){this.xhr&&this.xhr.abort();var s=this,r={query:e};t&&(r.category=t);var o=$.ajax({url:"/ajax/autocomplete",data:r,success:function(t){s.loadedQueries[e]=t,s.append(t),i&&i(t)}});n&&(this.xhr=o)}},refresh:function(e){if(!e.length)return this.hide();var n,i,r,o;s.isLoggedIn(),!!s.get("hasShop");r={fields:["t"],limit:15,conjunction:"and"},o=this.sifter.getScoreFunction(e,r),n=this.sifter.search(e,t.extend(r,{score:function(e){return o(e)}}));var i=[];t.each(this.data,function(e,t){i.push(e)}),this.display(i,n.tokens)},highlight:function(e){for(var t=0,n=e.length;t<n;t++)r.highlight(this.$dropdownContent,e[t].regex)},update:function(e,t){var n=this;n.refresh(e),n.load(e,t,!0,function(t){n.append(t)&&n.refresh(e)})},display:function(e,t){var n,i,s=this,r=[];for(n=0,i=e.length;n<i;n++)r.push(s.renderItem(e[n]));r.length?(s.$dropdownContent.html(r.join("")),s.highlight(t),s.activateItem(s.getItem(s.activeID)),s.show()):s.hide()},show:function(){this.isOpen||(this.isOpen=!0,this.$dropdown.addClass("open"),this.$el.addClass("dropdown-open"))},hide:function(){this.isOpen&&(this.isOpen=!1,this.$dropdown.removeClass("open"),this.$el.removeClass("dropdown-open"))},getCategoryId:function(){return this.form.data("category-id")||0},onFocus:function(){this.ignoreBlur=!1;var e=$.trim(this.$el.val());e&&(e===this.lastQuery?this.show():this.update(e,this.getCategoryId()))},onBlur:function(){this.ignoreBlur||this.hide()},onChange:function(){var e=$.trim(this.$el.val());e!==this.lastQuery&&(this.lastQuery=e,this.update(e,this.getCategoryId()))},onDropdownClick:function(){this.hide()},onDropdownMousedown:function(){this.ignoreBlur=!0},onBodyClick:function(e){this.$dropdown.has(e.target)||this.hide()},onKeyPress:function(e){if(this.isOpen){var t=this,n=e.keyCode,i=27,s=13,r=38,o=40;n===i?t.hide():n===s&&t.activeID?(t.triggerItem(t.getItem(t.activeID)),e.preventDefault(),e.stopPropagation()):n===o?(e.preventDefault(),t.moveSelection(1)):n===r&&(e.preventDefault(),t.moveSelection(-1))}},onItemClick:function(e){var t=$(e.currentTarget).parents("li:first");this.triggerItem(t,e)},onItemEnter:function(e){this.activateItem($(e.currentTarget))},onItemLeave:function(e){this.activateItem()}},{init:function(e){var t=this,n=$("#global-q"),i=$("#search-form");if("ab"===e&&(i=$("#search-form-ab"),n=i.find("#global-q")),n.length)return new t({el:n[0],form:i,id:"q-autocomplete"})}}));return a}),define("shared/search",["require","jquery","underscore","event_bus","globals","search/views/autocomplete","adamantium/view","shared/util","shared/feature_switch"],function(e){var t=e("jquery"),n=e("underscore"),i=e("event_bus"),s=e("globals"),r=e("search/views/autocomplete"),o=e("adamantium/view"),a=e("shared/util"),l=(e("shared/feature_switch"),o.extend({events:{submit:"onFormSubmit","mouseover ul.categories > li":"showCategories","mouseout ul.categories > li":"hideCategories","click ul.categories a":"categoryClick"},initialize:function(){this.autocomplete=r.init(this.options.type||""),this.category="",t("body").hasClass("page-search")&&n.size(s.category)&&this.onCategoryChange(s.category),t("body").is(".page-search, .page-product-category")&&i.on("search:filter:category",this.onCategoryChange,this),i.on("category:updateFromTarget",this.updateFromTarget,this)},onQueryChange:function(e){if(t("#global-q").val()){var n={Query:e.q,Category:this.category||"All",Type:this.options.type||"Global",Module:e.module,Label:s.page_type_text||""};analytics.track("Searched",n)}t("#global-q").val(a.sanitize(e.q))},onCategoryChange:function(e){var t=this.$('a[data-id="'+e.id+'"]');this.updateFromTarget(t)},showCategories:function(e){t(e.currentTarget).addClass("show"),t(".search-query").blur()},hideCategories:function(e){t(e.currentTarget).removeClass("show")},categoryClick:function(e){e.preventDefault(),e.stopPropagation();var n=t(e.currentTarget);this.category=n.data("category-title"),t("#category-tree").val(this.category),this.updateFromTarget(n),this.$("input").focus(),t("body").hasClass("page-search")&&i.trigger("search:filter:category",{id:n.data("id"),title:n.data("category-title")})},formatString:function(e){return e.toLowerCase().split(" ").map(function(e){return e[0].toUpperCase()+e.substring(1);
}).join(" ").replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"")},updateFromTarget:function(e){if(e.data("category")){var t=e.data("category")?e.data("category"):"search",n="search"===t?"Search All":"Search "+e.data("category-title"),i="ab"===this.options.type?"icon-search-ab-"+t:"icon-"+t;this.$el.attr("action",e.attr("href")).data("category-id",e.data("id")),this.$el.find(".dropdown.categories a:first").attr("class",i),this.$("li").removeClass("show"),this.$("input").attr("placeholder",n)}},onFormSubmit:function(e,n){var r=(t("#category-tree").val(),this.$("#global-q")),o=r.val();if(r.blur(),t("body").hasClass("page-search"))e.preventDefault(),i.trigger("slidebars-close"),i.trigger("search:query",{q:o,module:"Header"});else if(!n){e.preventDefault();var a=(t("#category-tree").val(),{Query:o,Category:this.category||"All",Module:"Header",Type:"Global",label:s.page_type_text||""}),l=t(this.el).data("variation");"undefined"!=typeof l&&(l=String(l),l.length>0&&(a.Variation=l)),analytics.track("Searched",a,function(){t(e.currentTarget).trigger("submit",!0)})}}},{init:function(){var e={el:t("#search-form").get(0)};return new l(e)}}));return l}),define("shared/tracking",["require","jquery","underscore","globals","event_bus","shared/cookies","shared/util","shared/tracking_helper"],function(e){var t=e("jquery"),n=e("underscore"),i=e("globals"),s=e("event_bus"),r=e("shared/cookies"),o=e("shared/util"),a=e("shared/tracking_helper"),l={initialize:function(){this.trackEvents(),this.attachEvents()},stripEmail:function(e){var t=/\be=([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+(%40)+[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)\b&?/,n=e.replace(t,"");return n},trackEvents:function(){this.trackPage({pageViewed:!1}),this.trackPageEvent(),this.trackProducts(),this.trackCategories(),this.SessionFirstPage()},attachEvents:function(){var e=this;window.analytics.ready(function(){e.destroyStaleMpCookies(),s.trigger("analytics:ready")}),s.on("track:page",this.trackPage,this),t(document).on("click","a",function(e){var i=t(e.currentTarget),s=i.attr("href"),r=i.closest("[data-tracking]").data("tracking"),o=i.closest("[data-module]"),a=o.data("module"),l=i.data("modal"),c=i.closest("[data-action]").data("action"),u=o.parents("[data-module-parent]").data("module-parent");if((a||!n.isUndefined(r))&&r!==!1){u&&(a=u);var d={Module:a,Action:c};"#"!==s&&(d.Link=s);var h=t.trim(i.clone().children().remove().end().text()),f=r||h;f&&(d.Text=f),analytics.track("Clicked",d);var p=/Mac/.test(navigator.userAgent);!s||e.isDefaultPrevented()||/^#|javascript\:/.test(s)||"_blank"===i.attr("target")||2===e.which||(p?e.metaKey:e.ctrlKey)||l||(e.preventDefault(),window.setTimeout(function(){window.location.href=s},300))}})},trackProducts:function(){var e={};if(i.isProduct){if(i.tracking_category){var r=t('input[name="category-directory"]').val(),o=a.getSubcategory("",r);e.Category=i.tracking_category.Category,e.Subcategory=o}i.purchase&&(e.id=i.purchase.id,e.name=i.purchase.title,i.purchase.isFreeGood?(e.type="Free Good",e.price=0):(e.type="Product",e.price=i.purchase.price/100))}else i.isBundle&&(e.type="Bundle",i.purchase&&(e.id=i.purchase.id,e.name=i.bundle.title,e.price=i.purchase.price/100));n.isEmpty(e)||analytics.track("Viewed Product ",e),s.on("state:change",function(t,n){if(t&&n&&!i.purchase.isPurchased&&!i.purchase.isFreeGood)if("ready"===n.stateName);else if("completed"===t.stateName&&"completed"!==n.stateName){var s=i.purchase.isFreeGood?0:i.purchase.price/100;analytics.track("Completed Order",{orderId:i.purchase.id+"-"+Date.now(),total:s,revenue:s,currency:"USD",products:[e]})}})},trackCategories:function(){"category"!==i.page_type||n.isEmpty(i.tracking_category)||analytics.track("Viewed Product Category",{category:i.tracking_category.Category,subcategory:i.tracking_category.Subcategory})},trackPage:function(e){var i={path:window.location.pathname},s=this.stripEmail(window.location.href);if(e=e||{},n.isUndefined(e.pageViewed)&&this.trackPageEvent(!0),e.search){var r=o.getQueryParams();r.q=e.search;var a=t.param(r);i.url=s,i.search="?"+a}else i.url=s;analytics.page(i)},trackPageEvent:function(e){var s={URL:window.location.pathname,"Page Name":document.title,"Page Type":i.page_type_text||"","Is Session First Page":!r.get("cmsfp")};if(i.tracking_category){var o="";o=t('input[name="category-directory"]').val()?t('input[name="category-directory"]').val():t("#category-tree").val(),s.Category=a.getCategory(o),s.Subcategory=a.getSubcategory("",o)}if("search"===i.page_type){var o=t("#category-tree").val();s.Category=a.getCategory(o),s.Subcategory=a.getSubcategory("",o)}!e||n.isUndefined(window.mixpanel)||n.isUndefined(window.mixpanel.register)||window.mixpanel.register({URL:window.location.pathname,"Page Name":document.title}),analytics.track("Page Viewed",s)},destroyStaleMpCookies:function(){if(window.mixpanel&&window.mixpanel.cookie)for(var e=window.mixpanel.cookie.name,t=new RegExp("(?!"+e+")^mp_.*_mixpanel"),n=document.cookie.split(/;\s*/),i=0;i<n.length;i++)if(n[i].match(t)){var s=n[i],o=s.split("="),a=o[0];r.destroy(a)}},SessionFirstPage:function(){r.set("cmsfp",1,1800)}};return l}),define("shared/site_modal",["require","jquery","config","shared/plugins/modal"],function(e){var t=e("jquery"),n=e("config"),i=e("shared/plugins/modal"),s={initialize:function(){this.shouldDisplay()},shouldDisplay:function(){if(n.show_modal){var e=n.show_modal;if("welcome"===e&&window.optimizelySuppressWelcome)return;switch(window.modalTrigger){case"exit":this.showOnExit(e);break;case"first_page_exit":sessionStorage.siteViewed?this.showOnEnter(e):(this.showOnExit(e),sessionStorage.siteViewed=1);break;case"scroll":this.showOnScroll(e);break;default:this.showOnEnter(e)}}else n.show_modal_exit&&this.showOnExit(n.show_modal_exit)},showOnEnter:function(e){e&&window.setTimeout(function(){i.show(e)},window.modal_delay||0)},showOnExit:function(e){function n(){window.clearTimeout(r),r=window.setTimeout(function(){i.show(e),t(document).off({mouseleave:n,mouseenter:s})},window.modal_delay||0)}function s(){window.clearTimeout(r)}var r;t(document).on({mouseleave:n,mouseenter:s})},showOnScroll:function(e,n){var i=this,s=n||50,r=!1;t(window).scroll(function(){var n=t(window).scrollTop(),o=t(document).height(),a=t(window).height(),l=n/(o-a)*100;l>s&&!r&&(i.showOnEnter(e),r=!0)})}};return s}),define("initialize",["require","exports","module","jquery","config","event_bus","globals","apis/facebook","shared/cookies","shared/feature_switch","shared/models/session","shared/plugins/modal","shared/plugins/share","shared/plugins/user_card","shared/views/notice","shared/views/link_builder","shared/views/thumbnail_actions","shared/views/global_header","shared/search","shared/tracking","shared/site_modal"],function(e,t,n){var i=e("jquery"),s=(e("config"),e("event_bus")),r=(e("globals"),e("apis/facebook")),o=e("shared/cookies"),a=(e("shared/feature_switch"),e("shared/models/session")),l=(e("shared/plugins/modal"),e("shared/plugins/share")),c=e("shared/plugins/user_card"),u=e("shared/views/notice"),d=e("shared/views/link_builder"),h=(e("shared/views/thumbnail_actions"),e("shared/views/global_header")),f=e("shared/search"),p=e("shared/tracking"),m=e("shared/site_modal");return IS_TOUCH_DEVICE=!!("ontouchstart"in document.documentElement)&&/android|blackberry|iphone|ipad|ipod|iemobile/i.test(navigator.userAgent),function(){IS_TOUCH_DEVICE?i("html").addClass("touchevents"):i("html").addClass("no-touchevents")}(),s.on("session:create",function(e){var t=i(e.get("headerUserContent")),n=i("#header-user-content");n.addClass("notvisible"),setTimeout(function(){n.html(t),IS_TOUCH_DEVICE&&i(".dropdown",n).addClass("dropdown-nohover").removeClass("dropdown"),cmPictureFill(),n.removeClass("notvisible")},200)}),function(){var e=i("body");p.initialize(),l.initialize(),c.initialize(),m.initialize(),new h({el:i("#header-global")}),new f({el:i("#search-form-ab").get(0),type:"ab"}),new f({el:i("#search-form").get(0)}),u.autoInit(),d.init(),function(){var t={},n={},s={};e.on("mouseenter",".dropdown.activity, .dropdown.shop-updates",function(r){var o=i(r.currentTarget),a=o.is(".shop-updates")?"shop_updates":"notifications";if(!(n[a]||t[a]||s[a])){var l;"notifications"===a?l={url:"/ajax/mod/read",type:"POST",data:{type:"notifications"}}:"shop_updates"===a&&(l={url:"/shop-updates/updates"}),t[a]=window.setTimeout(function(){var e=i(".new-blip",o);e.length>0&&(l.success=function(){e.removeClass("new-blip"),i(".new",o).removeClass("new"),s[a]=!0},n[a]=i.ajax(l))},2e3),e.one("mouseleave",".dropdown.activity, .dropdown.shop-updates",function(){window.clearTimeout(t[a]),delete t[a],delete n[a],delete s[a]})}})}(),function(){if("undefined"!=typeof window.history.replaceState&&0===i("#dont-clear-notification-token").length){var e=window.location.href,t=e.replace(/[?&]n=[^?&#]+/,"");t!==e&&window.history.replaceState(null,document.title,t)}}(),e.on("click",".btn-claim-bundle",function(){return a.authenticate().then(function(){location.reload(!0)}),!1}),i.fn.tipsy&&i("[rel=tipsy]").tipsy({gravity:"s",html:!0,fade:!0,opacity:1}),i.fn.laterload&&i("[data-lazy]").laterload(),function(){function e(e,t,n){i(n).closest("#site-banner").length&&analytics.track("Clicked",{Text:"Facebook Like",Action:e,Module:"Site Banner"})}var t,n=i("#site-banner");n.length&&(t=n.data("date"),i("#site-banner .close").on("click",function(e){var n=i(".flash.flash-show");return n.length&&n.css({top:0}),i("#site-banner").fadeOut(),i("#wrap").css({paddingTop:0}),i("#wrap").removeClass("site-banner-seen"),o.set("cmsbh"+t,1,31536e3),analytics.track("Clicked",{Text:"Close Banner",Module:"Site Banner"}),!1}),i("#site-banner .pinterest-follow").on("click",function(e){analytics.track("Clicked",{Text:"Pinterest Follow",Module:"Site Banner"})}),r.onFB("edge.create",e.bind(null,"Like")),r.onFB("edge.remove",e.bind(null,"Unlike")),i("#wrap.site-banner-seen").length&&i("#wrap.site-banner-seen").css({paddingTop:n.height()}),n.hasClass("animate")&&(i("#wrap").animate({paddingTop:n.height(),delay:800,queue:!1},600,"linear"),n.show().animate({top:0,delay:800,queue:!1},600,"linear",function(){i("#wrap").css({paddingTop:n.height()})}),i("#wrap").addClass("site-banner-seen"),o.set("cmsbs"+t,1,31536e3)))}(),i("#widget-embeds input, #widget-embeds textarea").on("click",function(e){i(this).focus().select()}),s.on("session:create",function(){a.redirect?window.location.href=a.redirect:"undefined"!=typeof e.attr("data-refresh")?window.location.reload():(e.removeClass("no-session"),e.addClass("has-session"))}),a.setFacebookLoginStatus()}}),define("creativemarket",["require","jquery","underscore","globals","event_bus","shared/csrf_request","shared/extend_natives","shared/regex","shared/util","vendor/jquery/select2","vendor/jquery/tipsy","vendor/jquery/scrollto","shared/plugins/text_width","shared/plugins/auto_resize","shared/plugins/auto_resize_text_input","shared/plugins/checkbox_range","shared/plugins/mentions","shared/plugins/follow_btn","shared/modals/session","shared/popup","shared/modals/free_goods","shared/modals/message","shared/plugins/later_load","shared/plugins/sliders","initialize"],function(e){var t=e("jquery"),n=(e("underscore"),e("globals"),e("event_bus"),e("shared/csrf_request"),e("shared/extend_natives"),e("shared/regex")),i=e("shared/util"),s=(e("vendor/jquery/select2"),e("vendor/jquery/tipsy"),e("vendor/jquery/scrollto"),e("shared/plugins/text_width"),e("shared/plugins/auto_resize"),e("shared/plugins/auto_resize_text_input"),e("shared/plugins/checkbox_range"),e("shared/plugins/mentions"),e("shared/plugins/follow_btn"),e("shared/modals/session"),e("shared/popup"),e("shared/modals/free_goods"),e("shared/modals/message"),e("shared/plugins/later_load"),e("shared/plugins/sliders"),e("initialize")),r={};return r.REGEX_EMAIL_ADDRESS=n.EMAIL_ADDRESS,r.REGEX_USERNAME=n.USERNAME,r.REGEX_URL=n.URL,r.toggleAll=i.toggleAll,r.confirmRedirect=i.confirmRedirect,r.formatFileSize=i.formatFileSize,r.buildAjaxUpdaterRequest=i.buildAjaxUpdaterRequest,r.goToAnchor=i.goToAnchor,r.intval=i.intval,r.truncate=i.truncate,r.md5=i.md5,r.showThenHideTipsy=i.showThenHideTipsy,r.getRandStr=i.getRandStr,t.ajaxSetup({cache:!0}),t(s),r}),define("common",["require","creativemarket"],function(e){e("creativemarket")}),function(e){"object"==typeof exports?module.exports=e(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backbone.validation",["backbone","underscore"],e)}(function(e,t){return e.Validation=function(t){"use strict";var n={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},i=function(){var i=function(e,n){return e&&e[n]?t.isFunction(e[n])?e[n]():e[n]:null},r=function(e){return t.reduce(t.keys(i(e,"validation")||{}),function(e,t){return e[t]=void 0,e},{})},o=function(e,n){var s=i(e,"validation")?i(e,"validation")[n]||{}:{};return(t.isFunction(s)||t.isString(s))&&(s={fn:s}),t.isArray(s)||(s=[s]),t.reduce(s,function(e,n){return t.each(t.without(t.keys(n),"msg"),function(t){e.push({fn:l[t],val:n[t],msg:n.msg})}),e},[])},a=function(e,n,i,s){return t.reduce(o(e,n),function(t,r){var o=r.fn.call(l,i,n,r.val,e,s);return o!==!1&&t!==!1&&(o&&!t?r.msg||o:t)},"")},c=function(e,n){var i,s,r={},o=!0,l=t.clone(n);for(s in n)i=a(e,s,n[s],l),i&&(r[s]=i,o=!1);return{invalidAttrs:r,isValid:o}},u=function(e,n){return{preValidate:function(e,n){return a(this,e,n,t.extend({},this.attributes))},isValid:function(e){if(t.isString(e))return!a(this,e,this.get(e),t.extend({},this.attributes));if(t.isArray(e)){for(var n=0;n<e.length;n++)if(a(this,e[n],this.get(e[n]),t.extend({},this.attributes)))return!1;return!0}return e===!0&&this.validate(),!this.validation||this._isValid},validate:function(i,s){var o=this,a=!i,l=t.extend({},n,s),u=t.extend(r(o),o.attributes,i),d=i||u,h=c(o,u);o._isValid=h.isValid;for(var f in u){var p=h.invalidAttrs.hasOwnProperty(f),m=d.hasOwnProperty(f);p&&(m||a)&&l.invalid(e,f,h.invalidAttrs[f],l.selector),p||l.valid(e,f,l.selector)}if(t.defer(function(){o.trigger("validated",o._isValid,o,h.invalidAttrs),o.trigger("validated:"+(o._isValid?"valid":"invalid"),o,h.invalidAttrs)}),!l.forceUpdate&&t.intersection(t.keys(h.invalidAttrs),t.keys(d)).length>0)return h.invalidAttrs}}},d=function(e,n,i){t.extend(n,u(e,i))},h=function(e){delete e.validate,delete e.preValidate,delete e.isValid},f=function(e){d(this.view,e,this.options)},p=function(e){h(e)};return{version:"0.6.2",configure:function(e){t.extend(n,e)},bind:function(i,r){var o=i instanceof e.View?i.model:i,a=i.collection;if(r=t.extend({},n,s,r),"undefined"==typeof o&&"undefined"==typeof a)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";o&&d(i,o,r),a&&(a.each(function(e){d(i,e,r)}),a.bind("add",f,{view:i,options:r}),a.bind("remove",p))},unbind:function(e){var t=e.model,n=e.collection;t&&h(e.model),n&&(n.each(function(e){h(e)}),n.unbind("add",f),n.unbind("remove",p))},mixin:u(null,n)}}(),s=i.callbacks={valid:function(e,t,n){e.$("["+n+"~="+t+"]").removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,n,i){e.$("["+i+"~="+t+"]").addClass("invalid").attr("data-error",n)}},r=i.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},o=i.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},a=i.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace("_"," ")},label:function(e,t){return t.labels[e]||a.sentenceCase(e,t)}},l=i.validators=function(){var e=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,n=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(n,"")},i=function(e,t){return a[n.labelFormatter](e,t)},s=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})},l=function(e){return t.isNumber(e)||t.isString(e)&&e.match(r.number)},c=function(n){return!(t.isNull(n)||t.isUndefined(n)||t.isString(n)&&""===e(n))};return{fn:function(e,n,i,s,r){return t.isString(i)&&(i=s[i]),i.call(s,e,n,r)},required:function(e,n,r,a,l){var u=t.isFunction(r)?r.call(a,e,n,l):r;return!(!u&&!c(e))&&(u&&!c(e)?s(o.required,i(n,a)):void 0)},acceptance:function(e,n,r,a){if("true"!==e&&(!t.isBoolean(e)||e===!1))return s(o.acceptance,i(n,a))},min:function(e,t,n,r){if(!l(e)||e<n)return s(o.min,i(t,r),n)},max:function(e,t,n,r){if(!l(e)||e>n)return s(o.max,i(t,r),n)},range:function(e,t,n,r){if(!l(e)||e<n[0]||e>n[1])return s(o.range,i(t,r),n[0],n[1])},length:function(t,n,r,a){if(!c(t)||e(t).length!==r)return s(o.length,i(n,a),r)},minLength:function(t,n,r,a){if(!c(t)||e(t).length<r)return s(o.minLength,i(n,a),r)},maxLength:function(t,n,r,a){if(!c(t)||e(t).length>r)return s(o.maxLength,i(n,a),r)},rangeLength:function(t,n,r,a){if(!c(t)||e(t).length<r[0]||e(t).length>r[1])return s(o.rangeLength,i(n,a),r[0],r[1])},oneOf:function(e,n,r,a){if(!t.include(r,e))return s(o.oneOf,i(n,a),r.join(", "))},equalTo:function(e,t,n,r,a){if(e!==a[n])return s(o.equalTo,i(t,r),i(n,r))},pattern:function(e,t,n,a){if(!c(e)||!e.toString().match(r[n]||n))return s(o.pattern,i(t,a),n)}}}();return i}(t),e.Validation}),function(e){function t(e,t){return function(n){return l(e.call(this,n),t)}}function n(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function i(){}function s(e){o(this,e)}function r(e){var t=this._data={},n=e.years||e.year||e.y||0,i=e.months||e.month||e.M||0,s=e.weeks||e.week||e.w||0,r=e.days||e.day||e.d||0,o=e.hours||e.hour||e.h||0,l=e.minutes||e.minute||e.m||0,c=e.seconds||e.second||e.s||0,u=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=u+1e3*c+6e4*l+36e5*o,this._days=r+7*s,this._months=i+12*n,t.milliseconds=u%1e3,c+=a(u/1e3),t.seconds=c%60,l+=a(c/60),t.minutes=l%60,o+=a(l/60),t.hours=o%24,r+=a(o/24),r+=7*s,t.days=r%30,i+=a(r/30),t.months=i%12,n+=a(i/12),t.years=n}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function a(e){return e<0?Math.ceil(e):Math.floor(e)}function l(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function c(e,t,n){var i,s=t._milliseconds,r=t._days,o=t._months;s&&e._d.setTime(+e+s*n),r&&e.date(e.date()+r*n),o&&(i=e.date(),e.date(1).month(e.month()+o*n).date(Math.min(i,e.daysInMonth())))}function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function d(e,t){var n,i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),r=0;for(n=0;n<i;n++)~~e[n]!==~~t[n]&&r++;return r+s}function h(e,t){return t.abbr=e,L[e]||(L[e]=new i),L[e].set(t),L[e]}function f(e){return e?(!L[e]&&j&&console.error("We have manually edited the code to remove moments languages. Edit the moment.js source code line 508 to re-enable them."),L[e]):A.fn._lang}function p(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function m(e){var t,n,i=e.match(q);for(t=0,n=i.length;t<n;t++)se[i[t]]?i[t]=se[i[t]]:i[t]=p(i[t]);return function(s){var r="";for(t=0;t<n;t++)r+="function"==typeof i[t].call?i[t].call(s,e):i[t];return r}}function g(e,t){function n(t){return e.lang().longDateFormat(t)||t}for(var i=5;i--&&N.test(t);)t=t.replace(N,n);return te[t]||(te[t]=m(t)),te[t](e)}function v(e){switch(e){case"DDDD":return H;case"YYYY":return U;case"YYYYY":return Y;case"S":case"SS":case"SSS":case"DDD":return z;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return B;case"X":return X;case"Z":case"ZZ":return V;case"T":return W;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return R;default:return new RegExp(e.replace("\\",""))}}function b(e,t,n){var i,s=n._a;switch(e){case"M":case"MM":s[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":i=f(n._l).monthsParse(t),null!=i?s[1]=i:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(s[2]=~~t);break;case"YY":s[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":s[0]=~~t;break;case"a":case"A":n._isPm="pm"===(t+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":s[3]=~~t;break;case"m":case"mm":s[4]=~~t;break;case"s":case"ss":s[5]=~~t;break;case"S":case"SS":case"SSS":s[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,i=(t+"").match(Z),i&&i[1]&&(n._tzh=~~i[1]),i&&i[2]&&(n._tzm=~~i[2]),i&&"+"===i[0]&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}null==t&&(n._isValid=!1)}function y(e){var t,n,i=[];if(!e._d){for(t=0;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];i[3]+=e._tzh||0,i[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(i[0],i[1],i[2]),n.setUTCHours(i[3],i[4],i[5],i[6])):(n.setFullYear(i[0],i[1],i[2]),n.setHours(i[3],i[4],i[5],i[6])),e._d=n}}function w(e){var t,n,i=e._f.match(q),s=e._i;for(e._a=[],t=0;t<i.length;t++)n=(v(i[t]).exec(s)||[])[0],n&&(s=s.slice(s.indexOf(n)+n.length)),se[i[t]]&&b(i[t],n,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),y(e)}function k(e){for(var t,n,i,r,a=99;e._f.length;){if(t=o({},e),t._f=e._f.pop(),w(t),n=new s(t),n.isValid()){i=n;break}r=d(t._a,n.toArray()),r<a&&(a=r,i=n)}o(e,i)}function _(e){var t,n=e._i;if(G.exec(n)){for(e._f="YYYY-MM-DDT",t=0;t<4;t++)if(J[t][1].exec(n)){e._f+=J[t][0];break}V.exec(n)&&(e._f+=" Z"),w(e)}else e._d=new Date(n)}function x(t){var n=t._i,i=O.exec(n);n===e?t._d=new Date:i?t._d=new Date((+i[1])):"string"==typeof n?_(t):u(n)?(t._a=n.slice(0),y(t)):t._d=n instanceof Date?new Date((+n)):new Date(n)}function C(e,t,n,i,s){return s.relativeTime(t||1,!!n,e,i)}function F(e,t,n){var i=I(Math.abs(e)/1e3),s=I(i/60),r=I(s/60),o=I(r/24),a=I(o/365),l=i<45&&["s",i]||1===s&&["m"]||s<45&&["mm",s]||1===r&&["h"]||r<22&&["hh",r]||1===o&&["d"]||o<=25&&["dd",o]||o<=45&&["M"]||o<345&&["MM",I(o/30)]||1===a&&["y"]||["yy",a];return l[2]=t,l[3]=e>0,l[4]=n,C.apply({},l)}function S(e,t,n){var i=n-t,s=n-e.day();return s>i&&(s-=7),s<i-7&&(s+=7),Math.ceil(A(e).add("d",s).dayOfYear()/7)}function T(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=f().preparse(t)),A.isMoment(t)?(e=o({},t),e._d=new Date((+t._d))):n?u(n)?k(e):w(e):x(e),new s(e))}function E(e,t){A.fn[e]=A.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}function D(e){A.duration.fn[e]=function(){return this._data[e]}}function M(e,t){A.duration.fn["as"+e]=function(){return+this/t}}for(var A,$,P="2.0.0",I=Math.round,L={},j="undefined"!=typeof module&&module.exports,O=/^\/?Date\((\-?\d+)/i,q=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,N=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,R=/\d\d?/,z=/\d{1,3}/,H=/\d{3}/,U=/\d{1,4}/,Y=/[+\-]?\d{1,6}/,B=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,V=/Z|[\+\-]\d\d:?\d\d/i,W=/T/i,X=/[\+\-]?\d+(\.\d{1,3})?/,G=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,K="YYYY-MM-DDTHH:mm:ssZ",J=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Z=/([\+\-]|\d\d)/gi,Q="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),ee={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},te={},ne="DDD w W M D d".split(" "),ie="M D H h m s w W".split(" "),se={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return l(this.year()%100,2)},YYYY:function(){return l(this.year(),4)},YYYYY:function(){return l(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return l(~~(this.milliseconds()/10),2)},SSS:function(){return l(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+l(~~(e/60),2)+":"+l(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+l(~~(10*e/6),4)},X:function(){return this.unix()}};ne.length;)$=ne.pop(),se[$+"o"]=n(se[$]);for(;ie.length;)$=ie.pop(),se[$+$]=t(se[$],2);for(se.DDDD=t(se.DDD,3),i.prototype={set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(n=A([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var s=this._relativeTime[n];return"function"==typeof s?s(e,t,n,i):s.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return S(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},A=function(e,t,n){return T({_i:e,_f:t,_l:n,_isUTC:!1})},A.utc=function(e,t,n){return T({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},A.unix=function(e){return A(1e3*e)},A.duration=function(e,t){var n,i=A.isDuration(e),s="number"==typeof e,o=i?e._data:s?{}:e;return s&&(t?o[t]=e:o.milliseconds=e),n=new r(o),i&&e.hasOwnProperty("_lang")&&(n._lang=e._lang),n},A.version=P,A.defaultFormat=K,A.lang=function(e,t){return e?(t?h(e,t):L[e]||f(e),void(A.duration.fn._lang=A.fn._lang=f(e))):A.fn._lang._abbr},A.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),f(e)},A.isMoment=function(e){return e instanceof s},A.isDuration=function(e){return e instanceof r},A.fn=s.prototype={clone:function(){return A(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return A.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._a?this._isValid=!d(this._a,(this._isUTC?A.utc(this._a):A(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){var t=g(this,e||A.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?A.duration(+t,e):A.duration(e,t),c(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?A.duration(+t,e):A.duration(e,t),c(this,n,-1),this},diff:function(e,t,n){var i,s,r=this._isUTC?A(e).utc():A(e).local(),o=6e4*(this.zone()-r.zone());return t&&(t=t.replace(/s$/,"")),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+r.daysInMonth()),s=12*(this.year()-r.year())+(this.month()-r.month()),s+=(this-A(this).startOf("month")-(r-A(r).startOf("month")))/i,"year"===t&&(s/=12)):(i=this-r-o,s="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?i/864e5:"week"===t?i/6048e5:i),n?s:a(s)},from:function(e,t){
return A.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(A(),e)},calendar:function(){var e=this.diff(A().startOf("day"),"days",!0),t=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<A([this.year()]).zone()||this.zone()<A([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==e?t:this.add({d:e-t})},startOf:function(e){switch(e=e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+A(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+A(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+A(e).startOf(t)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return A.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=I((A(this).startOf("day")-A(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},isoWeek:function(e){var t=S(this,1,4);return null==e?t:this.add("d",7*(e-t))},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},lang:function(t){return t===e?this._lang:(this._lang=f(t),this)}},$=0;$<Q.length;$++)E(Q[$].toLowerCase().replace(/s$/,""),Q[$]);E("year","FullYear"),A.fn.days=A.fn.day,A.fn.weeks=A.fn.week,A.fn.isoWeeks=A.fn.isoWeek,A.duration.fn=r.prototype={weeks:function(){return a(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(e){var t=+this,n=F(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:A.fn.lang};for($ in ee)ee.hasOwnProperty($)&&(M($,ee[$]),D($.toLowerCase()));M("Weeks",6048e5),A.lang("en",{ordinal:function(e){var t=e%10,n=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),j&&(module.exports=A),"undefined"==typeof ender&&(this.moment=A),"function"==typeof define&&define.amd&&define("moment",[],function(){return A})}.call(this),function(e){e.fn.shorten=function(t){"use strict";if(e(this).data("jquery.shorten"))return!1;e(this).data("jquery.shorten",!0);var n={showChars:100,ellipsesText:"...",moreText:"more",lessText:"less",errMsg:null};return t&&e.extend(n,t),e(document).off("click",".morelink"),e(document).on({click:function(){var t=e(this);return t.hasClass("less")?(t.removeClass("less"),t.html(n.moreText),t.parent().prev().prev().show(),t.parent().prev().hide()):(t.addClass("less"),t.html(n.lessText),t.parent().prev().prev().hide(),t.parent().prev().show()),!1}},".morelink"),this.each(function(){var t=e(this),i=t.html(),s=t.text().length;if(s>n.showChars){var r=i.substr(0,n.showChars);if(r.indexOf("<")>=0){for(var o=!1,a="",l=0,c=[],u=null,d=0,h=0;h<=n.showChars;d++)if("<"!=i[d]||o||(o=!0,u=i.substring(d+1,i.indexOf(">",d)),"/"==u[0]?u!="/"+c[0]?n.errMsg="ERROR en HTML: the top of the stack should be the tag that closes":c.shift():"br"!=u.toLowerCase()&&c.unshift(u)),o&&">"==i[d]&&(o=!1),o)a+=i.charAt(d);else if(h++,l<=n.showChars)a+=i.charAt(d),l++;else if(c.length>0){for(j=0;j<c.length;j++)a+="</"+c[j]+">";break}r=e("<div/>").html(a+'<span class="ellip">'+n.ellipsesText+"</span>").html()}var f='<div class="shortcontent">'+r+'</div><div class="allcontent">'+i+'</div><span><a href="javascript://nop/" class="morelink">'+n.moreText+"</a></span>";t.html(f),t.find(".allcontent").hide(),e(".shortcontent p:last",t).css("margin-bottom",0)}})}}(jQuery),define("shorten",function(){}),define("adamantium/collection",["require","exports","module","backbone"],function(e,t,n){var i=e("backbone");return i.Collection.extend({setupToggle:function(e){var t=[],n=!1,i=_.bind(function(){if(!n&&(n=!0,!t.length&&this.length)){var i={};i[e]=!0,this.where(i).length||s(o())}},this),s=_.bind(function(n){if(n){if(!n.get(e))return void n.set(e,!0);n.cid!==_.last(t)&&t.push(n.cid);for(var i=0,s=this.length;i<s;i++)this.models[i].cid!==n.cid&&this.models[i].set(e,!1)}},this),r=_.bind(function(){if(t.length){var e=t.pop();return t.length?this.get(t.pop()):o(e)}},this),o=_.bind(function(e){if(this.length){var t=this.length-1;return e&&e===this.models[t].cid&&t--,t>=0?this.models[t]:void 0}},this),a=function(e,n,i){n?s(e):e.cid===_.last(t)?s(r()):t.length||s(o(e.cid))},l=function(n){!n.get(e)&&t.length||s(n)},c=function(n){n.get(e)&&(this.models.length?s(r()||o()):t=[])},u=function(n,i){var r={};r[e]=!0,t=[],s(_.first(this.where(r))||o())};this.on("add",l,this),this.on("remove",c,this),this.on("reset",u,this),this.on("change:"+e,a,this),_.defer(i)}})}),function e(t,n,i){function s(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return s(n?n:e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(e,t,n){function i(e){e.fn.perfectScrollbar=function(t){return this.each(function(){if("object"==typeof t||"undefined"==typeof t){var n=t;r.get(this)||s.initialize(this,n)}else{var i=t;"update"===i?s.update(this):"destroy"===i&&s.destroy(this)}return e(this)})}}var s=e("../main"),r=e("../plugin/instances");if("function"==typeof define&&define.amd)define("vendor/jquery/perfect-scrollbar.jquery",["jquery"],i);else{var o=window.jQuery?window.jQuery:window.$;"undefined"!=typeof o&&i(o)}t.exports=i},{"../main":7,"../plugin/instances":18}],2:[function(e,t,n){function i(e,t){var n=e.className.split(" ");n.indexOf(t)<0&&n.push(t),e.className=n.join(" ")}function s(e,t){var n=e.className.split(" "),i=n.indexOf(t);i>=0&&n.splice(i,1),e.className=n.join(" ")}n.add=function(e,t){e.classList?e.classList.add(t):i(e,t)},n.remove=function(e,t){e.classList?e.classList.remove(t):s(e,t)},n.list=function(e){return e.classList?e.classList:e.className.split(" ")}},{}],3:[function(e,t,n){function i(e,t){return window.getComputedStyle(e)[t]}function s(e,t,n){return"number"==typeof n&&(n=n.toString()+"px"),e.style[t]=n,e}function r(e,t){for(var n in t){var i=t[n];"number"==typeof i&&(i=i.toString()+"px"),e.style[n]=i}return e}n.e=function(e,t){var n=document.createElement(e);return n.className=t,n},n.appendTo=function(e,t){return t.appendChild(e),e},n.css=function(e,t,n){return"object"==typeof t?r(e,t):"undefined"==typeof n?i(e,t):s(e,t,n)},n.matches=function(e,t){return"undefined"!=typeof e.matches?e.matches(t):"undefined"!=typeof e.matchesSelector?e.matchesSelector(t):"undefined"!=typeof e.webkitMatchesSelector?e.webkitMatchesSelector(t):"undefined"!=typeof e.mozMatchesSelector?e.mozMatchesSelector(t):"undefined"!=typeof e.msMatchesSelector?e.msMatchesSelector(t):void 0},n.remove=function(e){"undefined"!=typeof e.remove?e.remove():e.parentNode.removeChild(e)}},{}],4:[function(e,t,n){var i=function(e){this.element=e,this.events={}};i.prototype.bind=function(e,t){"undefined"==typeof this.events[e]&&(this.events[e]=[]),this.events[e].push(t),this.element.addEventListener(e,t,!1)},i.prototype.unbind=function(e,t){var n="undefined"!=typeof t;this.events[e]=this.events[e].filter(function(i){return!(!n||i===t)||(this.element.removeEventListener(e,i,!1),!1)},this)},i.prototype.unbindAll=function(){for(var e in this.events)this.unbind(e)};var s=function(){this.eventElements=[]};s.prototype.eventElement=function(e){var t=this.eventElements.filter(function(t){return t.element===e})[0];return"undefined"==typeof t&&(t=new i(e),this.eventElements.push(t)),t},s.prototype.bind=function(e,t,n){this.eventElement(e).bind(t,n)},s.prototype.unbind=function(e,t,n){this.eventElement(e).unbind(t,n)},s.prototype.unbindAll=function(){for(var e=0;e<this.eventElements.length;e++)this.eventElements[e].unbindAll()},s.prototype.once=function(e,t,n){var i=this.eventElement(e),s=function(e){i.unbind(t,s),n(e)};i.bind(t,s)},t.exports=s},{}],5:[function(e,t,n){t.exports=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}()},{}],6:[function(e,t,n){var i=e("./class"),s=e("./dom");n.toInt=function(e){return"string"==typeof e?parseInt(e,10):~~e},n.clone=function(e){if(null===e)return null;if("object"==typeof e){var t={};for(var n in e)t[n]=this.clone(e[n]);return t}return e},n.extend=function(e,t){var n=this.clone(e);for(var i in t)n[i]=this.clone(t[i]);return n},n.isEditable=function(e){return s.matches(e,"input,[contenteditable]")||s.matches(e,"select,[contenteditable]")||s.matches(e,"textarea,[contenteditable]")||s.matches(e,"button,[contenteditable]")},n.removePsClasses=function(e){for(var t=i.list(e),n=0;n<t.length;n++){var s=t[n];0===s.indexOf("ps-")&&i.remove(e,s)}},n.outerWidth=function(e){return this.toInt(s.css(e,"width"))+this.toInt(s.css(e,"paddingLeft"))+this.toInt(s.css(e,"paddingRight"))+this.toInt(s.css(e,"borderLeftWidth"))+this.toInt(s.css(e,"borderRightWidth"))},n.startScrolling=function(e,t){i.add(e,"ps-in-scrolling"),"undefined"!=typeof t?i.add(e,"ps-"+t):(i.add(e,"ps-x"),i.add(e,"ps-y"))},n.stopScrolling=function(e,t){i.remove(e,"ps-in-scrolling"),"undefined"!=typeof t?i.remove(e,"ps-"+t):(i.remove(e,"ps-x"),i.remove(e,"ps-y"))},n.env={isWebKit:"WebkitAppearance"in document.documentElement.style,supportsTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportsIePointer:null!==window.navigator.msMaxTouchPoints}},{"./class":2,"./dom":3}],7:[function(e,t,n){var i=e("./plugin/destroy"),s=e("./plugin/initialize"),r=e("./plugin/update");t.exports={initialize:s,update:r,destroy:i}},{"./plugin/destroy":9,"./plugin/initialize":17,"./plugin/update":20}],8:[function(e,t,n){t.exports={wheelSpeed:1,wheelPropagation:!1,swipePropagation:!0,minScrollbarLength:null,maxScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0}},{}],9:[function(e,t,n){var i=e("../lib/dom"),s=e("../lib/helper"),r=e("./instances");t.exports=function(e){var t=r.get(e);t.event.unbindAll(),i.remove(t.scrollbarX),i.remove(t.scrollbarY),i.remove(t.scrollbarXRail),i.remove(t.scrollbarYRail),s.removePsClasses(e),r.remove(e)}},{"../lib/dom":3,"../lib/helper":6,"./instances":18}],10:[function(e,t,n){function i(e,t){function n(e){return e.getBoundingClientRect()}var i=window.Event.prototype.stopPropagation.bind;t.event.bind(t.scrollbarY,"click",i),t.event.bind(t.scrollbarYRail,"click",function(i){var r=s.toInt(t.scrollbarYHeight/2),a=i.pageY-n(t.scrollbarYRail).top-r,l=t.containerHeight-t.scrollbarYHeight,c=a/l;c<0?c=0:c>1&&(c=1),e.scrollTop=(t.contentHeight-t.containerHeight)*c,o(e)}),t.event.bind(t.scrollbarX,"click",i),t.event.bind(t.scrollbarXRail,"click",function(i){var r=s.toInt(t.scrollbarXWidth/2),a=i.pageX-n(t.scrollbarXRail).left-r,l=t.containerWidth-t.scrollbarXWidth,c=a/l;c<0?c=0:c>1&&(c=1),e.scrollLeft=(t.contentWidth-t.containerWidth)*c,o(e)})}var s=e("../../lib/helper"),r=e("../instances"),o=e("../update-geometry");t.exports=function(e){var t=r.get(e);i(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19}],11:[function(e,t,n){function i(e,t){function n(n){var s=i+n,r=t.containerWidth-t.scrollbarXWidth;s<0?t.scrollbarXLeft=0:s>r?t.scrollbarXLeft=r:t.scrollbarXLeft=s;var a=o.toInt(t.scrollbarXLeft*(t.contentWidth-t.containerWidth)/(t.containerWidth-t.scrollbarXWidth));e.scrollLeft=a}var i=null,s=null,a=function(t){n(t.pageX-s),l(e),t.stopPropagation(),t.preventDefault()},c=function(){o.stopScrolling(e,"x"),t.event.unbind(t.ownerDocument,"mousemove",a)};t.event.bind(t.scrollbarX,"mousedown",function(n){s=n.pageX,i=o.toInt(r.css(t.scrollbarX,"left")),o.startScrolling(e,"x"),t.event.bind(t.ownerDocument,"mousemove",a),t.event.once(t.ownerDocument,"mouseup",c),n.stopPropagation(),n.preventDefault()})}function s(e,t){function n(n){var s=i+n,r=t.containerHeight-t.scrollbarYHeight;s<0?t.scrollbarYTop=0:s>r?t.scrollbarYTop=r:t.scrollbarYTop=s;var a=o.toInt(t.scrollbarYTop*(t.contentHeight-t.containerHeight)/(t.containerHeight-t.scrollbarYHeight));e.scrollTop=a}var i=null,s=null,a=function(t){n(t.pageY-s),l(e),t.stopPropagation(),t.preventDefault()},c=function(){o.stopScrolling(e,"y"),t.event.unbind(t.ownerDocument,"mousemove",a)};t.event.bind(t.scrollbarY,"mousedown",function(n){s=n.pageY,i=o.toInt(r.css(t.scrollbarY,"top")),o.startScrolling(e,"y"),t.event.bind(t.ownerDocument,"mousemove",a),t.event.once(t.ownerDocument,"mouseup",c),n.stopPropagation(),n.preventDefault()})}var r=e("../../lib/dom"),o=e("../../lib/helper"),a=e("../instances"),l=e("../update-geometry");t.exports=function(e){var t=a.get(e);i(e,t),s(e,t)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19}],12:[function(e,t,n){function i(e,t){function n(n,i){var s=e.scrollTop;if(0===n){if(!t.scrollbarYActive)return!1;if(0===s&&i>0||s>=t.contentHeight-t.containerHeight&&i<0)return!t.settings.wheelPropagation}var r=e.scrollLeft;if(0===i){if(!t.scrollbarXActive)return!1;if(0===r&&n<0||r>=t.contentWidth-t.containerWidth&&n>0)return!t.settings.wheelPropagation}return!0}var i=!1;t.event.bind(e,"mouseenter",function(){i=!0}),t.event.bind(e,"mouseleave",function(){i=!1});var r=!1;t.event.bind(t.ownerDocument,"keydown",function(a){if((!a.isDefaultPrevented||!a.isDefaultPrevented())&&i){var l=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(l){for(;l.shadowRoot;)l=l.shadowRoot.activeElement;if(s.isEditable(l))return}var c=0,u=0;switch(a.which){case 37:c=-30;break;case 38:u=30;break;case 39:c=30;break;case 40:u=-30;break;case 33:u=90;break;case 32:case 34:u=-90;break;case 35:u=a.ctrlKey?-t.contentHeight:-t.containerHeight;break;case 36:u=a.ctrlKey?e.scrollTop:t.containerHeight;break;default:return}e.scrollTop=e.scrollTop-u,e.scrollLeft=e.scrollLeft+c,o(e),r=n(c,u),r&&a.preventDefault()}})}var s=e("../../lib/helper"),r=e("../instances"),o=e("../update-geometry");t.exports=function(e){var t=r.get(e);i(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19}],13:[function(e,t,n){function i(e,t){function n(n,i){var s=e.scrollTop;if(0===n){if(!t.scrollbarYActive)return!1;if(0===s&&i>0||s>=t.contentHeight-t.containerHeight&&i<0)return!t.settings.wheelPropagation}var r=e.scrollLeft;if(0===i){if(!t.scrollbarXActive)return!1;if(0===r&&n<0||r>=t.contentWidth-t.containerWidth&&n>0)return!t.settings.wheelPropagation}return!0}function i(e){var t=e.deltaX,n=-1*e.deltaY;return"undefined"!=typeof t&&"undefined"!=typeof n||(t=-1*e.wheelDeltaX/6,n=e.wheelDeltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,n*=10),t!==t&&n!==n&&(t=0,n=e.wheelDelta),[t,n]}function r(r){if(s.env.isWebKit||!e.querySelector("select:focus")){var l=i(r),c=l[0],u=l[1];a=!1,t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(u?e.scrollTop=e.scrollTop-u*t.settings.wheelSpeed:e.scrollTop=e.scrollTop+c*t.settings.wheelSpeed,a=!0):t.scrollbarXActive&&!t.scrollbarYActive&&(c?e.scrollLeft=e.scrollLeft+c*t.settings.wheelSpeed:e.scrollLeft=e.scrollLeft-u*t.settings.wheelSpeed,a=!0):(e.scrollTop=e.scrollTop-u*t.settings.wheelSpeed,e.scrollLeft=e.scrollLeft+c*t.settings.wheelSpeed),o(e),a=a||n(c,u),a&&(r.stopPropagation(),r.preventDefault())}}var a=!1;"undefined"!=typeof window.onwheel?t.event.bind(e,"wheel",r):"undefined"!=typeof window.onmousewheel&&t.event.bind(e,"mousewheel",r)}var s=e("../../lib/helper"),r=e("../instances"),o=e("../update-geometry");t.exports=function(e){var t=r.get(e);i(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19}],14:[function(e,t,n){function i(e,t){t.event.bind(e,"scroll",function(){r(e)})}var s=e("../instances"),r=e("../update-geometry");t.exports=function(e){var t=s.get(e);i(e,t)}},{"../instances":18,"../update-geometry":19}],15:[function(e,t,n){function i(e,t){function n(){var e=window.getSelection?window.getSelection():document.getSelection?document.getSelection():"";return 0===e.toString().length?null:e.getRangeAt(0).commonAncestorContainer}function i(){l||(l=setInterval(function(){return r.get(e)?(e.scrollTop=e.scrollTop+c.top,e.scrollLeft=e.scrollLeft+c.left,void o(e)):void clearInterval(l)},50))}function a(){l&&(clearInterval(l),l=null),s.stopScrolling(e)}var l=null,c={top:0,left:0},u=!1;t.event.bind(t.ownerDocument,"selectionchange",function(){e.contains(n())?u=!0:(u=!1,a())}),t.event.bind(window,"mouseup",function(){u&&(u=!1,a())}),t.event.bind(window,"mousemove",function(t){if(u){var n={x:t.pageX,y:t.pageY},r={left:e.offsetLeft,right:e.offsetLeft+e.offsetWidth,top:e.offsetTop,bottom:e.offsetTop+e.offsetHeight};n.x<r.left+3?(c.left=-5,s.startScrolling(e,"x")):n.x>r.right-3?(c.left=5,s.startScrolling(e,"x")):c.left=0,n.y<r.top+3?(r.top+3-n.y<5?c.top=-5:c.top=-20,s.startScrolling(e,"y")):n.y>r.bottom-3?(n.y-r.bottom+3<5?c.top=5:c.top=20,s.startScrolling(e,"y")):c.top=0,0===c.top&&0===c.left?a():i()}})}var s=e("../../lib/helper"),r=e("../instances"),o=e("../update-geometry");t.exports=function(e){var t=r.get(e);i(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19}],16:[function(e,t,n){function i(e,t,n,i){function o(n,i){var s=e.scrollTop,r=e.scrollLeft,o=Math.abs(n),a=Math.abs(i);if(a>o){if(i<0&&s===t.contentHeight-t.containerHeight||i>0&&0===s)return!t.settings.swipePropagation}else if(o>a&&(n<0&&r===t.contentWidth-t.containerWidth||n>0&&0===r))return!t.settings.swipePropagation;return!0}function a(t,n){e.scrollTop=e.scrollTop-n,e.scrollLeft=e.scrollLeft-t,r(e)}function l(){y=!0}function c(){y=!1}function u(e){return e.targetTouches?e.targetTouches[0]:e}function d(e){return!(!e.targetTouches||1!==e.targetTouches.length)||!(!e.pointerType||"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)}function h(e){if(d(e)){w=!0;var t=u(e);m.pageX=t.pageX,m.pageY=t.pageY,g=(new Date).getTime(),null!==b&&clearInterval(b),e.stopPropagation()}}function f(e){if(!y&&w&&d(e)){var t=u(e),n={pageX:t.pageX,pageY:t.pageY},i=n.pageX-m.pageX,s=n.pageY-m.pageY;a(i,s),m=n;var r=(new Date).getTime(),l=r-g;l>0&&(v.x=i/l,v.y=s/l,g=r),o(i,s)&&(e.stopPropagation(),e.preventDefault())}}function p(){!y&&w&&(w=!1,clearInterval(b),b=setInterval(function(){return s.get(e)?Math.abs(v.x)<.01&&Math.abs(v.y)<.01?void clearInterval(b):(a(30*v.x,30*v.y),v.x*=.8,void(v.y*=.8)):void clearInterval(b)},10))}var m={},g=0,v={},b=null,y=!1,w=!1;n&&(t.event.bind(window,"touchstart",l),t.event.bind(window,"touchend",c),t.event.bind(e,"touchstart",h),t.event.bind(e,"touchmove",f),t.event.bind(e,"touchend",p)),i&&(window.PointerEvent?(t.event.bind(window,"pointerdown",l),t.event.bind(window,"pointerup",c),t.event.bind(e,"pointerdown",h),t.event.bind(e,"pointermove",f),t.event.bind(e,"pointerup",p)):window.MSPointerEvent&&(t.event.bind(window,"MSPointerDown",l),t.event.bind(window,"MSPointerUp",c),t.event.bind(e,"MSPointerDown",h),t.event.bind(e,"MSPointerMove",f),t.event.bind(e,"MSPointerUp",p)))}var s=e("../instances"),r=e("../update-geometry");t.exports=function(e,t,n){var r=s.get(e);i(e,r,t,n)}},{"../instances":18,"../update-geometry":19}],17:[function(e,t,n){var i=e("../lib/class"),s=e("../lib/helper"),r=e("./instances"),o=e("./update-geometry"),a=e("./handler/click-rail"),l=e("./handler/drag-scrollbar"),c=e("./handler/keyboard"),u=e("./handler/mouse-wheel"),d=e("./handler/native-scroll"),h=e("./handler/selection"),f=e("./handler/touch");t.exports=function(e,t){t="object"==typeof t?t:{},i.add(e,"ps-container");var n=r.add(e);n.settings=s.extend(n.settings,t),a(e),l(e),u(e),d(e),h(e),(s.env.supportsTouch||s.env.supportsIePointer)&&f(e,s.env.supportsTouch,s.env.supportsIePointer),n.settings.useKeyboard&&c(e),o(e)}},{"../lib/class":2,"../lib/helper":6,"./handler/click-rail":10,"./handler/drag-scrollbar":11,"./handler/keyboard":12,"./handler/mouse-wheel":13,"./handler/native-scroll":14,"./handler/selection":15,"./handler/touch":16,"./instances":18,"./update-geometry":19}],18:[function(e,t,n){function i(e){var t=this;t.settings=d.clone(l),t.containerWidth=null,t.containerHeight=null,t.contentWidth=null,t.contentHeight=null,t.isRtl="rtl"===a.css(e,"direction"),t.event=new c,t.ownerDocument=e.ownerDocument||document,t.scrollbarXRail=a.appendTo(a.e("div","ps-scrollbar-x-rail"),e),t.scrollbarX=a.appendTo(a.e("div","ps-scrollbar-x"),t.scrollbarXRail),t.scrollbarXActive=null,t.scrollbarXWidth=null,t.scrollbarXLeft=null,t.scrollbarXBottom=d.toInt(a.css(t.scrollbarXRail,"bottom")),t.isScrollbarXUsingBottom=t.scrollbarXBottom===t.scrollbarXBottom,t.scrollbarXTop=t.isScrollbarXUsingBottom?null:d.toInt(a.css(t.scrollbarXRail,"top")),t.railBorderXWidth=d.toInt(a.css(t.scrollbarXRail,"borderLeftWidth"))+d.toInt(a.css(t.scrollbarXRail,"borderRightWidth")),t.railXMarginWidth=d.toInt(a.css(t.scrollbarXRail,"marginLeft"))+d.toInt(a.css(t.scrollbarXRail,"marginRight")),t.railXWidth=null,t.scrollbarYRail=a.appendTo(a.e("div","ps-scrollbar-y-rail"),e),t.scrollbarY=a.appendTo(a.e("div","ps-scrollbar-y"),t.scrollbarYRail),t.scrollbarYActive=null,t.scrollbarYHeight=null,t.scrollbarYTop=null,t.scrollbarYRight=d.toInt(a.css(t.scrollbarYRail,"right")),t.isScrollbarYUsingRight=t.scrollbarYRight===t.scrollbarYRight,t.scrollbarYLeft=t.isScrollbarYUsingRight?null:d.toInt(a.css(t.scrollbarYRail,"left")),t.scrollbarYOuterWidth=t.isRtl?d.outerWidth(t.scrollbarY):null,t.railBorderYWidth=d.toInt(a.css(t.scrollbarYRail,"borderTopWidth"))+d.toInt(a.css(t.scrollbarYRail,"borderBottomWidth")),t.railYMarginHeight=d.toInt(a.css(t.scrollbarYRail,"marginTop"))+d.toInt(a.css(t.scrollbarYRail,"marginBottom")),t.railYHeight=null}function s(e){return"undefined"==typeof e.dataset?e.getAttribute("data-ps-id"):e.dataset.psId}function r(e,t){"undefined"==typeof e.dataset?e.setAttribute("data-ps-id",t):e.dataset.psId=t}function o(e){"undefined"==typeof e.dataset?e.removeAttribute("data-ps-id"):delete e.dataset.psId}var a=e("../lib/dom"),l=e("./default-setting"),c=e("../lib/event-manager"),u=e("../lib/guid"),d=e("../lib/helper"),h={};n.add=function(e){var t=u();return r(e,t),h[t]=new i(e),h[t]},n.remove=function(e){delete h[s(e)],o(e)},n.get=function(e){return h[s(e)]}},{"../lib/dom":3,"../lib/event-manager":4,"../lib/guid":5,"../lib/helper":6,"./default-setting":8}],19:[function(e,t,n){function i(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}function s(e,t){var n={width:t.railXWidth};t.isRtl?n.left=e.scrollLeft+t.containerWidth-t.contentWidth:n.left=e.scrollLeft,t.isScrollbarXUsingBottom?n.bottom=t.scrollbarXBottom-e.scrollTop:n.top=t.scrollbarXTop+e.scrollTop,o.css(t.scrollbarXRail,n);var i={top:e.scrollTop,height:t.railYHeight};t.isScrollbarYUsingRight?t.isRtl?i.right=t.contentWidth-e.scrollLeft-t.scrollbarYRight-t.scrollbarYOuterWidth:i.right=t.scrollbarYRight-e.scrollLeft:t.isRtl?i.left=e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:i.left=t.scrollbarYLeft+e.scrollLeft,o.css(t.scrollbarYRail,i),o.css(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),o.css(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}var r=e("../lib/class"),o=e("../lib/dom"),a=e("../lib/helper"),l=e("./instances");t.exports=function(e){var t=l.get(e);t.containerWidth=e.clientWidth,t.containerHeight=e.clientHeight,t.contentWidth=e.scrollWidth,t.contentHeight=e.scrollHeight,!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth?(t.scrollbarXActive=!0,t.railXWidth=t.containerWidth-t.railXMarginWidth,t.scrollbarXWidth=i(t,a.toInt(t.railXWidth*t.containerWidth/t.contentWidth)),t.scrollbarXLeft=a.toInt(e.scrollLeft*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))):(t.scrollbarXActive=!1,t.scrollbarXWidth=0,t.scrollbarXLeft=0,e.scrollLeft=0),!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight?(t.scrollbarYActive=!0,t.railYHeight=t.containerHeight-t.railYMarginHeight,t.scrollbarYHeight=i(t,a.toInt(t.railYHeight*t.containerHeight/t.contentHeight)),t.scrollbarYTop=a.toInt(e.scrollTop*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))):(t.scrollbarYActive=!1,t.scrollbarYHeight=0,t.scrollbarYTop=0,e.scrollTop=0),t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth&&(t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth),t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight&&(t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight),s(e,t),r[t.scrollbarXActive?"add":"remove"](e,"ps-active-x"),r[t.scrollbarYActive?"add":"remove"](e,"ps-active-y")}},{"../lib/class":2,"../lib/dom":3,"../lib/helper":6,"./instances":18}],20:[function(e,t,n){var i=e("../lib/dom"),s=e("./destroy"),r=e("./initialize"),o=e("./instances"),a=e("./update-geometry");t.exports=function(e){var t=o.get(e);t.scrollbarXRail&&e.contains(t.scrollbarXRail)&&t.scrollbarYRail&&e.contains(t.scrollbarYRail)?(i.css(t.scrollbarXRail,"display","none"),i.css(t.scrollbarYRail,"display","none"),a(e),i.css(t.scrollbarXRail,"display","block"),i.css(t.scrollbarYRail,"display","block")):(s(e),r(e))}},{"../lib/dom":3,"./destroy":9,"./initialize":17,"./instances":18,"./update-geometry":19}]},{},[1]),function(e){"function"==typeof define&&define.amd?define("vendor/transit",["jquery"],e):e(jQuery)}(function(e){"use strict";function t(e){var t=["Moz","Webkit","O","ms"],n=e.charAt(0).toUpperCase()+e.substr(1);if(e in d.style)return e;for(var i=0;i<t.length;++i){var s=t[i]+n;if(s in d.style)return s}}function n(){return d.style[h.transform]="",d.style[h.transform]="rotateY(90deg)",""!==d.style[h.transform]}function i(e){return"string"==typeof e&&this.parse(e),this}function s(e,t,n){t===!0?e.queue(n):t?e.queue(t,n):n()}function r(t){var n=[];for(var i in t)t.hasOwnProperty(i)&&(i=e.camelCase(i),i=e.transit.propertyMap[i]||i,i=l(i)),e.inArray(i,n)===-1&&n.push(i);return n}function o(t,n,i,s){var o=r(t);e.cssEase[i]&&(i=e.cssEase[i]);var a=""+u(n)+" "+i;parseInt(s,10)>0&&(a+=" "+u(s));for(var l=[],c=0;c<o.length;c++){var d=o[c];l.push(d+" "+a)}return l.join(", ")}function a(t,n){n||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=h.transform,e.cssHooks[t]={get:function(n){var i=e(n).css("transit:transform");return i.get(t)},set:function(n,i){var s=e(n),r=s.css("transit:transform");r.setFromString(t,i),s.css("transit:transform",r)}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function c(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function u(t){var n=t;return e.fx.speeds[n]&&(n=e.fx.speeds[n]),c(n,"ms")}e.transit={version:"0.1.3",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var d=document.createElement("div"),h={},f=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;h.transition=t("transition"),h.transitionDelay=t("transitionDelay"),h.transform=t("transform"),h.transformOrigin=t("transformOrigin"),h.transform3d=n(),e.extend(e.support,h);var p={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},m=h.transitionEnd=p[h.transition]||null;d=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new i},set:function(t,n){var s=n;s instanceof i||(s=new i(s)),"WebkitTransform"!==h.transform||f?t.style[h.transform]=s.toString():t.style[h.transform]=s.toString(!0),e(t).data("transform",s)}},e.fn.jquery<"1.8.0"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[h.transformOrigin]},set:function(e,t){e.style[h.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[h.transition]},set:function(e,t){e.style[h.transition]=t}}),a("scale"),a("translate"),a("rotate"),a("rotateX"),a("rotateY"),a("rotate3d"),a("perspective"),a("skewX"),a("skewY"),a("x",!0),a("y",!0),i.prototype={setFromString:function(e,t){var n="string"==typeof t?t.split(","):t.constructor===Array?t:[t];n.unshift(e),i.prototype.set.apply(this,n)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=c(e,"deg")},rotateX:function(e){this.rotateX=c(e,"deg")},rotateY:function(e){this.rotateY=c(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=c(e,"deg")},skewY:function(e){this.skewY=c(e,"deg")},perspective:function(e){this.perspective=c(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&(this._translateX=c(e,"px")),null!==t&&(this._translateY=c(t,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;t<=3;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=c(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,n,i){t.setFromString(n,i)})},toString:function(e){var t=[];for(var n in this)if(this.hasOwnProperty(n)){if(!h.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&(e&&"scale"===n?t.push(n+"3d("+this[n]+",1)"):e&&"translate"===n?t.push(n+"3d("+this[n]+",0)"):t.push(n+"("+this[n]+")"))}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,n,i,r){var a=this,l=0,c=!0;"function"==typeof n&&(r=n,n=void 0),"function"==typeof i&&(r=i,i=void 0),"undefined"!=typeof t.easing&&(i=t.easing,delete t.easing),"undefined"!=typeof t.duration&&(n=t.duration,delete t.duration),"undefined"!=typeof t.complete&&(r=t.complete,delete t.complete),"undefined"!=typeof t.queue&&(c=t.queue,delete t.queue),"undefined"!=typeof t.delay&&(l=t.delay,delete t.delay),"undefined"==typeof n&&(n=e.fx.speeds._default),"undefined"==typeof i&&(i=e.cssEase._default),n=u(n);var d=o(t,n,i,l),f=e.transit.enabled&&h.transition,p=f?parseInt(n,10)+parseInt(l,10):0;if(0===p){var g=function(e){a.css(t),r&&r.apply(a),e&&e()};return s(a,c,g),a}var v={},b=function(n){var i=!1,s=function(){if(i&&a.unbind(m,s),p>0)for(var e=0;e<a.length;e++){var t=a[e];t.style[h.transition]=v[t]||null}"function"==typeof r&&r.apply(a),"function"==typeof n&&n()};p>0&&m&&e.transit.useTransitionEnd?(i=!0,a.bind(m,s)):window.setTimeout(s,p);for(var o=0;o<a.length;o++){var l=a[o];p>0&&(l.style[h.transition]=d),e(l).css(t)}},y=function(e){var t=0;"MozTransition"===h.transition&&t<25&&(t=25),window.setTimeout(function(){b(e)},t)};return s(a,c,y),this},e.transit.getTransitionValue=o}),define("shared/plugins/flash",["require","jquery"],function(e){var t=e("jquery"),n=function(e){this.description=e};return n.prototype.render=function(){var e=this.description,n=t("<div/>",{"class":"flash flash-warning"
}).append(t("<div/>",{"class":"container",text:e}));if(t("body").addClass("has-flash").append(n),t("#wrap").hasClass("site-banner-seen")){var i=t("#site-banner").outerHeight();n.css({top:i})}n.addClass("flash-show")},n});