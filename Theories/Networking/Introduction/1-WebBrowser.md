# 第 1 章　Web浏览器


<!-- TOC -->

- [第 1 章　Web浏览器](#第-1-章　web浏览器)
    - [生成 HTTP 请求消息](#生成-http-请求消息)
        - [URL 的类型](#url-的类型)
        - [浏览器解析 URL](#浏览器解析-url)
        - [生成 HTTP 请求消息](#生成-http-请求消息-1)
    - [向 DNS 服务器查询 Web 服务器的 IP 地址](#向-dns-服务器查询-web-服务器的-ip-地址)
        - [IP 地址的基本知识](#ip-地址的基本知识)
            - [TCP/IP 的基本思路](#tcpip-的基本思路)
            - [IP 地址的组成](#ip-地址的组成)
    - [References](#references)

<!-- /TOC -->


## 生成 HTTP 请求消息
### URL 的类型
1. 之所以有各种各样的 URL，是因为尽管我们通常是使用浏览器来访问 Web 服务器的，但实际上浏览器并不只有这一个功能，它也可以用来在 FTP 服务器上下载和上传文件，同时也具备电子邮件客户端的功能。
2. 可以说，浏览器是一个具备多种客户端功能的综合性客户端软件，因此它需要一些东西来判断应该使用其中哪种功能来访问相应的数据，而各种不同的 URL 就是用来干这个的。
3. 下图列举了现在互联网中常见的几种 URL，根据访问目标的不同，URL 的写法也会不同
    <img src="./images/03.png" width="600" style="display: block; margin: 5px 0 10px;" />

### 浏览器解析 URL
1. 浏览器要做的第一步工作就是对 URL 进行解析，从而生成发送给 Web 服务器的请求消息。刚才我们已经讲过，URL 的格式会随着协议的不同而不同，因此下面我们以访问 Web 服务器的情况为例来进行讲解
    <img src="./images/04.png" width="600" style="display: block; margin: 5px 0 10px;" />
2. 根据 HTTP 的规格，URL 包含上图（a）中的这几种元素。当对 URL 进行解析时，首先需要按照上图（a）的格式将其中的各个元素拆分出来。
3. 例如上图（b）中的 URL 会拆分成（c）的样子。然后，通过拆分出来的这些元素，我们就能够明白 URL 代表的含义。

### 生成 HTTP 请求消息
1. 对 URL 进行解析之后，浏览器确定了 Web 服务器和文件名，接下来就是根据这些信息来生成 HTTP 请求消息了。
2. 实际上，HTTP 消息在格式上是有严格规定的，因此浏览器会按照规定的格式来生成请求消息
    <img src="./images/05.png" width="600" style="display: block; margin: 5px 0 10px;" />


## 向 DNS 服务器查询 Web 服务器的 IP 地址
### IP 地址的基本知识
1. 生成 HTTP 消息之后，接下来我们需要委托操作系统将消息发送给 Web 服务器。
2. 尽管浏览器能够解析网址并生成 HTTP 消息，但它本身并不具备将消息发送到网络中的功能，因此这一功能需要委托操作系统来实现。发送消息的功能对于所有的应用程序来说都是通用的，因此让操作系统来实现这一功能，其他应用程序委托操作系统来进行操作，这是一个比较合理的做法。
3. 在进行这一操作时，我们还有一个工作需要完成，那就是查询网址中服务器域名对应的 IP 地址。在委托操作系统发送消息时，必须要提供的不是通信对象的域名，而是它的 IP 地址。
4. 因此，在生成 HTTP 消息之后，下一个步骤就是根据域名查询 IP 地址。

#### TCP/IP 的基本思路
1. 互联网和公司内部的局域网都是基于 TCP/IP 的思路来设计的，所以我们先来了解 TCP/IP 的基本思路。
2. TCP/IP 的结构如下图所示，就是由一些小的子网，通过路由器连接起来组成一个大的网络
    <img src="./images/06.png" width="600" style="display: block; margin: 5px 0 10px;" />
3. 这里的子网可以理解为用集线器连接起来的几台计算机，我们将它看作一个单位，称为 **子网**。当计算机数量较少时，可以用一台集线器连接起来；当计算机数量较多时，一台集线器可能无法连接这么多计算机，可以增加集线器数量并将集线器相互连接起来，这时，凡是通过集线器连接起来的所有设备都属于同一个子网。
4. 将子网通过路由器连接起来，就形成了一个网络（一些家用路由器中已经内置了集线器功能，因此大家可以理解为这种路由器内部同时包含路由器和集线器两种设备，它们在里面已经连接起来了）。
5. 在网络中，所有的设备都会被分配一个 IP 地址。通过 IP 地址我们可以判断出访问对象服务器的位置，从而将消息发送到服务器。
6. 发送者发出的消息首先经过子网中的集线器，转发到距离发送者最近的路由器上（上图 ①）。接下来，路由器会根据消息的目的地判断下一个路由器的位置，然后将消息发送到下一个路由器，即消息再次经过子网内的集线器被转发到下一个路由器（上图 ②）。这个过程不断重复，最终消息就被传送到了目的地。

#### IP 地址的组成






## References
* [网络是怎样连接的](https://book.douban.com/subject/26941639/)