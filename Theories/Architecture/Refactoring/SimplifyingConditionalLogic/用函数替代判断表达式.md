# 用函数替代判断表达式


<!-- TOC -->

- [用函数替代判断表达式](#用函数替代判断表达式)
    - [思想](#思想)
    - [Motivation](#motivation)
    - [Mechanics](#mechanics)
    - [References](#references)

<!-- /TOC -->


## 思想



## Motivation
1. 经常会做这样的判断
    ```js
    // main.js
    if (this.$store.state.test.from === 'source1') {
        // ...
    }
    ```
2. 很明显的问题是，这个 `from` 和当前代码不在一个模块。
3. 那么做出这个判断的人，就必须要明确，`from` 确实有一个合理的值是 `source1`。如果 `from` 根本就不存在这个值，或者只是你拼写错了，那么这个判断就永远是 `false` 了。
4. 而且很有可能的情况是，设置 `from` 的地方，可能也并不是和 `from` 同一个模块，所以要做这个判断的人，还要去设值模块找到设置的值是什么。
5. 一个做法是，你在 `from` 模块里给每个可能的值都定义一个常量，然后设置和读取都使用对应的常量。这样你在设置和读取时，都必须正确引用那几个常量，否则就会报错。
    ```js
    if (this.$store.state.test.from === SOURCES.SOURCE1) {
        // ...
    }
    ```
6. 但其实还是不怎么方便，而且更重要的是，这个判断条件很不直观，没有做到意图和实现分离。所以还是按照 Extract Variable 这条重构规则进行重构，
    ```js
    // test.js
    getters: {
        isSrouce1 (state) {
            return state.from === 'source1'
        }
    }
    ```
    ```js
    // main.js
    if (this.$store.getters['test/isSrouce1']) {
        // ...
    }
    ```


## Mechanics


## References
* [《重构（第2版）》](https://book.douban.com/subject/33400354/)
