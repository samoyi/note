# 提前让函数退出代替嵌套条件分支


<!-- TOC -->

- [提前让函数退出代替嵌套条件分支](#提前让函数退出代替嵌套条件分支)
    - [思想](#思想)
        - [尽量维持大脑低内存运作](#尽量维持大脑低内存运作)
    - [Motivation](#motivation)
        - [例子](#例子)
    - [References](#references)

<!-- /TOC -->


## 思想
### 尽量维持大脑低内存运作
1. 一定要怕麻烦，一定要少动脑，思维一定要断舍离，而且要尽快的断舍离。
2. 要让自己的思维工作台（思维内存）高效的处理小任务，而不是耗时的处理整个大任务。


## Motivation
1. 带有嵌套条件分支的函数在写和看的时候，思维都是递归的，会一层一层的叠加条件栈，消耗大脑的内存。
2. 如果能在某些条件下提前返回，就可以及时的清空一层条件栈，减少大脑的内存消耗。

### 例子
1. 在思考某些比较复杂的逻辑分支场景时，我们会按照正常的逻辑顺序来理解逻辑分支。例如在思考一个删除操作时，正常的逻辑顺序是这样的：
    1. 首先，对象必须是可写的，或者说是非可读的；
    2. 然后，再看看对象是目录还是文件；
    3. 是目录则删除目录，是文件则删除文件。
2. 按照这个思路写下来的代码是这样的    
    ```js
    var del = function( obj ){
        var ret;
        if ( !obj.isReadOnly ){    // 不为只读的才能被删除
            if ( obj.isFolder ){    // 如果是目录
                ret = deleteFolder( obj );
            }
            else if ( obj.isFile ){    // 如果是文件
                ret = deleteFile( obj );
            }
        }
        return ret;
    };
    ```
3. 在你第一次把思考过程转换为代码时，这样写是方便的，因为它符合了思考的过程。
4. 但之后再看这一段时，就会有些麻烦。因为这里有嵌套的条件分支，在看内层条件时，大脑同时也要维护外层的条件断，因为两者是且的关系。
5. 而且还很讨厌的有一个取反操作，又进一步增加了理解的负担。取反也是一种嵌套思维：要先思考取反前的值，然后再思考对其取反的值。
6. 应该尽可能的通过取消代码的嵌套来取消思维的嵌套
    ```js
    var del = function( obj ){
        if ( obj.isReadOnly ){    // 反转 if 表达式
            return; // 立刻清空思维调用栈，这之前的逻辑完全清除出大脑
        }
        // 下面这两个把上面平级的两个也拆分了，但感觉意义不大
        // 因为平级的 if  else if 关系，本来就是每走一步就完全不考虑之前的条件了
        if ( obj.isFolder ){
            return deleteFolder( obj );
        }
        if ( obj.isFile ){
            return deleteFile( obj );
        }
    };
    ```


## References
* [《JavaScript设计模式与开发实践》](https://book.douban.com/subject/26382780/)
