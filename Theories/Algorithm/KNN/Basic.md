# K-Nearest Neighbor


<!-- TOC -->

- [K-Nearest Neighbor](#k-nearest-neighbor)
    - [设计思想](#设计思想)
        - [没有明显界限的分组](#没有明显界限的分组)
    - [本质](#本质)
        - [分组的本质——根据特征值](#分组的本质根据特征值)
    - [用途](#用途)
    - [思路](#思路)
    - [创建推荐系统](#创建推荐系统)
        - [特征抽取](#特征抽取)
            - [K 的数量](#k-的数量)
            - [特征值为主观评分时的问题](#特征值为主观评分时的问题)
            - [评分权重](#评分权重)
            - [余弦相似度](#余弦相似度)
        - [回归](#回归)
    - [Referecens](#referecens)

<!-- /TOC -->


## 设计思想
### 没有明显界限的分组
1. 相似度并没有一个明确的界限，你只需要根据具体的情况来定一个合适的界限，比如 80% 相似就可以认为是一组。
2. KNN 也是根据具体的情况，选择合适的 K 值来对样本进行分组。


## 本质
### 分组的本质——根据特征值
1. 我们比较常接触到的一些分组是根据单一的特征值。比如男女分组是根据明确的性别，青年中年老年分组是根据明确的年龄。
2. 但还有大量的分组只依靠单一特征是无法区分的，所以要根据多个特征综合分析。不同的特征可能也有不同的权重。


## 用途


## 思路


## 创建推荐系统
### 特征抽取
1. 将每个用户的喜好转换为一组坐标。这里比如说定义用户对五种类型的喜欢程度，并取 1 到 5 分的分值作为喜好程度。三个用户的喜好数据如下
    <table style="text-align: center;">
        <tr>
            <td></td>
            <th>Priyanka</th>
            <th>Justin</th>
            <th>Morpheus</th>
        </tr>
        <tr>
            <th>喜剧片</th>
            <td>3</td>
            <td>4</td>
            <td>2</td>
        </tr>
        <tr>
            <th>动作片</th>
            <td>4</td>
            <td>3</td>
            <td>5</td>
        </tr>
        <tr>
            <th>生活片</th>
            <td>4</td>
            <td>5</td>
            <td>1</td>
        </tr>
        <tr>
            <th>恐怖片</th>
            <td>1</td>
            <td>1</td>
            <td>3</td>
        </tr>
        <tr>
            <th>爱情片</th>
            <td>4</td>
            <td>5</td>
            <td>1</td>
        </tr>
    </table>
2. 现在可以根据每个用户的喜好值，把他们放进一个 5 维喜好坐标系内。进而就能通过计算两个用户在喜好坐标系内的距离来获得他们喜好相似度。
3. Priyanka 和 Justin 的相似度是 $2$，而 Priyanka 和 Morpheus 的相似度是 $\sqrt{24}$。
4. 现在要向 Priyanka 推荐电影将易如反掌：只要是 Justin 喜欢的电影，就将其推荐给 Priyanka，反之亦然。
5. 如果你是 Netflix 用户， Netflix 将不断提醒你给电影评分。你评论的电影越多，就越能准确地判断出你与哪些用户类似，给你的推荐就越准确。

#### K 的数量
这里选取 5 个最邻近的只是作为简单的演示。一个不错的经验规则是：如果有 K 位用户，应考虑 $sqrt(K)$ 个邻居。

#### 特征值为主观评分时的问题
1. 在 Netflix 示例中，你使用距离公式计算两位用户的距离，但给电影打分时，每位用户的标准并不都相同。
2. 假设你有两位用户——Yogi 和 Pinky，他们欣赏电影的品味相同，但 Yogi 给喜欢的电影都打 5 分，而 Pinky 更挑剔，只给特别好的电影打5分。
3. 他们的品味一致，但根据距离算法，他们并非邻居。如何将这种评分方式的差异考虑进来呢？
4. 可使用 **归一化**（normalization）。你可计算每位用户的平均评分，并据此来调整用户的评分。
5. 例如，你可能发现 Pinky 的平均评分为星 3，而 Yogi 的平均评分为 3.5 星。因此，你稍微调高 Pinky 的评分，使其平均评分也为 3.5 星。这样就能基于同样的标准比较他们的评分了。

#### 评分权重
1. 假设 Netflix 指定了一组意见领袖，他们的评分比普通用户更重要。请问你该如何修改推荐系统，使其偏重于意见领袖的评分呢？
2. 可在使用 KNN 时给意见领袖的评分更大权重。假设有 3 个邻居——Joe、Dave 和意见领袖 Wes Anderson，他们给 Caddyshack 的评分分别为 3 星、4 星和 5 星。
3. 计算 Caddyshack 的最终分数时不计算这些评分的平均值 $(3 + 4 + 5) / 3 = 4$ 星，而给 Wes Anderson 的评分更大权重：$(3 + 4 + 5 + 5 + 5) / 5 = 4.4$ 星。为什么是这样加权重？

#### 余弦相似度

### 回归
1. 假设你不仅要向 Priyanka 推荐电影，还要预测她将给这部电影打多少分。为此，先找出与她最近的 5 个人。
2. 假设你要预测 Priyanka 会给电影 Pitch Perfect 打多少分。可以看看最邻近的 Justin、 JC、 Joey、 Lance 和 Chris都给它打了多少分
    <table>
        <tr>
            <td>Justin</td>
            <td>5</td>
        </tr>
        <tr>
            <td>JC</td>
            <td>4</td>
        </tr>
        <tr>
            <td>Joey</td>
            <td>4</td>
        </tr>
        <tr>
            <td>Lance</td>
            <td>5</td>
        </tr>
        <tr>
            <td>Chris</td>
            <td>3</td>
        </tr>
    </table>
3. 求出这些人打的分的平均值，结果为 4.2，就是对 Priyanka 打分的预测。这称为 **回归**（regression）。
4. 你可以使用 KNN 来做两项基本工作——分类和回归：
    * 分类就是编组；
    * 回归就是预测结果（如一个数字）。

    
## Referecens
* [算法图解](https://book.douban.com/subject/26979890/)
* [《Python数据结构与算法分析（第2版）》第四章](https://book.douban.com/subject/34785178/)