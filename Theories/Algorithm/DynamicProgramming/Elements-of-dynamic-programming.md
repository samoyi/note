# 动态规划设计的要素

适合应用动态规划方法求解的最优化问题应该具备的两个要素：**最优子结构**（optimal substructure）和 **重叠子问题**（overlapping subproblems）。


<!-- TOC -->

- [动态规划设计的要素](#动态规划设计的要素)
    - [最优子结构](#最优子结构)
        - [对于不同问题领域](#对于不同问题领域)
        - [粗略分析最优解](#粗略分析最优解)
        - [一些微妙之处](#一些微妙之处)
    - [重叠子问题](#重叠子问题)
        - [备忘](#备忘)
        - [重构最优解](#重构最优解)
    - [递归式](#递归式)
    - [Referecens](#referecens)

<!-- /TOC -->


## 最优子结构
1. 用动态规划方法求解最优化问题的第一步就是描绘最优解的结构。如果问题的最优解包含其子问题的最优解，我们就称此问题具有 **最优子结构** 性质。
2. 一个问题是否适合应用动态规划算法，是否具有最优子结构就是一个好的线索。使用动态规划时，我们用子问题的最优解来构造原问题的最优解。
3. 在发掘最优子结构性质的过程中，遵循了如下的通用模式：
    1. 原问题的解决包含做出某种选择。例如在钢条切割问题中选择切割的位置，或者在矩阵链乘法问题中选择划分两个子矩阵链。这种选择会将原问题划分为一个或多个子问题。（钢条切割问题的选择会划分出一个子问题，就是右边钢条的最优解；矩阵链乘法问题的选择会划分出两个子问题，即两个子链的最优解。）
    2. 为了得出最优解而要做出的选择，肯定是所有选择的可能性中的一种，因此需要遍历所有选择的情况。
    3. 对于每一种选择，确定这个选择会产生哪些子问题，以及如何更好的描绘继而产生的子问题空间（space of subproblems）。
4. 一个描绘子问题空间的好的经验是，保持子问题空间尽可能的简单，只在必要时才扩展它。TODO，不懂

### 对于不同问题领域
1. 对于不同问题领域，最优子结构的不同体现在两个方面：
    * 原问题的最优解中涉及多少个子问题；
    * 在确定最优解使用哪些子问题时，我们需要考察多少种选择。
2. 在钢条切割问题中，最优切割方案仅仅使用一个子问题，也就是左边切下来之后右边剩余部分的最优解；而矩阵链乘法问题中，划分出来的两个子链都要计算各自的最优解。
3. 因为对于钢条切割原问题，不管我们是用怎样的划分方案，最终划分结果的最左侧一段肯定是一个价格表里对应的一段（长度不超过 10），否则它就还应该被切割，因为出售的尺寸最大就是 10；而对于矩阵链乘法问题中，最终的划分结果却不是这样，我们不能说最后的最优成本一定是最左侧的一个矩阵乘以右边所有矩阵乘积的成本。因为对于矩阵的乘法，计算乘积的值时是满足结合律的，但计算相乘的成本时是不满足结合律的。

### 粗略分析最优解
1. 子问题的总数和每个子问题要考察多少种选择，根据这两个因素的乘积可以来粗略分析动态规划算法的运行时间。
2. 对于钢条切割问题，我们需要计算从 1 到 n 种长度钢条的最优解，因此子问题的总数是 $Θ(n)$；而在解决每个子问题时，第一刀最多有 n 种切法，也就是最多有 n 种选择，因此运行时间是 $O(n^2)$。
3. 矩阵链乘法问题中，我们需要计算长度为从 1 到 n 的不同的子链的最优解，而对于给定的子链长度 l，具体从原矩阵链选取哪一段子链又有 n-l+1 中选择，所以子问题的数量是 $Θ(n^2)$；针对一个给定的子链，从哪里进行划分最多有 n-1 中选择，因此运行时间是 $O(n^3)$。
4. 子问题图也可用来做同样的分析。每个节点对应一个子问题，每条边赌赢一种选择。

### 一些微妙之处
TODO


## 重叠子问题
1. 适合用动态规划方法求解的最优化问题应该具备的第二个性质是子问题空间必须足够小，即问题的递归算法会反复的求解相同的子问题。一般来讲，不同子问题的总数数输入规模的多项式函数为好。
2. 如果递归算法反复求解相同的子问题，我们就说最优化问题具有 **重叠子问题** 性质。与之相对，适合用分治方法求解额问题通常在递归的每一步都生成全新的子问题。
3. 动态规划算法通常对每个子问题求解一次，将解存入一个表中，当再次需要这个子问题时直接查表，每次查表的代价为常量时间。如果不使用备忘查表，钢条切割问题的时间复杂度将会是指数级别。

### 备忘
1. 通常情况下，如果每个子问题都必须至少求解一次，自底向上动态规划算法会比自顶向下备忘算法快，因为自底向上算法没有递归调用的开销，表的维护开销也更少。TODO，表维护开销怎么少
2. 而且，对于某些问题，我们可以利用表的访问模式来进一步降低失控代价。TODO，不懂。
3. 不过，如果子问题空间中的某些子问题完全不必求解，备忘方法就体现出优势了，因为它只会求解哪些必要的子问题。


### 重构最优解


## 递归式
1. 确定了最优子结构和重叠子问题性质后，就可以描绘出问题的递归式。
2. 递归式一般包含两部分，一个是边界条件，另一个就是递归求解的部分。
3. 递归求解部分涉及到做出的若干种选择，计算每种选择的收益和成本，比较哪种选择是最优解。
4. 具体计算每种选择的收益和成本时，包括选择一个部分得到的收益，剩下的子问题递归计算的收益，成本的话不一定总是有，如果有的话一般就是做出选择时要付出的代价。


## Referecens
* [算法导论](https://book.douban.com/subject/20432061/)