# crossorigin 属性



## 设计目的
1.  `<audio>`、`<img>`、`<link>`、`<script>` 和 `<video>` 这些元素可以引用第三方资源，因为是第三方资源，所以请求时默认不会发送 cookie 之类的身份信息。
2. 但是人家第三方资源可能并不愿意让你随便免费用，人家只想给自己的客户用。
3. 第三方服务器虽然可以通过跨域设置只允许指定的域访问，但可能还需要更明确的用户信息，所以就要验证身份信息。
4. 那就要想办法让上面的元素请求资源时，在必要的时候可以带上身份信息。

### 关键细节


## 实现原理
  

## 抽象本质


## 设计思想


## `crossorigin` 属性本身的用途
1. 不使用 `crossorigin` 属性的时候，发起的请求不会带上关于跨域的请求首部。
2. 使用 `crossorigin` 并设值 `"anonymous"` 或空值时，会发送跨域请求首部，但不会带上身份信息。
3. `crossorigin` 属性如果设置为 `"use-credentials"`，那么对资源的请求就还会带上身份信息。


## 结合 canvas 的用途
1. 上面说的用途是为了让服务端获得客户端的用户信息，但这个属性结合 canvas，还会起到保护客户端的作用。
2. canvas 可以使用 `<img>` 请求到的图片来绘制，而如果 `<img>` 请求的图片数据是来自第三方的，就可能会有安全问题。
3. 如果可以跨域请求到第三方的图片，那就能正常显示，也能正常的绘制到 canvas 上。这里仅仅是显示，并不会有安全问题。
4. 但因为是第三方图片，所以认为 canvas 已经被污染（tainted）了。此时如果想对 canvas 进行以下三个操作试图读取图片数据时，会存在安全隐患：
    * `getImageData()`
    * `toBlob()`
    * `toDataURL()`
5. 这时浏览器会抛出 `SecurityError`，防止用户的私密信息被不可信的第三方服务器盗取。
6. 此时需要在请求图片时使用明确的跨域请求，也就是设值 `crossorigin=anonymous`。TODO，看了好多文章，但还是不明白这样怎么就安全了。


## References
[MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin)