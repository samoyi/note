# Basic

<!-- TOC -->

- [Basic](#basic)
    - [思想](#思想)
    - [感知机是什么](#感知机是什么)
    - [用感知机实现简单逻辑电路](#用感知机实现简单逻辑电路)
        - [与门](#与门)
        - [与非门](#与非门)
        - [或门](#或门)
    - [感知机的图像表示](#感知机的图像表示)
    - [感知机的局限](#感知机的局限)
        - [线性和非线性](#线性和非线性)
    - [多层感知机](#多层感知机)
    - [从与非门到计算机](#从与非门到计算机)

<!-- /TOC -->


## 思想
1. 感知机就像神经元这样基础的单元。
2. 一个复杂的感知系统，也都是有很多个基础的感知单元组成的。
3. 复杂的感知系统接收复杂的输入信号，最终信号也是被分解为基础的单元被基础的感知单元所接收。
4. 使用最简单的神经元叠加可以构建出复杂的大脑，同样使用基础的感知单元也可以构建出高级的人工智能。


## 感知机是什么
1. 感知机接收多个输入信号，输出一个信号。想想生物的情况，也是接收信息并做出反应。
2. 感知机的信号只有1/0两种取值。对生物来说，在更高层上可能会接收所谓的复杂信号，但其实分解到底层神经元上，也是很简单的电信号。
3. 一个输入信号值乘以它的权重$w$，就是神经元节点接收到的信号实际值。显然对生物来说，不同的信息输入有不同的重要性。
    <img src="./images/01.png" style="display: block" width="400" />
4. 神经元会计算传送过来的信号的总和，只有当这个总和超过了某个界限值时，才会输出 1。这也称为“神经元被激活”。这里将这个界限值称为阈值，用符号$θ$表示。对生物来说，某种刺激太弱也不会做出相应的反应。
    * $w1x2 + w2x2 <= θ$，$y$ 输出 $0$
    * $w1x2 + w2x2 > θ$， $y$ 输出 $1$
5. 后续使用中，将使用偏置$b$来代替阈值$θ$，变形如下：
    * $b + w1x2 + w2x2 <= 0$，$y$ 输出 $0$
    * $b + w1x2 + w2x2 > 0$， $y$ 输出 $1$


## 用感知机实现简单逻辑电路
### 与门
1. x1、x2 的输入和对应的 y 输入应如下：
    x1 | x2 | y
    --|--|--
    0 | 0 | 0
    1 | 0 | 0
    0 | 1 | 0
    1 | 1 | 1
2. 要用感知机实现，就需要设定合适的偏置和权重，使得上表前三行的 $x1$、$x2$ 的输入的计算结果小于等于$0$，第四行输入的计算结果大于$0$。
2. python 实现如下
    ```py
    import numpy as np

    def AND(x1, x2):
        x = np.array([x1, x2])
        w = np.array([0.5, 0.5]) # 设定权重
        b = -0.7 # 设定偏置
        tmp = np.sum(w*x) + b
        if tmp <= 0:
            return 0
        else:
            return 1
    ```

### 与非门
1. 真值表
    x1 | x2 | y
    --|--|--
    0 | 0 | 1
    1 | 0 | 1
    0 | 1 | 1
    1 | 1 | 0
2. python 实现
    ```py
    def NAND(x1, x2):
        x = np.array([x1, x2])
        w = np.array([-0.5, -0.5])
        b = 0.7
        tmp = np.sum(w*x) + b
        if tmp <= 0:
            return 0
        else:
            return 1
    ```

### 或门
1. python 实现
    ```py
    def OR(x1, x2):
        x = np.array([x1, x2])
        w = np.array([0.5, 0.5])
        b = -0.2
        tmp = np.sum(w*x) + b
        if tmp <= 0:
            return 0
        else:
            return 1
    ```


## 感知机的图像表示
1. 从上面的描述可以看出，偏置和权重作为设定的参数，$x1$ 和 $x2$ 作为实际的变量，感知机可以用直角坐标系加上一条直线来表示。例如下面$-0.5 + x1 + x2$的或门实现（偏置为-0.5，权重为1的感知机）。直线的方程为 $-0.5 + x1 + x2 = 0$，三角和圆形代表或门的四个输入值，即 $(1, 1)$ $(1, 0)$ $(0, 1)$ $(0,0])
    <img src="./images/or.png" style="display: block" width="400" />
2. 给定参数的感知机，它的图形意义就是：在 $x1$、$x2$ 直角坐标系里画出一条直线，这个直线上的每一点和 $b + w1x1 + w2x2 = 0$ 的 $x1$、$x2$ 的取值一一对应。也就是说，这条直线就是根据 $b + w1x1 + w2x2 = 0$ 画出来的。
3. 考虑直线的左侧空间，对于任意一点来说，都可以说是直线上的一点向左或向下移动后到达的，都是一个值不变另一个值减小，因此上面式子的结果就会小于零。例如左侧的 $(0, 0)$ 点，就可以是直线上的 $(0, 1)$ 点通过 $x1$ 不变 $x2$ 减小来到达，或者通过直线上的 $(1, 0)$ 点通过 $x1$ 不变 $x1$ 减小来到达同理。总之不管是那种移动方式，上面式子的结果都会小于0。
4. 也就是说，直线一侧的坐标值求得结果都是负数，而另一侧求得的结果都是正数。
5. 因此在上图中，只要设定合适的参数，让输入$(0,0)$在条直线左侧让$(0, 1)(1, 0)(1, 1)$在直线右侧，就可以以此参数实现或门感知机。这个直线的方程就是该或门感知机的数学表达式。


## 感知机的局限
1. 考虑异或门的输入和输出，要求在坐标轴中划出一条直线，使得两个三角形在一侧（表达式大于零）两个圆形在另一侧（表达式小于零）
    <img src="./images/xor.png" style="display: block" width="400" />
2. 显然是画不出这样的直线的

### 线性和非线性
1. 感知机的局限性就在于它只能表示由一条直线分割的空间。下图这样弯曲的曲线无法用感知机表示。
    <img src="./images/02.png" style="display: block" width="600" />
2. 这样的曲线分割而成的空间称为非线性空间，由直线分割而成的空间称为线性空间。


## 多层感知机
1. 感知机不能表示异或门让人深感遗憾，但也无需悲观。实际上，感知机的绝妙之处在于它可以“叠加层”。
2. 通过叠加层实现多层感知机（multi-layered perceptron）。
    <img src="./images/03.png" style="display: block" width="600" />
3. 通过叠加层感知机实现异或门
    <img src="./images/04.png" style="display: block" width="600" />  
    <img src="./images/05.png" style="display: block" width="600" />
    ```py
    def XOR(x1, x2):
        s1 = NAND(x1, x2)
        s2 = OR(x1, x2)
        y = AND(s1, s2)
        return y
    ```


## 从与非门到计算机
1. 多层感知机可以实现比之前见到的电路更复杂的电路。比如，进行加法运算的加法器也可以用感知机实现。此外，将二进制转换为十进制的编码器、满足某些条件就输出 1 的电路（用于等价检验的电路）等也可以用感知机表示。
2. 实际上，使用感知机甚至可以表示计算机！
3. 计算机是处理信息的机器。向计算机中输入一些信息后，它会按照某种既定的方法进行处理，然后输出结果。所谓“按照某种既定的方法进行处理”是指，计算机和感知机一样，也有输入和输出，会按照某个既定的规则进行计算。
4. 人们一般会认为计算机内部进行的处理非常复杂，而令人惊讶的是，实际上只需要通过与非门的组合，就能再现计算机进行的处理。
5. 这一令人吃惊的事实说明了什么呢？说明使用感知机也可以表示计算机。前面也介绍了，与非门可以使用感知机实现。也就是说，如果通过组合与非门可以实现计算机的话，那么通过组合感知机也可以表示计算机（感知机的组合可以通过叠加了多层的单层感知机来表示）。
6. 综上，多层感知机能够进行复杂的表示，甚至可以构建计算机。那么，什么构造的感知机才能表示计算机呢？层级多深才可以构建计算机呢？
7. 理论上可以说 2 层感知机就能构建计算机。这是因为，已有研究证明，2 层感知机（严格地说是激活函数使用了非线性的 sigmoid 函数的感知机）可以表示任意函数。
8. 但是，使用 2 层感知机的构造，通过设定合适的权重来构建计算机是一件非常累人的事情。
9. 实际上，在用与非门等低层的元件构建计算机的情况下，分阶段地制作所需的零件（模块）会比较自然，即先实现与门和或门，然后实现半加器和全加器，接着实现算数逻辑单元（ALU），然后实现 CPU。因此，通过感知机表示计算机时，使用叠加了多层的构造来实现是比较自然的流程。